/*Disclaimer: partial extensions from cjw0511 */
(function (a, u) { a.util.namespace("$.easyui"); a.easyui.getTopEasyuiMessager = function () { return a.util.isUtilTop ? a.messager : a.util.$ && a.util.$.messager ? a.util.$.messager : a.messager }; a.easyui.messager = a.easyui.getTopEasyuiMessager(); a.easyui.getTopEasyuiTooltip = function () { return a.util.isUtilTop ? a.fn.tooltip : a.util.$ && a.util.$.fn && a.util.$.fn.tooltip ? a.util.$.fn.tooltip : a.fn.tooltip }; a.easyui.tooltip = a.fn.tooltip; a.easyui.tooltip.init = function (c, e) { var d = a(c); d.mouseover(function () { d.tooltip(a.extend({ trackMouse: !0 }, e, { onHide: function () { a.isFunction(e.onHide) && e.onHide.apply(this, arguments); d.tooltip("destroy") } })).tooltip("show") }) }; var w = { error: "messager-error", info: "messager-info", question: "messager-question", warning: "messager-warning" }, A = a.messager.show, r = a.messager.alert, m = a.messager.confirm, g = a.messager.prompt; a.messager.show = function (c) { if (a.util.isString(c) || a.util.isBoolean(c) || a.isNumeric(c)) return 1 == arguments.length ? a.messager.show({ msg: String(c) }) : a.messager.show({ title: c, msg: arguments[1], icon: arguments[2], position: arguments[3] }); var e = a.extend({}, a.messager.defaults, { title: "\u64cd\u4f5c\u63d0\u9192", timeout: 4E3, showType: "slide" }, c), d = { topLeft: { showType: "show", right: "", left: 0, top: document.body.scrollTop + document.documentElement.scrollTop, bottom: "" }, topCenter: { showType: "slide", right: "", top: document.body.scrollTop + document.documentElement.scrollTop, bottom: "" }, topRight: { showType: "show", left: "", right: 0, top: document.body.scrollTop + document.documentElement.scrollTop, bottom: "" }, centerLeft: { showType: "fade", left: 0, right: "", bottom: "" }, center: { showType: "fade", right: "", bottom: "" }, centerRight: { showType: "fade", left: "", right: 0, bottom: "" }, bottomLeft: { showType: "show", left: 0, right: "", top: "", bottom: -document.body.scrollTop - document.documentElement.scrollTop }, bottomCenter: { showType: "slide", right: "", top: "", bottom: -document.body.scrollTop - document.documentElement.scrollTop }, bottomRight: { showType: "show", left: "", right: 0, top: "", bottom: -document.body.scrollTop - document.documentElement.scrollTop } }; e.style = e.position && d[e.position] ? d[e.position] : d.topCenter; e.style.showType && (e.showType = e.style.showType); e.msg = "\x3cdiv class\x3d'messager-icon " + (e.icon && w[e.icon] ? w[e.icon] : w.info) + "'\x3e\x3c/div\x3e\x3cdiv\x3e" + e.msg + "\x3c/div\x3e"; return A(e) }; a.union(a.messager.show, A); a.messager.alert = function (c, e, d, f) { return 1 == arguments.length ? r("\u64cd\u4f5c\u63d0\u9192", arguments[0], "info") : 2 == arguments.length ? a.isFunction(arguments[1]) ? r("\u64cd\u4f5c\u63d0\u9192", arguments[0], "info", arguments[1]) : arguments[1] in w ? r("\u64cd\u4f5c\u63d0\u9192", arguments[0], arguments[1]) : r.apply(this, arguments) : 3 == arguments.length && a.isFunction(arguments[2]) ? arguments[1] in w ? r("\u64cd\u4f5c\u63d0\u9192", arguments[0], arguments[1], arguments[2]) : r(arguments[0], arguments[1], "info", arguments[2]) : r.apply(this, arguments) }; a.messager.confirm = function (c, e, d) { return 1 == arguments.length ? a.isFunction(arguments[0]) ? m("\u64cd\u4f5c\u63d0\u9192", "\u60a8\u786e\u8ba4\u8981\u8fdb\u884c\u8be5\u64cd\u4f5c\uff1f", arguments[0]) : m("\u64cd\u4f5c\u63d0\u9192", arguments[0]) : 2 == arguments.length ? a.isFunction(arguments[1]) ? m("\u64cd\u4f5c\u63d0\u9192", arguments[0], arguments[1]) : m(arguments[0], arguments[1]) : m.apply(this, arguments) }; a.messager.solicit = function (c, e, d) { var f = arguments, g = a.type(f[0]), D = a.extend({}, a.messager.solicit.defaults, "object" == g ? f[0] : "function" == g ? { callback: f[0] } : 2 == f.length ? { message: f[0], callback: f[1] } : { title: f[0], message: f[1], callback: f[2] }), y = a.messager.confirm(D.title, D.message, D.callback), F = y.window("options"), G = F.onClose; F.onClose = function () { a.isFunction(G) && G.apply(this, arguments); a.isFunction(D.callback) && D.callback.call(this, u) }; f = y.find("\x3ediv.messager-button").empty(); a('\x3ca class\x3d"messager-solicit messager-solicit-yes"\x3e\x3c/a\x3e').appendTo(f).linkbutton({ text: D.yesText, onClick: function () { F.onClose = G; y.window("close"); a.isFunction(D.callback) && D.callback.call(this, !0) } }); a('\x3ca class\x3d"messager-solicit messager-solicit-no"\x3e\x3c/a\x3e').appendTo(f).linkbutton({ text: D.noText, onClick: function () { F.onClose = G; y.window("close"); a.isFunction(D.callback) && D.callback.call(this, !1) } }); a('\x3ca class\x3d"messager-solicit messager-solicit-cancel"\x3e\x3c/a\x3e').appendTo(f).linkbutton({ text: D.cancelText, onClick: function () { F.onClose = G; y.window("close"); a.isFunction(D.callback) && D.callback.call(this, u) } }); return y }; a.messager.solicit.defaults = { title: "\u64cd\u4f5c\u63d0\u9192", message: null, callback: null, yesText: "\u662f", noText: "\u5426", cancelText: "\u53d6\u6d88" }; a.messager.prompt = function (c, e, d) { return 1 == arguments.length ? a.isFunction(arguments[0]) ? g("\u64cd\u4f5c\u63d0\u9192", "\u8bf7\u8f93\u5165\u76f8\u5e94\u5185\u5bb9\uff1a", arguments[0]) : g("\u64cd\u4f5c\u63d0\u9192", "\u8bf7\u8f93\u5165\u76f8\u5e94\u5185\u5bb9\uff1a") : 2 == arguments.length ? a.isFunction(arguments[1]) ? g("\u64cd\u4f5c\u63d0\u9192", arguments[0], arguments[1]) : g(arguments[0], arguments[1]) : g.apply(this, arguments) }; a.easyui.loading = function (c) { c = a.extend({ msg: "\u6b63\u5728\u52a0\u8f7d\uff0c\u8bf7\u7a0d\u7b49...", locale: "body", topMost: !1 }, c || {}); var e = c.topMost ? a.util.$ : a, d = e(c.locale), f = d.children().map(function () { var d = a(this).css("z-index"); return a.isNumeric(d) ? parseInt(d) : 0 }), g = a.array.max(f.length ? f : [1]); d.is("body") || d.addClass("mask-container"); f = e("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-mask").css({ display: "block", "z-index": g += 100 }).appendTo(d); c = e("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-mask-msg").css({ display: "block", left: "50%", "z-index": ++g }).html(c.msg).appendTo(d); c.css("marginLeft", -c.outerWidth() / 2); return f.add(c) }; a.easyui.loaded = function (c, e) { var d = { locale: "body", topMost: !1 }; 1 == arguments.length && (a.isPlainObject(arguments[0]) ? a.extend(d, arguments[0]) : a.util.isBoolean(arguments[0]) ? d.topMost = arguments[0] : d.locale = arguments[0]); 2 == arguments.length && (a.util.isBoolean(arguments[0]) ? a.extend(d, { locale: arguments[1], topMost: arguments[0] }) : a.extend(d, { locale: arguments[0], topMost: arguments[1] })); c = (d.topMost ? a.util.$ : a)(d.locale); c.removeClass("mask-container"); c.children("div.datagrid-mask-msg,div.datagrid-mask").remove() }; a.extend(a.fn.panel.defaults, { loadingMessage: "\u6b63\u5728\u52a0\u8f7d\uff0c\u8bf7\u7a0d\u7b49..." }); a.extend(a.fn.window.defaults, { loadingMessage: "\u6b63\u5728\u52a0\u8f7d\uff0c\u8bf7\u7a0d\u7b49..." }); a.extend(a.fn.dialog.defaults, { loadingMessage: "\u6b63\u5728\u52a0\u8f7d\uff0c\u8bf7\u7a0d\u7b49..." }); a.extend(a.fn.combo.defaults, { missingMessage: a.fn.validatebox.defaults.missingMessage }); a.easyui.bindPageNestedFunc = function (c, e, d, f) { 3 == arguments.length && (f = d, d = "jquery"); 4 != arguments.length || d || (d = "jquery"); a(document).unbind("." + e).bind(c + "." + e, function (a) { var c = function (e) { var y = e.parent; try { e != y && y.jQuery && y.jQuery.parser && y.jQuery.parser.plugins && y.jQuery.fn && y.jQuery.fn[d] && (f.call(y, y, a), c(y)) } catch (I) { } }, e = function (c) { var G = c.jQuery; G("iframe,iframe").each(function () { try { if (this.contentWindow && G.util.isObject(this.contentWindow.document) && this.contentWindow.jQuery && this.contentWindow.jQuery.parser && this.contentWindow.jQuery.parser.plugins && this.contentWindow.jQuery.fn && this.contentWindow.jQuery.fn[d]) { var c = this.contentWindow; f.call(c, c, a); e(this.contentWindow) } } catch (C) { } }) }; (function (d) { f.call(d, d, a); c(d); e(d) })(window) }) }; a.easyui.ajaxError = function (c) { if (!arguments.length) return a.fn.form.defaults.onLoadError; a.fn.form.defaults.onLoadError = c; a.fn.panel.defaults.onLoadError = c; a.fn.combobox.defaults.onLoadError = c; a.fn.combotree.defaults.onLoadError = c; a.fn.combogrid.defaults.onLoadError = c; a.fn.datagrid.defaults.onLoadError = c; a.fn.propertygrid.defaults.onLoadError = c; a.fn.tree.defaults.onLoadError = c; a.fn.treegrid.defaults.onLoadError = c; a.ajaxSetup({ error: c }) }; a.easyui.ajaxDefaults = a.extend({}, a.ajaxSettings); a.easyui.ajaxError(function (c, e, d) { a.messager.progress("close"); a.easyui.messager != a.messager && a.easyui.messager.progress("close") }); a.ajaxSetup({ dataFilter: function (c, e) { return "json" == String(e).toLowerCase(e) ? a.string.toJSONString(c) : c } }); a.extend({ isEasyUI: function (c, e) { a.array.contains(a.parser.plugins, e) || a.error(a.string.format("\u4f20\u5165\u7684\u53c2\u6570 pluginName: {0} \u4e0d\u662f easyui \u63d2\u4ef6\u540d\u3002")); var d = a(c); return d.length ? (d = a.data(d[0], e)) && d.options ? !0 : !1 : !1 } }); a.fn.extend({ isEasyUI: function (c) { return a.isEasyUI(this, c) }, currentPagination: function () { for (var c = this.closest(".pagination") ; c.length && !a.data(c[0], "pagination") ;) c = c.parent().closest(".pagination"); return c }, currentProgressbar: function () { for (var c = this.closest(".progressbar") ; c.length && !a.data(c[0], "progressbar") ;) c = c.parent().closest(".progressbar"); return c }, currentPanel: function () { for (var c = this.closest(".panel-body") ; c.length && !a.data(c[0], "panel") ;) c = c.parent().closest(".panel-body"); return c }, currentTabPanel: function () { for (var c = this.closest(".panel-body"), e = c.parent(), d = e.parent(), f = d.parent() ; c.length && !(a.data(c[0], "panel") && e.hasClass("panel") && d.hasClass("tabs-panels") && f.hasClass("tabs-container")) ;) c = c.parent().closest(".panel-body"), e = c.parent(), d = e.parent(), f = d.parent(); return c }, currentTabIndex: function () { var a = this.currentTabPanel(); return a.length ? a.panel("panel").index() : -1 }, currentTabs: function () { for (var c = this.closest(".tabs-container") ; c.length && !a.data(c[0], "tabs") ;) c = c.parent().closest(".tabs-container"); return c }, currentAccordion: function () { for (var c = this.closest(".accordion") ; c.length && !a.data(c[0], "accordion") ;) c = c.parent().closest(".accordion"); return c }, currentAccPanel: function () { for (var c = this.closest(".panel-body"), e = c.parent(), d = panels.parent() ; c.length && !(a.data(c[0], "panel") && e.hasClass("panel") && d.hasClass("accordion") && a.data(d[0], "accordion")) ;) c = c.parent().closest(".panel-body"), e = c.parent(), d = panels.parent(); return c }, currentLayout: function () { for (var c = this.closest(".layout") ; c.length && !a.data(c[0], "layout") ;) c = c.closest(".layout"); return c }, currentRegion: function () { for (var c = this.closest(".panel.layout-panel"), e = c.parent(), d = c.children(".panel-body") ; c.length && (!e.hasClass("layout") || !a.data(d[0], "panel")) ;) c = c.parent().closest(".panel.layout-panel"), e = c.parent(), d = c.children(".panel-body"); return d }, currentLinkbutton: function () { for (var c = this.closest(".l-btn") ; c.length && !a.data(c[0], "linkbutton") ;) c = c.parent().closest(".layout"); return c }, currentCalendar: function () { for (var c = this.closest(".calendar") ; c.length && !a.data(c[0], "calendar") ;) c = c.parent().closest(".calendar"); return c }, currentWindow: function () { for (var c = this.closest(".panel-body.window-body") ; c.length && !a.data(c[0], "window") ;) c = c.parent().closest(".panel-body.window-body"); return c }, currentDialog: function () { for (var c = this.closest(".panel-body.window-body") ; c.length && !a.data(c[0], "dialog") ;) c = c.parent().closest(".panel-body.window-body"); return c }, currentDatagrid: function () { for (var c = this.closest(".datagrid-wrap.panel-body"), e = c.find("\x3e.datagrid-view\x3e:eq(2)") ; c.length && !a.data(e[0], "datagrid") ;) c = c.parent().closest(".datagrid-wrap.panel-body"), e = c.find("\x3e.datagrid-view\x3e:eq(2)"); return e }, currentPropertygrid: function () { for (var c = this.closest(".datagrid-wrap.panel-body"), e = c.find("\x3e.datagrid-view\x3e:eq(2)") ; c.length && !a.data(e[0], "propertygrid") ;) c = c.parent().closest(".datagrid-wrap.panel-body"), e = c.find("\x3e.datagrid-view\x3e:eq(2)"); return e }, currentTree: function () { for (var c = this.closest(".tree") ; c.length && !a.data(c[0], "tree") ;) c = c.parent().closest(".tree"); return c }, currentTreegrid: function () { for (var c = this.closest(".datagrid-wrap.panel-body"), e = c.find("\x3e.datagrid-view\x3e:eq(2)") ; c.length && !a.data(e[0], "treegrid") ;) c = c.parent().closest(".datagrid-wrap.panel-body"), e = c.find("\x3e.datagrid-view\x3e:eq(2)"); return e } }) })(jQuery); (function (a, u) { a.fn.progressbar.extensions = {}; var w = a.fn.progressbar.extensions.defaults = {}, A = a.fn.progressbar.extensions.methods = { setText: function (r, m) { return r.each(function () { var g = a(this), c = g.progressbar("options"); g.find(".progressbar-text").text(c.text = m) }) } }; a.extend(a.fn.progressbar.defaults, w); a.extend(a.fn.progressbar.methods, A) })(jQuery); (function (a, u) { function w(c) { var d = a(c), f = a.data(c, "slider"), g = f.options, D = f.slider; D.find("div.slider-inner").unbind(".slider").bind("mousedown.slider", function (y) { if (!f.isDragging && !g.disabled) { var F = a(this).offset(); y = "h" == g.mode ? y.pageX - F.left : y.pageY - F.top; F = "h" == g.mode ? D.width() : D.height(); y = g.converter.toValue.call(c, "h" == g.mode ? g.reversed ? F - y : y : F - y, F).toFixed(0); F = Math.abs(y % g.step); y = F < g.step / 2 ? y - F : y - F + g.step; d.slider("setValue", y); g.onComplete.call(c, g.value) } }) } a.fn.slider.extensions = {}; var A = a.fn.slider.methods.enable, r = a.fn.slider.methods.disable, m = a.fn.slider; a.fn.slider = function (c, d) { if ("string" == typeof c) return m.apply(this, arguments); c = c || {}; return this.each(function () { var d = a(this), g = a.data(this, "slider") ? c : a.extend({}, a.fn.slider.parseOptions(this), c); m.call(d, g); a(this); d = a.data(this, "slider").options; d._initialized || (w(this), d._initialized = !0) }) }; a.union(a.fn.slider, m); var g = a.fn.slider.extensions.methods = { enable: function (c) { return c.each(function () { var d = a(this); A.call(d, d); w(this) }) }, disable: function (c) { return c.each(function () { var d = a(this); r.call(d, d); w(this) }) } }, c = a.fn.slider.extensions.defaults = {}; a.extend(a.fn.slider.defaults, c); a.extend(a.fn.slider.methods, g); a.extend(a.fn.datagrid.defaults.editors, { slider: { init: function (c, d) { return a('\x3cdiv class\x3d"datagrid-editable-slider"\x3e\x3c/div\x3e').appendTo(c).slider(d) }, destroy: function (c) { a(c).slider("destroy") }, getValue: function (c) { return a(c).slider("getValue") }, setValue: function (c, d) { a(c).slider("setValue", d) }, resize: function (c, d) { a(c).slider("resize", { width: d }) } } }) })(jQuery); (function (a, u) { function w(g, c) { var e = a(g), d = e.linkbutton("options"), f = a.isFunction(c); d.tooltip = c; if (d.tooltip) { var m = { content: f ? null : c }; f && a.extend(m, { onShow: function (d) { a(this).tooltip("update", c.call(g, d)) } }); e.tooltip(m) } 0 == d.tooltip && e.tooltip("destroy") } a.fn.linkbutton.extensions = {}; var A = a.fn.linkbutton; a.fn.linkbutton = function (g, c) { if ("string" == typeof g) return A.apply(this, arguments); g = g || {}; return this.each(function () { var c = a(this), d = a.data(this, "linkbutton") ? g : a.extend({}, a.fn.linkbutton.parseOptions(this), a.parser.parseOptions(this, ["tooltip"]), g); A.call(c, d); c = a(this).linkbutton("options"); d = c.extensions ? c.extensions : c.extensions = {}; if (!d._initialized) { var f = c.style; f && a(this).css(f); w(this, c.tooltip); d._initialized = !0 } }) }; a.union(a.fn.linkbutton, A); var r = a.fn.linkbutton.extensions.defaults = { style: null, tooltip: null }, m = a.fn.linkbutton.extensions.methods = { setIcon: function (g, c) { return g.each(function () { var e = a(this), d = e.linkbutton("options"), f = e.find("span.l-btn-icon"); c ? f.length ? f.removeClass(d.iconCls).addClass(c) : e.find("span.l-btn-text").after('\x3cspan class\x3d"l-btn-icon ' + c + '"\x3e\x26nbsp;\x3c/span\x3e') : f.remove(); d.iconCls = c }) }, setText: function (g, c) { return g.each(function () { var e = a(this), d = e.linkbutton("options"), e = e.find("span.l-btn-text"); c ? e.removeClass("l-btn-empty").text(c) : e.addClass("l-btn-empty").html("\x26nbsp;"); d.text = c }) }, setIconAlign: function (g, c) { return g.each(function () { var e = a(this), d = e.linkbutton("options"); e.find("\x3espan").removeClass("l-btn-icon-left l-btn-icon-right l-btn-icon-top l-btn-icon-bottom").addClass("l-btn-icon-" + c); d.iconAlign = c }) }, setStyle: function (g, c) { return g.each(function () { c && a(this).css(c) }) }, setPlain: function (g, c) { return g.each(function () { var e = a(this), d = e.linkbutton("options"); e[(d.plain = c ? !0 : !1) ? "addClass" : "removeClass"]("l-btn-plain") }) }, setSize: function (g, c) { return g.each(function () { var e = a(this), d = e.linkbutton("options"); e.removeClass("l-btn-small l-btn-large").addClass("l-btn-" + c); d.size = c }) }, setTooltip: function (a, c) { return a.each(function () { w(this, c) }) } }; a.extend(a.fn.linkbutton.defaults, r); a.extend(a.fn.linkbutton.methods, m) })(jQuery); (function (a, u) { function w(c, e) { var f = a(c), G = a.data(c, "form"), I = /^(?:form)$/i.test(c.nodeName) && G ? !0 : !1, C = a.extend({}, G ? G.options : a.fn.form.defaults, "string" == typeof e ? { url: e } : a.isFunction(e) ? { success: e } : e || {}), g = function () { C.showLoading && (C.loadedDelay ? a.util.exec(function () { a.easyui.loaded(C.loadingLocale) }, C.loadedDelay) : a.easyui.loaded(C.loadingLocale)) }; C.url || (C.url = window.location.href); if (I) return d.call(f, f, C); f = f.form("getData"); if (a.isFunction(C.onSubmit) && 0 == C.onSubmit.call(c, f)) return g(); var z = a.ajaxSettings.beforeSend, n = a.ajaxSettings.complete; a.ajax({ url: C.url, type: C.method, data: f, success: function (d) { if (a.isFunction(C.success)) return C.success.call(c, d) }, beforeSend: function () { var d = a.isFunction(z) ? z.apply(this, arguments) : u; C.showLoading && a.easyui.loading({ msg: C.loadingMessage, locale: C.loadingLocale }); return d }, complete: function () { var d = a.isFunction(n) ? n.apply(this, arguments) : u; g(); return d } }) } function A(d, c) { function e(c) { for (var k in c) { var p = c[k]; f(k, p).length || I(k, p) || (a.each(a.fn.form.valueMarkList, function (d, c) { a(c + '[name\x3d"' + k + '"]', g).val(p) }), a.each(a.fn.form.textMarkList, function (d, c) { a(c + '[name\x3d"' + k + '"]', g).text(p) })); C(k, p) } z.onLoadSuccess.call(d, c); g.form("validate") } function f(d, c) { var e = g.find('input[name\x3d"' + d + '"][type\x3dradio], input[name\x3d"' + d + '"][type\x3dcheckbox]'); e._propAttr("checked", !1); e.each(function () { var d = a(this); (d.val() == String(c) || 0 <= a.inArray(d.val(), a.isArray(c) ? c : [c])) && d._propAttr("checked", !0) }); return e } function I(d, c) { for (var e = 0, n = a.fn.form.otherList, y = 0; y < n.length; y++) { var z = n[y], C = g.find("[" + z + 'Name\x3d"' + d + '"]'); C.length && (C[z]("setValue", c), e += C.length) } return e } function C(d, c) { var e = a.fn.form.comboList, n = g.find('[comboName\x3d"' + d + '"]'); if (n.length) for (var y = e.length - 1; 0 <= y; y--) { var z = e[y]; if (n.hasClass(z + "-f")) { if (n[z]("options").multiple) c = a.array.isArray(c) ? c : c.split(",").filter(function (a) { return "" != a }), n[z]("setValues", c); else n[z]("setValue", c); break } } } a.data(d, "form") || a.data(d, "form", { options: a.extend({}, a.fn.form.defaults) }); var g = a(d), z = a.data(d, "form").options; if ("string" == typeof c) { var n = {}; 0 != z.onBeforeLoad.call(d, n) && a.ajax({ url: c, data: n, dataType: "json", type: z.method, success: function (a) { e(a) }, error: function () { z.onLoadError.apply(d, arguments) } }) } else e(c) } function r(d) { a(a.fn.form.valueMarkList.join(","), d).each(function () { var d = this.type, c = this.tagName.toLowerCase(); "text" == d || "hidden" == d || "password" == d || "textarea" == c ? this.value = "" : "file" == d ? (d = a(this), c = d.clone().insertAfter(d).val(""), d.data("validatebox") ? (d.validatebox("destroy"), c.validatebox()) : d.remove()) : "checkbox" == d || "radio" == d ? this.checked = !1 : "select" == c && (this.selectedIndex = -1) }); d = a(d); for (var c = a.array.distinct(a.array.merge([], a.fn.form.otherList, a.fn.form.spinnerList, a.fn.form.comboList)), e = 0; e < c.length; e++) { var f = c[e], g = d.find("." + f + "-f"); g.length && a.fn[f] && a.fn[f].methods && a.util.tryExec(function () { g[f]("clear") }) } d.form("validate") } function m(d) { var c = a(d), e = a.data(d, "form"); /^(?:form)$/i.test(d.nodeName) && e && d.reset(); d = a.array.distinct(a.array.merge([], a.fn.form.otherList, a.fn.form.spinnerList, a.fn.form.comboList)); for (e = 0; e < d.length; e++) { var f = d[e], g = c.find("." + f + "-f"); g.length && a.fn[f] && a.fn[f].methods && a.util.tryExec(function () { g[f]("reset") }) } c.form("validate") } function g(d) { d = a(d); if (a.fn.validatebox) { d.find(".validatebox-text:not(:disabled)").validatebox("validate"); var c = d.find(".validatebox-invalid"); c.filter(":not(:disabled):first").focus(); if (c.length) return !1 } for (var c = a.array.distinct(a.array.merge([], a.fn.form.otherList, a.fn.form.spinnerList, a.fn.form.comboList)), e = 0; e < c.length; e++) { var f = c[e], g = d.find("." + f + "-f"); if (g.length && a.fn[f] && a.fn[f].methods && !1 === a.util.tryExec(function () { return g[f]("isValid") })) return a.util.tryExec({ code: function () { g[f]("focus") }, error: function () { g[f]("textbox").focus() }, tryError: !0 }), !1 } return !0 } function c(d, c) { var e = a(d); e.find(".validatebox-text:not(:disabled)").validatebox(c ? "disableValidation" : "enableValidation"); for (var f = a.array.distinct(a.array.merge([], a.fn.form.otherList, a.fn.form.spinnerList, a.fn.form.comboList)), g = 0; g < f.length; g++) { var C = f[g], M = e.find("." + C + "-f"); M.length && a.fn[C] && a.fn[C].methods && a.util.tryExec(function () { M[C](c ? "disableValidation" : "enableValidation") }) } } function e(d, c, e) { var f = a(d); d = a.data(d, "form"); c = c ? !0 : !1; d && d.options && (d.disabled = c); d = e ? f.find("input, select, textarea") : f.find("input, select, textarea, button, a.l-btn, .m-btn, .s-btn"); e && a.each(d, function (d, e) { var n = a(e); n.is(".s-btn") ? n.splitbutton(c ? "disable" : "enable") : n.is(".m-btn") ? n.menubutton(c ? "disable" : "enable") : n.is("a.l-btn") ? n.linkbutton(c ? "disable" : "enable") : c ? n.attr("disabled", !0) : n.removeAttr("disabled") }); a.fn.validatebox && f.find(".validatebox-text").validatebox(c ? "disable" : "enable"); e = a.array.distinct(a.array.merge([], a.fn.form.otherList, a.fn.form.spinnerList, a.fn.form.comboList)); for (d = 0; d < e.length; d++) { var g = e[d], C = f.find("." + g + "-f"); C.length && a.fn[g] && a.fn[g].methods && a.util.tryExec(function () { C[g](c ? "disable" : "enable") }) } } a.fn.form.extensions = {}; var d = a.fn.form.methods.submit, f = a.fn.form.extensions.methods = { getData: function (d, c) { var e = d[0], f = c; f || (a(e), f = a.data(e, "form"), f = (f ? f.options : a.fn.form.defaults).serializer); return a(e).serializeObject(f) }, submit: function (a, d) { return a.each(function () { w(this, d) }) }, clear: function (a) { return a.each(function () { r(this) }) }, reset: function (a) { return a.each(function () { m(this) }) }, validate: function (a) { return g(a[0]) }, enableValidation: function (a) { return a.each(function () { c(this, !1) }) }, disableValidation: function (a) { return a.each(function () { c(this, !0) }) }, enable: function (a, d) { return a.each(function () { e(this, !1, d) }) }, disable: function (a, d) { return a.each(function () { e(this, !0, d) }) }, load: function (a, d) { return a.each(function () { A(this, d) }) } }, H = a.fn.form.extensions.defaults = { method: "post", showLoading: !0, loadingLocale: "body", loadingMessage: "\u6b63\u5728\u5c06\u6570\u636e\u53d1\u9001\u81f3\u670d\u52a1\u5668...", loadedDelay: 300, serializer: { onlyEnabled: !0, transcript: "overlay", overtype: "append", separator: "," } }; a.extend(a.fn.form.defaults, H); a.extend(a.fn.form.methods, f); a.fn.form.comboList = "combo datebox datetimebox combogrid combotree combobox".split(" "); a.fn.form.spinnerList = ["timespinner", "numberspinner", "spinner"]; a.fn.form.valueMarkList = ["input", "textarea", "select"]; a.fn.form.textMarkList = ["span", "label", "div", "p"]; a.fn.form.otherList = ["numberbox", "slider"] })(jQuery); (function (a, u) { function w(d) { var e = a(d), f = e.validatebox("options"); f._initialized || (e.addClass("validatebox-f").change(function () { f.value = a(this).val(); a.isFunction(f.onChange) && f.onChange.call(d, f.value) }), (f.originalValue = f.value) && m(d, f.value), f.width && !e.parent().is("span.combo,span.spinner,span.searchbox") && g(d, f.width), A(d, f.prompt, f), f.autoFocus && a.util.exec(function () { e.focus() }), f.autovalidate || e.validatebox("disableValidation").validatebox("enableValidation"), c(d, f.disabled), f._initialized = !0) } function A(d, c, e) { var f = a(d); e = e || f.validatebox("options"); e.prompt = c; a.html5.testProp("placeholder", f[0].nodeName) ? f.attr("placeholder", c) : (a.isFunction(e.promptFocus) || (e.promptFocus = function () { f.hasClass("validatebox-prompt") && (f.removeClass("validatebox-prompt"), f.val() == e.prompt && f.val("")) }, f.focus(e.promptFocus)), a.isFunction(e.promptBlur) || (e.promptBlur = function () { a.string.isNullOrEmpty(f.val()) && f.addClass("validatebox-prompt").val(e.prompt) }, f.blur(e.promptBlur)), a.string.isNullOrEmpty(f.val()) && !a.string.isNullOrEmpty(e.prompt) && a.util.exec(function () { f.addClass("validatebox-prompt").val(e.prompt) })) } function r(d) { d = a(d); d.hasClass("validatebox-prompt") && d.removeClass("validatebox-prompt").val(""); return e.call(d, d) } function m(d, c) { var e = a(d), f = e.validatebox("options"); e.val() != c && e.val(f.value = c ? c : ""); r(d) } function g(d, c) { var e = a(d), f = e.validatebox("options"); e._outerWidth(f.width = c) } function c(d, c) { var e = a(d), f = a.data(d, "validatebox"); c ? (f && f.options && (f.options.disabled = !0), e.attr("disabled", !0)) : (f && f.options && (f.options.disabled = !1), e.removeAttr("disabled")) } a.fn.validatebox.extensions = {}; a.extend(a.fn.validatebox.defaults.rules, { engNum: { validator: function (a) { return /^[0-9a-zA-Z]*$/.test(a) }, message: "\u8bf7\u8f93\u5165\u82f1\u6587\u5b57\u6bcd\u6216\u6570\u5b57" }, chsEngNum: { validator: function (a, d) { return /^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9])*$/.test(a) }, message: "\u53ea\u5141\u8bb8\u6c49\u5b57\u3001\u82f1\u6587\u5b57\u6bcd\u6216\u6570\u5b57\u3002" }, code: { validator: function (a, d) { return /^[\u0391-\uFFE5\w]+$/.test(a) }, message: "\u53ea\u5141\u8bb8\u6c49\u5b57\u3001\u82f1\u6587\u5b57\u6bcd\u3001\u6570\u5b57\u53ca\u4e0b\u5212\u7ebf." }, name: { validator: function (a) { return a.isUserName() }, message: "\u7528\u6237\u540d\u4e0d\u5408\u6cd5(\u5b57\u6bcd\u5f00\u5934\uff0c\u5141\u8bb86-16\u5b57\u8282\uff0c\u5141\u8bb8\u5b57\u6bcd\u6570\u5b57\u4e0b\u5212\u7ebf)" }, minLength: { validator: function (d, c) { return a.string.trim(d).length >= c[0] }, message: "\u6700\u5c11\u8f93\u5165 {0} \u4e2a\u5b57\u7b26." }, maxLength: { validator: function (d, c) { return a.string.trim(d).length <= c[0] }, message: "\u6700\u591a\u8f93\u5165 {0} \u4e2a\u5b57\u7b26." }, contains: { validator: function (d, c) { return a.string.contains(d, c[0]) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u5305\u542b {0}." }, startsWith: { validator: function (d, c) { return a.string.startsWith(d, c[0]) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u4ee5 {0} \u4f5c\u4e3a\u8d77\u59cb\u5b57\u7b26." }, endsWith: { validator: function (d, c) { return a.string.endsWith(d, c[0]) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u4ee5 {0} \u4f5c\u4e3a\u8d77\u59cb\u5b57\u7b26." }, longDate: { validator: function (d) { return a.string.isLongDate(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u957f\u65e5\u671f\u65f6\u95f4(yyyy-MM-dd hh:mm:ss)\u683c\u5f0f." }, shortDate: { validator: function (d) { return a.string.isShortDate(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u77ed\u65e5\u671f(yyyy-MM-dd)\u683c\u5f0f." }, date: { validator: function (d) { return a.string.isDate(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u957f\u65e5\u671f\u65f6\u95f4(yyyy-MM-dd hh:mm:ss)\u6216\u77ed\u65e5\u671f(yyyy-MM-dd)\u683c\u5f0f." }, tel: { validator: function (d) { return a.string.isTel(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u7535\u8bdd\u53f7\u7801(\u4e2d\u56fd)\u683c\u5f0f." }, mobile: { validator: function (d) { return a.string.isMobile(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u79fb\u52a8\u7535\u8bdd\u53f7\u7801(\u4e2d\u56fd)\u683c\u5f0f." }, telOrMobile: { validator: function (d) { return a.string.isTelOrMobile(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u7535\u8bdd\u53f7\u7801(\u4e2d\u56fd)\u6216\u79fb\u52a8\u7535\u8bdd\u53f7\u7801(\u4e2d\u56fd)\u683c\u5f0f." }, fax: { validator: function (d) { return a.string.isFax(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u4f20\u771f\u53f7\u7801(\u4e2d\u56fd)\u683c\u5f0f." }, zipCode: { validator: function (d) { return a.string.isZipCode(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u90ae\u653f\u7f16\u7801(\u4e2d\u56fd)\u683c\u5f0f." }, existChinese: { validator: function (d) { return a.string.existChinese(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u5305\u542b\u4e2d\u6587\u6c49\u5b57." }, chinese: { validator: function (d) { return a.string.isChinese(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u7eaf\u4e2d\u6587\u6c49\u5b57." }, english: { validator: function (d) { return a.string.isEnglish(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u7eaf\u82f1\u6587\u5b57\u6bcd." }, fileName: { validator: function (d) { return a.string.isFileName(d) }, message: '\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u5408\u6cd5\u7684\u6587\u4ef6\u540d(\u4e0d\u80fd\u5305\u542b\u5b57\u7b26 \\/:*?"\x3c\x3e|).' }, ip: { validator: function (d) { return a.string.isIPv4(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6b63\u786e\u7684 IP\u5730\u5740v4 \u683c\u5f0f." }, url: { validator: function (d) { return a.string.isUrl(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6b63\u786e\u7684 url \u683c\u5f0f." }, ipurl: { validator: function (d) { return a.string.isUrlOrIPv4(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6b63\u786e\u7684 IP\u5730\u5740v4 \u6216 url \u683c\u5f0f." }, currency: { validator: function (d) { return a.string.isCurrency(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6b63\u786e\u7684\u8d27\u5e01\u91d1\u989d(\u963f\u62c9\u4f2f\u6570\u5b57\u8868\u793a\u6cd5)\u683c\u5f0f." }, qq: { validator: function (d) { return a.string.isQQ(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6b63\u786e QQ \u53f7\u7801\u683c\u5f0f." }, msn: { validator: function (d) { return a.string.isMSN(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6b63\u786e MSN \u8d26\u6237\u540d\u683c\u5f0f." }, unNormal: { validator: function (d) { return a.string.isUnNormal(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u4e0d\u5305\u542b\u7a7a\u683c\u548c\u975e\u6cd5\u5b57\u7b26Z." }, carNo: { validator: function (d) { return a.string.isCarNo(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u5408\u6cd5\u7684\u6c7d\u8f66\u8f66\u724c\u53f7\u7801\u683c\u5f0f." }, carEngineNo: { validator: function (d) { return a.string.isCarEngineNo(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u5408\u6cd5\u7684\u6c7d\u8f66\u53d1\u52a8\u673a\u5e8f\u5217\u53f7\u683c\u5f0f." }, idCard: { validator: function (d) { return a.string.isIDCard(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u5408\u6cd5\u7684\u8eab\u4efd\u8bc1\u53f7\u7801(\u4e2d\u56fd)\u683c\u5f0f." }, integer: { validator: function (d) { return a.string.isInteger(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u5408\u6cd5\u7684\u6574\u6570\u683c\u5f0f." }, integerRange: { validator: function (d, c) { return a.string.isInteger(d) && (c[0] || d >= c[0]) && (c[1] || d <= c[1]) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u5408\u6cd5\u7684\u6574\u6570\u683c\u5f0f\u4e14\u503c\u4ecb\u4e8e {0} \u4e0e {1} \u4e4b\u95f4." }, numeric: { validator: function (d, c) { return a.string.isNumeric(d, c ? c[0] : u) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6307\u5b9a\u7c7b\u578b\u7684\u6570\u5b57\u683c\u5f0f." }, numericRange: { validator: function (d, c) { return a.string.isNumeric(d, c ? c[2] : u) && (c[0] || d >= c[0]) && (c[1] || d <= c[1]) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6307\u5b9a\u7c7b\u578b\u7684\u6570\u5b57\u683c\u5f0f\u4e14\u4ecb\u4e8e {0} \u4e0e {1} \u4e4b\u95f4." }, color: { validator: function (d) { return a.string.isColor(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u6b63\u786e\u7684 \u989c\u8272(#FFFFFF\u5f62\u5f0f) \u683c\u5f0f." }, password: { validator: function (d) { return a.string.isSafePassword(d) }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u5fc5\u987b\u662f\u5b89\u5168\u7684\u5bc6\u7801\u5b57\u7b26(\u7531\u5b57\u7b26\u548c\u6570\u5b57\u7ec4\u6210\uff0c\u81f3\u5c11 6 \u4f4d)\u683c\u5f0f." }, equals: { validator: function (d, c) { var e = c[0], f = c[1]; if (f) switch (String(f).toLowerCase()) { case "jquery": case "dom": e = a(e).val(); break; case "id": e = a("#" + e).val() } return d === e }, message: "\u8f93\u5165\u7684\u5185\u5bb9\u4e0d\u5339\u914d." }, remote: { validator: function (d, c) { debugger; var e = a("#House_BuildID").comboselector("getValue"), f = a("#House_Hunit").val(), g = a("#House_Doorplate").val(); a.post(c + "House_BuildID\x3d" + e + "\x26House_Hunit\x3d" + f + "\x26House_Doorplate\x3d" + g + "", { name: d }, function (d) { "1" == d ? (flag = !0, a.data(document.body, "flag", flag)) : "0" == d && (flag = !1, a.data(document.body, "flag", flag)) }); return a.data(document.body, "flag") }, message: "\u5f53\u524d\u697c\u5c42\u5355\u5143\u5df2\u5b58\u5728\u76f8\u540c\u7684\u95e8\u724c\u53f7\u7801\uff0c\u95e8\u724c\u53f7\u4e0d\u80fd\u91cd\u590d!" } }); var e = a.fn.validatebox.methods.isValid, d = a.fn.validatebox; a.fn.validatebox = function (c, e) { if ("string" == typeof c) return d.apply(this, arguments); c = c || {}; return this.each(function () { var e = a(this), f = a.data(this, "validatebox") ? c : a.extend({}, a.fn.validatebox.parseOptions(this), a.parser.parseOptions(this, ["prompt", { autoFocus: "boolean" }]), c); f.value = f.value || e.val(); d.call(e, f); w(this) }) }; a.union(a.fn.validatebox, d); var f = a.fn.validatebox.extensions.methods = { setPrompt: function (a, d) { return a.each(function () { A(this, d) }) }, validate: function (a) { return a.each(function () { r(this) }) }, isValid: function (a) { return r(a[0]) }, setValue: function (a, d) { return a.each(function () { m(this, d) }) }, getValue: function (d) { return a(d[0]).val() }, clear: function (d) { return d.each(function () { var d = a(this); d.validatebox("options"); d.validatebox("setValue", "") }) }, reset: function (d) { return d.each(function () { var d = a(this), c = d.validatebox("options"); d.validatebox("setValue", c.originalValue ? c.originalValue : "") }) }, resize: function (a, d) { return a.each(function () { g(this, d) }) }, enable: function (a) { return a.each(function () { c(this, !1) }) }, disable: function (a) { return a.each(function () { c(this, !0) }) } }, H = a.fn.validatebox.extensions.defaults = { prompt: null, autoFocus: !1, value: null, width: null, autovalidate: !0, disabled: !1, onChange: function (a) { } }; a.extend(a.fn.validatebox.defaults, H); a.extend(a.fn.validatebox.methods, f); a.fn.form && a.isArray(a.fn.form.otherList) && a.fn.form.otherList.push("validatebox"); var D = a.fn.val; a.fn.val = function (d) { if (0 < this.length && this.is(".validatebox-text.validatebox-prompt") && !a.html5.testProp("placeholder", this[0].nodeName)) { var c, e = this.validatebox("options"); if (0 == arguments.length) return c = D.apply(this, arguments), c == e.prompt ? "" : c; d && d != e.prompt && this.removeClass("validatebox-prompt") } return D.apply(this, arguments) } })(jQuery); (function (a, u) { function w(c) { var d = a(c); c = a.data(c, "combo"); var f = d.combo("options"), g = c.panel; c = c.combo; var m = f.extensions ? f.extensions : f.extensions = {}; m._initialized || (d.combo("textbox").focus(function () { f.autoShowPanel && g.is(":hidden") && d.combo("showPanel") }), f.iconCls && d.combo("setIcon", f.iconCls), !f.nullable && a.array.isNullOrEmpty(f.value) && d.combo("setValues", [null]), a.util.browser.msie && c._outerWidth() != f.width && a.util.exec(function () { d.combo("resize", f.width) }), m._initialized = !0) } a.fn.combo.extensions = {}; var A = a.fn.combo.methods.destroy, r = a.fn.combo.methods.setValues, m = a.fn.combo; a.fn.combo = function (c, d) { if ("string" == typeof c) return m.apply(this, arguments); c = c || {}; return this.each(function () { var d = a(this), g = a.data(this, "combo") ? c : a.extend({}, a.fn.combo.parseOptions(this), a.parser.parseOptions(this, ["iconCls", { autoShowPanel: "boolean" }]), c); m.call(d, g); w(this) }) }; a.union(a.fn.combo, m); var g = a.fn.combo.extensions.defaults = { iconCls: null, autoShowPanel: !0, nullable: !0, onBeforeDestroy: function () { }, onDestroy: function () { } }, c = a.fn.combo.extensions.methods = { setIcon: function (c, d) { return c.each(function () { var c = a(this), e = a.data(this, "combo").combo.find("span.combo-arrow").removeAttr("class").addClass("combo-arrow"); d && e.addClass(d); c.combo("options").iconCls = d }) }, setRequired: function (c, d) { return c.each(function () { var c = a(this), e = c.combo("options"), c = c.combo("textbox"); e.required = c.validatebox("options").required = d }) }, setPrompt: function (c, d) { return c.each(function () { var c = a(this), e = c.combo("options"), c = c.combo("textbox"); e.prompt = d; c.validatebox("setPrompt", d) }) }, destroy: function (c) { return c.each(function () { var d = a(this), c = d.combo("options"); a.isFunction(c.onBeforeDestroy) && 0 == c.onBeforeDestroy.call(this) || (A.call(this, d), a.isFunction(c.onDestroy) && c.onDestroy.call(this)) }) }, combo: function (c) { return a.data(c[0], "combo").combo }, setValues: function (c, d) { return c.each(function () { var c = d, e = a(this); !e.combo("options").nullable && a.array.isNullOrEmpty(c) && (c = [null]); r.call(e, e, c) }) }, clear: function (c) { return c.each(function () { var d = a.data(this, "combo"), c = d.options, d = d.combo; c.multiple && d.find("input.combo-value" + (c.nullable ? "" : ":gt(0)")).remove(); d.find("input.combo-value,input.combo-text").val("") }) } }; a.extend(a.fn.combo.defaults, g); a.extend(a.fn.combo.methods, c); a.easyui.bindPageNestedFunc("mousedown", "jdirkCombo", "combo", function (a, d) { var c = a.jQuery, g = c(d.target).closest("span.combo,div.combo-p"); if (g.length && (c(g).find(".combo-f").each(function () { var a = c(this).combo("panel"); a.is(":visible") && a.panel("close") }), d.target && d.target.ownerDocument == a.document)) return; c("body\x3ediv.combo-p\x3ediv.combo-panel:visible").panel("close") }) })(jQuery); (function (a, u) { function w(g) { g = a(g); var c = g.combobox("options"), e = g.combobox("getValue"); g = g.combobox("getData"); return a.array.first(g, function (a) { return a[c.valueField] == e }) } function A(g) { g = a(g); var c = g.combobox("options"), e = g.combobox("getValues"); g = g.combobox("getData"); return a.array.filter(g, function (d) { return a.array.contains(e, d[c.valueField]) }) } a.fn.combobox.extensions = {}; var r = a.fn.combobox.extensions.defaults = { queryParams: null, loader: function (g, c, e) { var d = a(this).combobox("options"); if (!d.url) return !1; if (d.queryParams) { var f = a.util.parseMapFunction(d.queryParams); g = a.extend({}, g, f) } a.ajax({ type: d.method, url: d.url, data: g, dataType: "json", success: function (a) { c(a) }, error: function () { e.apply(this, arguments) } }) } }, m = a.fn.combobox.extensions.methods = { load: function (g, c) { return g.each(function () { var e = a(this); c && ("string" === typeof c ? e.combobox("reload", c) : (e.combobox("options").queryParams = c, e.combobox("reload"))) }) }, getItem: function (a) { return w(a[0]) }, getItems: function (a) { return A(a[0]) } }; a.extend(a.fn.combobox.defaults, r); a.extend(a.fn.combobox.methods, m) })(jQuery); (function (a, u) { function w(d) { function c(e) { var f = []; e.addClass("menu"); f.push(e); e.hasClass("menu-content") || e.children("div").each(function () { var e = a(this).children("div"); e.length && (e.insertAfter(d), this.submenu = e, e = c(e), f = f.concat(e)) }); return f } function e(c) { var n = a.parser.parseOptions(c[0], ["width", "height"]); c[0].originalHeight = n.height || 0; c.hasClass("menu-content") ? c[0].originalWidth = n.width || c._outerWidth() : (c[0].originalWidth = n.width || 0, c.children("div").each(function () { var c = a(this), e = a.extend({ hideOnClick: !0 }, a.parser.parseOptions(this, ["name", "iconCls", "href", { hideOnClick: "boolean", separator: "boolean" }]), { disabled: c.attr("disabled") ? !0 : u }); e.separator && c.addClass("menu-sep"); if (!c.hasClass("menu-sep")) { c[0].itemName = e.name || ""; c[0].itemHref = e.href || ""; c[0].hideOnClick = e.hideOnClick == u || null == e.hideOnClick ? !0 : e.hideOnClick; var n = c.addClass("menu-item").html(); c.empty().append(a('\x3cdiv class\x3d"menu-text"\x3e\x3c/div\x3e').html(n)); e.iconCls && a('\x3cdiv class\x3d"menu-icon"\x3e\x3c/div\x3e').addClass(e.iconCls).appendTo(c); e.disabled && f(d, c[0], !0); c[0].submenu && a('\x3cdiv class\x3d"menu-rightarrow"\x3e\x3c/div\x3e').appendTo(c); m(d, c) } }), a('\x3cdiv class\x3d"menu-line"\x3e\x3c/div\x3e').prependTo(c)); A(d, c); c.hide(); r(d, c) } for (var z = a(d).appendTo("body").addClass("menu-top"), z = c(z), n = 0; n < z.length; n++) e(z[n]) } function A(d, c) { var e = a.data(d, "menu").options, f = c.attr("style") || ""; c.css({ display: "block", left: -1E4, height: "auto", overflow: "hidden" }); var n = c[0], g = n.originalWidth || 0; g || (g = 0, c.find("div.menu-text").each(function () { g < a(this)._outerWidth() && (g = a(this)._outerWidth()); a(this).closest("div.menu-item")._outerHeight(a(this)._outerHeight() + 2) }), g += 40); var g = Math.max(g, e.minWidth), e = n.originalHeight || c.outerHeight(), k = Math.max(n.originalHeight, c.outerHeight()) - 2; c._outerWidth(g)._outerHeight(e); c.children("div.menu-line")._outerHeight(k); f += ";width:" + n.style.width + ";height:" + n.style.height; c.attr("style", f) } function r(d, c) { var e = a.data(d, "menu"); c.unbind(".menu").bind("mouseenter.menu", function () { e.timer && (clearTimeout(e.timer), e.timer = null) }).bind("mouseleave.menu", function () { e.options.hideOnUnhover && (e.timer = setTimeout(function () { g(d) }, 100)) }) } function m(d, c) { c.hasClass("menu-item") && (c.unbind(".menu"), c.bind("click.menu", function () { var c = a(this); c.hasClass("menu-item-disabled") || (!this.submenu && (this.hideOnClick && g(d), c = c.attr("href")) && (location.href = c), c = a(d).menu("getItem", this), a.data(d, "menu").options.onClick.call(d, c)) }).bind("mouseenter.menu", function (f) { c.siblings().each(function () { this.submenu && e(this.submenu); a(this).removeClass("menu-active") }); c.addClass("menu-active"); a(this).hasClass("menu-item-disabled") ? c.addClass("menu-active-disabled") : (f = c[0].submenu) && a(d).menu("show", { menu: f, parent: c }) }).bind("mouseleave.menu", function (a) { c.removeClass("menu-active menu-active-disabled"); var d = c[0].submenu; d ? a.pageX >= parseInt(d.css("left")) ? c.addClass("menu-active") : e(d) : c.removeClass("menu-active") })) } function g(d) { var c = a.data(d, "menu"); c && a(d).is(":visible") && (e(a(d)), c.options.onHide.call(d)); return !1 } function c(d, c) { var e, f; c = c || {}; var n = a(c.menu || d); if (n.hasClass("menu-top")) { var g = a.data(d, "menu").options; a.extend(g, c); e = g.left; f = g.top; if (g.alignTo) { var k = a(g.alignTo); e = k.offset().left; f = k.offset().top + k._outerHeight(); "right" == g.align && (e += k.outerWidth() - n.outerWidth()) } e + n.outerWidth() > a(window)._outerWidth() + a(document)._scrollLeft() && (e = a(window)._outerWidth() + a(document).scrollLeft() - n.outerWidth() - 5); 0 > e && (e = 0) } else f = c.parent, e = f.offset().left + f.outerWidth() - 2, e + n.outerWidth() + 5 > a(window)._outerWidth() + a(document).scrollLeft() && (e = f.offset().left - n.outerWidth() + 2), f = f.offset().top - 3; f + n.outerHeight() > a(window)._outerHeight() + a(document).scrollTop() && (f = a(window)._outerHeight() + a(document).scrollTop() - n.outerHeight() - 5); n.css({ left: e, top: f }); n.show(0, function () { n[0].shadow || (n[0].shadow = a('\x3cdiv class\x3d"menu-shadow"\x3e\x3c/div\x3e').insertAfter(n)); n[0].shadow.css({ display: "block", zIndex: a.fn.menu.defaults.zIndex++, left: n.css("left"), top: n.css("top"), width: n.outerWidth(), height: n.outerHeight() }); n.css("z-index", a.fn.menu.defaults.zIndex++); n.hasClass("menu-top") && a.data(n[0], "menu").options.onShow.call(n[0]) }) } function e(d) { function c(a) { a.stop(!0, !0); a[0].shadow && a[0].shadow.hide(); a.hide() } d && (c(d), d.find("div.menu-item").each(function () { this.submenu && e(this.submenu); a(this).removeClass("menu-active") })) } function d(d, c) { function e(g) { g.children("div.menu-item").each(function () { var g = a(d).menu("getItem", this), p = n.empty().html(g.text).text(); c == a.trim(p) ? f = g : this.submenu && !f && e(this.submenu) }) } var f = null, n = a("\x3cdiv\x3e\x3c/div\x3e"); e(a(d)); n.remove(); return f } function f(d, c, e) { d = a(c); d.hasClass("menu-item") && (e ? (d.addClass("menu-item-disabled"), c.onclick && (c.onclick1 = c.onclick, c.onclick = null)) : (d.removeClass("menu-item-disabled"), c.onclick1 && (c.onclick = c.onclick1, c.onclick1 = null))) } function H(d, c) { var e = a(d); c.parent && (c.parent.submenu || (e = a('\x3cdiv class\x3d"menu"\x3e\x3cdiv class\x3d"menu-line"\x3e\x3c/div\x3e\x3c/div\x3e').appendTo("body"), e.hide(), c.parent.submenu = e, a('\x3cdiv class\x3d"menu-rightarrow"\x3e\x3c/div\x3e').appendTo(c.parent)), e = c.parent.submenu); if (c.separator) var g = a('\x3cdiv class\x3d"menu-sep"\x3e\x3c/div\x3e').appendTo(e); else g = a('\x3cdiv class\x3d"menu-item"\x3e\x3c/div\x3e').appendTo(e), a('\x3cdiv class\x3d"menu-text"\x3e\x3c/div\x3e').html(c.text).appendTo(g); c.iconCls && a('\x3cdiv class\x3d"menu-icon"\x3e\x3c/div\x3e').addClass(c.iconCls).appendTo(g); c.id && g.attr("id", c.id); c.name && (g[0].itemName = c.name); c.href && (g[0].itemHref = c.href); c.onclick && ("string" == typeof c.onclick ? g.attr("onclick", c.onclick) : g[0].onclick = eval(c.onclick)); c.handler && (g[0].onclick = eval(c.handler)); c.disabled && f(d, g[0], !0); m(d, g); r(d, e); A(d, e) } function D(d, c) { function e(d) { if (d.submenu) { d.submenu.children("div.menu-item").each(function () { e(this) }); var c = d.submenu[0].shadow; c && c.remove(); d.submenu.remove() } a(d).remove() } e(c) } function y(d) { a(d).children("div.menu-item").each(function () { D(d, this) }); d.shadow && d.shadow.remove(); a(d).remove() } a.fn.menu = function (d, c) { if ("string" == typeof d) return a.fn.menu.methods[d](this, c); d = d || {}; return this.each(function () { var c = a.data(this, "menu"); c ? a.extend(c.options, d) : (c = a.data(this, "menu", { options: a.extend({}, a.fn.menu.defaults, a.fn.menu.parseOptions(this), d) }), w(this)); a(this).css({ left: c.options.left, top: c.options.top }) }) }; a.fn.menu.methods = { options: function (d) { return a.data(d[0], "menu").options }, show: function (a, d) { return a.each(function () { c(this, d) }) }, hide: function (a) { return a.each(function () { g(this) }) }, destroy: function (a) { return a.each(function () { y(this) }) }, setText: function (d, c) { return d.each(function () { a(c.target).children("div.menu-text").html(c.text) }) }, setIcon: function (d, c) { return d.each(function () { a(c.target).children("div.menu-icon").remove(); c.iconCls && a('\x3cdiv class\x3d"menu-icon"\x3e\x3c/div\x3e').addClass(c.iconCls).appendTo(c.target) }) }, getItem: function (d, c) { var e = a(c), f = { target: c, id: e.attr("id"), text: a.trim(e.children("div.menu-text").html()), disabled: e.hasClass("menu-item-disabled"), name: c.itemName, href: c.itemHref, hideOnClick: c.hideOnClick, onclick: c.onclick }, g = e.children("div.menu-icon"); if (g.length) { for (var e = [], g = g.attr("class").split(" "), v = 0; v < g.length; v++) "menu-icon" != g[v] && e.push(g[v]); f.iconCls = e.join(" ") } return f }, findItem: function (a, c) { return d(a[0], c) }, appendItem: function (a, d) { return a.each(function () { H(this, d) }) }, removeItem: function (a, d) { return a.each(function () { D(this, d) }) }, enableItem: function (a, d) { return a.each(function () { f(this, d, !1) }) }, disableItem: function (a, d) { return a.each(function () { f(this, d, !0) }) } }; a.fn.menu.parseOptions = function (d) { return a.extend({}, a.parser.parseOptions(d, ["left", "top", { minWidth: "number", hideOnUnhover: "boolean" }])) }; a.fn.menu.defaults = { zIndex: 11E4, left: 0, top: 0, alignTo: null, align: "left", minWidth: 120, hideOnUnhover: !0, onShow: function () { }, onHide: function () { }, onClick: function (a) { } }; a.easyui.bindPageNestedFunc("mousedown", "jdirkMenu", "menu", function (a, d) { var c = a.jQuery, e = c("body\x3ediv.menu:visible"); c(d.target).closest("div.menu", e).length || c("body\x3ediv.menu-top:visible").menu("hide") }); var F = function (d) { var c = a("\x3cdiv\x3e\x3c/div\x3e").appendTo("body"), e = a.extend({}, a.fn.menu.defaults, { left: window.event ? window.event.clientX : 0, top: window.event ? window.event.clientY : 0, hideOnUnhover: !1, slideOut: !1, autoDestroy: !0, items: null, hideDisabledMenu: !1, minWidth: 140 }, d || {}); e.items = a.util.likeArrayNotString(e.items) ? e.items : []; e.id && c.attr("id", e.id); e.name && c.attr("name", e.name); e.items.length || e.items.push({ text: "\u5f53\u524d\u65e0\u83dc\u5355\u9879", disabled: !0 }); a.each(e.items, function (a, d) { e.hideDisabledMenu && d.disabled || G(c, d, c) }); return { menu: c, options: e } }, G = function (d, c, e) { if (a.util.isString(c) && a.array.contains(["-", "\u2014", "|"], a.trim(c))) a("\x3cdiv\x3e\x3c/div\x3e").addClass("menu-sep").appendTo(d); else { c = a.extend({ id: null, text: null, iconCls: null, href: null, disabled: !1, onclick: null, handler: null, bold: !1, style: null, children: null, hideDisabledMenu: !1, hideOnClick: !0 }, c || {}); var f = c.onclick, g = c.handler; c.onclick = u; c.handler = u; c = a.util.parseMapFunction(c); c.onclick = f; c.handler = g; if (!c.hideDisabledMenu || !c.disabled) { var v = a("\x3cdiv\x3e\x3c/div\x3e").attr({ iconCls: c.iconCls, href: c.href, disabled: c.disabled, hideOnClick: c.hideOnClick }).appendTo(d); c.id && v.attr("id", c.id); c.style && v.css(c.style); a.isFunction(c.handler) && (g = c.handler, c.onclick = function (a, c, d) { g.call(this, a, c, d) }); a.isFunction(c.onclick) && v.click(function (a) { v.hasClass("menu-item-disabled") || c.onclick.call(this, a, c, e) }); d = c.children && c.children.length ? !0 : !1; f = a("\x3cspan\x3e\x3c/span\x3e").appendTo(v); c.text && f.text(c.text); c.bold && f.css("font-weight", "bold"); if (d) { var k = a("\x3cdiv\x3e\x3c/div\x3e").appendTo(v); a.each(c.children, function (d, f) { var g = a.util.isString(f) && a.array.contains(["-", "\u2014", "|"], a.trim(f)) ? f : a.extend({ hideDisabledMenu: c.hideDisabledMenu }, f); G(k, g, e) }) } } } }; a.extend(a.easyui, { createMenu: F, showMenu: function (c) { c = F(c); var d = c.menu, e = d.menu(c.options).menu("options"), f = e.onHide; e.onHide = function () { var c = a(this); a.isFunction(f) && f.apply(this, arguments); e.autoDestroy && a.util.exec(function () { c.menu("destroy") }) }; d.menu("show", { left: e.left, top: e.top }); e.slideOut && (d.hide().slideDown(200), d[0] && d[0].shadow && d[0].shadow.hide().slideDown(200)); return d } }) })(jQuery); (function (a, u) { a.fn.searchbox.extensions = {}; var w = a.fn.searchbox.methods.destroy, A = a.fn.searchbox; a.fn.searchbox = function (g, c) { if ("string" == typeof g) { var e = a.fn.searchbox.methods[g]; return e ? e(this, c) : this.each(function () { a(this).searchbox("textbox").validatebox(g, c) }) } g = g || {}; return this.each(function () { var c = a(this), e = a.data(this, "searchbox") ? g : a.extend({}, a.fn.validatebox.parseOptions(this), g); A.call(c, e); c = a.data(this, "searchbox"); e = c.options; e._initialized || (c.searchbox.find("input.searchbox-text").validatebox(e), e._initialized = !0) }) }; a.union(a.fn.searchbox, A); var r = a.fn.searchbox.extensions.methods = { destroy: function (g) { return g.each(function () { var c = a(this); c.searchbox("textbox").validatebox("destroy"); w.call(c, c) }) } }, m = a.fn.searchbox.extensions.defaults = {}; a.extend(a.fn.searchbox.defaults, m); a.extend(a.fn.searchbox.methods, r); a.fn.form && a.isArray(a.fn.form.otherList) && a.fn.form.otherList.push("searchbox"); a.extend(a.fn.datagrid.defaults.editors, { searchbox: { init: function (g, c) { var e = a('\x3cinput type\x3d"text"\x3e\x3c/input\x3e').appendTo(g).searchbox(c); e.searchbox("textbox").addClass("datagrid-editable-input"); return e }, destroy: function (g) { a(g).searchbox("destroy") }, getValue: function (g) { return a(g).searchbox("getValue") }, setValue: function (g, c) { a(g).searchbox("setValue", c) }, resize: function (g, c) { a(g).searchbox("resize", c) }, setFocus: function (g) { a(g).searchbox("textbox").focus() } } }) })(jQuery); (function (a, u) { function w(c) { var d = a(c), e = a.data(c, "panel"), f = e.options; if (f.href) { if (!e.isLoaded || !f.cache) { var g = a.extend({}, f.queryParams); 0 != f.onBeforeLoad.call(c, g) && (e.isLoaded = !1, A(c), f.loadingMessage && d.html(a('\x3cdiv class\x3d"panel-loading"\x3e\x3c/div\x3e').html(f.loadingMessage)), f.loader.call(c, g, function (g) { var v = f.extractor.call(c, g); d.html(v); a.parser.parse(d); f.onLoad.apply(c, arguments); e.isLoaded = !0 }, function () { f.onLoadError.apply(c, arguments) })) } } else f.content && !e.isLoaded && (A(c), d.html(f.content), a.parser.parse(d), e.isLoaded = !0) } function A(c) { c = a(c); c.find(".combo-f").each(function () { a(this).combo("destroy") }); c.find(".m-btn").each(function () { a(this).menubutton("destroy") }); c.find(".s-btn").each(function () { a(this).splitbutton("destroy") }); c.find(".tooltip-f").each(function () { a(this).tooltip("destroy") }); c.children("div").each(function () { a(this)._fit(!1) }) } function r(c, d) { var e = a.data(c, "panel"), f = e.options; e.isLoaded = !1; d && ("string" == typeof d ? f.href = d : f.queryParams = d); f.iniframe ? (e = f._extensionsPanel ? f._extensionsPanel : f._extensionsPanel = { href: f.href, content: f.content }, e.href = f.href, e.content = f.content, f.href = null, f.content = '\x3ciframe class\x3d"panel-iframe" frameborder\x3d"0" width\x3d"100%" height\x3d"100%" marginwidth\x3d"0px" marginheight\x3d"0px" scrolling\x3d"auto"\x3e\x3c/iframe\x3e', w(c), f.href = e.href, f.content = e.content, m(c).bind({ load: function () { a.isFunction(f.onLoad) && f.onLoad.apply(c, arguments) }, error: function () { a.isFunction(f.onLoadError) && f.onLoadError.apply(c, arguments) } }).attr("src", f.href || "")) : w(c) } function m(c) { return a(c).panel("body").children("iframe.panel-iframe") } a.fn.panel.extensions = {}; var g = function () { a("iframe,frame", this).each(function () { try { this.contentWindow && this.contentWindow.document && this.contentWindow.close && (this.contentWindow.document.write(""), this.contentWindow.close()), a.isFunction(window.CollectGarbage) && window.CollectGarbage() } catch (c) { } }).remove() }; a.fn.panel.defaults.onBeforeDestroy = g; a.fn.window.defaults.onBeforeDestroy = g; a.fn.dialog.defaults.onBeforeDestroy = g; a.fn.datagrid.defaults.onBeforeDestroy = g; a.fn.propertygrid.defaults.onBeforeDestroy = g; a.fn.treegrid.defaults.onBeforeDestroy = g; var c = { panel: a.fn.panel.defaults.onResize, window: a.fn.window.defaults.onResize, dialog: a.fn.dialog.defaults.onResize }, e = { panel: a.fn.panel.defaults.onMove, window: a.fn.window.defaults.onMove, dialog: a.fn.dialog.defaults.onMove }, d = function (c) { c = a(c).panel("panel").parent(); var d = c.parent(); return c.hasClass("tabs-panels") && d.hasClass("tabs-container") }, f = function (c) { c = a(c).panel("body"); return c.hasClass("window-body") && c.parent().hasClass("window") }, H = a.fn.panel; a.fn.panel = function (c, d) { if ("string" == typeof c) return H.apply(this, arguments); c = c || {}; return this.each(function () { var d = a(this), e = a.data(this, "panel") ? c : a.extend({}, a.fn.panel.parseOptions(this), a.parser.parseOptions(this, [{ minWidth: "number", maxWidth: "number", minHeight: "number", maxHeight: "number" }, { iniframe: "boolean", inContainer: "boolean", keepTitle: "boolean" }]), c); e._extensionsPanel = { href: e.href, content: e.content }; e.iniframe && (e.href = null, e.content = null); H.call(d, e); var d = a(this), e = d.panel("options"), f = e._extensionsPanel ? e._extensionsPanel : e._extensionsPanel = { href: e.href, content: e.content }; e.href = f.href; e.content = f.content; e.bodyStyle && d.panel("body").css(e.bodyStyle); e.iniframe && r(this) }) }; a.union(a.fn.panel, H); var D = a.fn.panel.methods.header, y = a.fn.panel.methods.setTitle, g = a.fn.panel.extensions.methods = { inLayout: function (c) { var d = a(c[0]); c = d.panel("body"); d = d.panel("panel"); return c.hasClass("layout-body") && d.hasClass("layout-panel") }, inTabs: function (a) { return d(a[0]) }, inAccordion: function (c) { var d = a(c[0]); c = d.panel("body"); d = d.panel("panel").parent(); return c.hasClass("accordion-body") && d.hasClass("accordion") && a.data(d[0], "accordion") ? !0 : !1 }, isWindow: function (a) { return f(a[0]) }, isDialog: function (c) { c = c[0]; var d = a(c).panel("body"); return f(c) && (d.children("div.panel").children("div.panel-body.dialog-content").length ? !0 : !1) }, iframe: function (a) { return m(a[0]) }, refresh: function (a, c) { return a.each(function () { r(this, c) }) }, header: function (c) { c = c[0]; var e = a(c); d(c) ? (c = e.panel("panel"), e = c.index(), c = c.closest(".tabs-container").find("\x3ediv.tabs-header\x3ediv.tabs-wrap\x3eul.tabs\x3eli").eq(e)) : c = D.call(e, e); return c }, setTitle: function (c, e) { return c.each(function () { var c = a(this); if (!d(this)) y.call(c, c, e); else if (e) { var f = c.panel("options"), c = c.panel("header"); f.title = e; c.find("\x3ea.tabs-inner\x3espan.tabs-title").text(e) } }) } }, F = a.fn.panel.extensions.defaults = { iniframe: !1, minWidth: 10, maxWidth: 1E4, minHeight: 10, maxHeight: 1E4, onResize: function (d, e) { var f = a(this), g = f.panel("isWindow"), g = f.panel("isDialog") ? "dialog" : g ? "window" : "panel", z = c[g]; a.isFunction(z) && z.apply(this, arguments); if (!f.panel("inLayout")) { var z = f.panel("options"), n = a.isNumeric(z.minWidth) ? z.minWidth : F.minHeight, v = a.isNumeric(z.maxWidth) ? z.maxWidth : F.maxWidth, k = a.isNumeric(z.minHeight) ? z.minHeight : F.minHeight, p = a.isNumeric(z.maxHeight) ? z.maxHeight : F.maxHeight, t = !1; d > v && (d = v, t = !0); d < n && (d = n, t = !0); e > p && (e = p, t = !0); e < k && (e = k, t = !0); if (t && !z.fit) f[g]("resize", { width: d, height: e }) } }, inContainer: !0, bodyStyle: null, onMove: function (c, d) { var f = a(this), g = f.panel("isWindow"), g = f.panel("isDialog") ? "dialog" : g ? "window" : "panel", z = e[g], n = f.panel("options"); a.isFunction(z) && z.apply(this, arguments); if (n.maximized) return f[g]("restore"); if (n.inContainer) { var z = f.panel("panel"), v = z.parent(), k = v.is("body"), v = a.extend({}, k ? a.util.windowSize() : { width: v.innerWidth(), height: v.innerHeight() }), k = a.isNumeric(n.width) ? n.width : z.outerWidth(), n = a.isNumeric(n.height) ? n.height : z.outerHeight(), z = !1; 0 > c && (c = 0, z = !0); 0 > d && (d = 0, z = !0); if (z) return f[g]("move", { left: c, top: d }); c + k > v.width && 0 < c && (c = v.width - k, z = !0); d + n > v.height && 0 < d && (d = v.height - n, z = !0); if (z) return f[g]("move", { left: c, top: d }) } } }; a.extend(a.fn.panel.defaults, F); a.extend(a.fn.panel.methods, g) })(jQuery); (function (a, u) { function w(c, e, d) { return a.array.map(e, function (e, g) { if (!e || a.util.isString(e)) return e; var m = a.extend({}, e); m.id = a.isFunction(e.id) ? e.id.call(m, c, d) : e.id; m.text = a.isFunction(e.text) ? e.text.call(m, c, d) : e.text; m.iconCls = a.isFunction(e.iconCls) ? e.iconCls.call(m, c, d) : e.iconCls; m.disabled = a.isFunction(e.disabled) ? e.disabled.call(m, c, d) : e.disabled; m.hideOnClick = a.isFunction(e.hideOnClick) ? e.hideOnClick.call(m, c, d) : e.hideOnClick; m.onclick = a.isFunction(e.onclick) ? function (a, c, g) { e.onclick.call(this, a, d, c, g) } : e.onclick; m.handler = a.isFunction(e.handler) ? function (a, c, g) { e.handler.call(this, a, d, c, g) } : e.handler; m.children && m.children.length && (m.children = w(c, m.children, d)); return m }) } a.fn.window.extensions = {}; var A = function (c) { var e = a(c), d = a.data(c, "window"), f = e.window("options"), m = e.window("window"); c = e.window("body"); if (!f._initialized) { e.window("header").on({ dblclick: function () { var a = e.window("options"); a.autoRestore && (a.maximized ? e.window("restore") : a.maximizable && e.window("maximize")) }, contextmenu: function (c) { var d = e.window("options"); if (d.enableHeaderContextMenu) { c.preventDefault(); var f = [{ text: "\u6700\u5927\u5316", iconCls: "panel-tool-max", disabled: !d.maximized && d.maximizable ? !1 : !0, onclick: function () { e.window("maximize") } }, { text: "\u6062\u590d", iconCls: "panel-tool-restore", disabled: d.maximized ? !1 : !0, onclick: function () { e.window("restore") } }, "-", { text: "\u5173\u95ed", iconCls: "panel-tool-close", disabled: !d.closable, onclick: function () { e.window("close") } }], d = a.array.likeArray(d.headerContextMenu) ? d.headerContextMenu : []; d.length && a.array.insertRange(f, 0, a.util.merge([], d, "-")); f = w(c, f, e); a.easyui.showMenu({ items: f, left: c.pageX, top: c.pageY }) } } }); f.bodyCls && c.addClass(f.bodyCls); if (f.draggable) { var r = d.window.draggable("options"), y = r.cursor, u = r.onBeforeDrag, A = r.onStartDrag, I = r.onStopDrag, C = r.onDrag; r.cursor = "default"; r.onBeforeDrag = function (a) { if (0 == u.apply(this, arguments) || 1 != a.which || e.window("options").maximized) return !1; r.cursor = y }; r.onStartDrag = function () { A.apply(this, arguments); e.window("body").addClass("window-body-hidden").children().addClass("window-body-hidden-proxy") }; r.onStopDrag = function () { I.apply(this, arguments); e.window("body").removeClass("window-body-hidden").children().removeClass("window-body-hidden-proxy"); r.cursor = "default" }; r.onDrag = function (c) { if (!f.inContainer) return C.apply(this, arguments); var e = c.data.left, g = c.data.top, p = m.parent(), t = p.is("body"), p = a.extend({}, t ? a.util.windowSize() : { width: p.innerWidth(), height: p.innerHeight() }), t = a.isNumeric(f.width) ? f.width : m.outerWidth(), z = a.isNumeric(f.height) ? f.height : m.outerHeight(); 0 > e && (e = 0); 0 > g && (g = 0); e + t > p.width && 0 < e && (e = p.width - t, b = !0); g + z > p.height && 0 < g && (g = p.height - z, b = !0); d.proxy.css({ display: "block", left: e, top: g }); return !1 } } if (f.resizable) { c = d.window.resizable("options"); var M = c.onResize, z = c.onStopResize; c.onResize = function (c) { if (!(f.minWidth || f.maxWidth || f.minHeight || f.maxHeight)) return M.apply(this, arguments); d.proxy.css({ left: c.data.left, top: c.data.top }); var e = c.data.width, k = c.data.height, p = a.isNumeric(f.minWidth) ? f.minWidth : g.minHeight, t = a.isNumeric(f.maxWidth) ? f.maxWidth : g.maxWidth, z = a.isNumeric(f.minHeight) ? f.minHeight : g.minHeight, m = a.isNumeric(f.maxHeight) ? f.maxHeight : g.maxHeight; e > f.maxWidth && (e = t, resizable = !0); e < f.minWidth && (e = p, resizable = !0); k > f.maxHeight && (k = m, resizable = !0); k < f.minHeight && (k = z, resizable = !0); d.proxy._outerWidth(e); d.proxy._outerHeight(k); return !1 }; c.onStopResize = function (a) { var c = z.apply(this, arguments); e.window("options").maximized && e.window("restore").window("maximize"); return c } } f._initialized = !0 } }, r = a.fn.window; a.fn.window = function (c, e) { if ("string" == typeof c) return r.apply(this, arguments); c = c || {}; return this.each(function () { var d = a(this), e = a.data(this, "window") ? c : a.extend({}, a.fn.window.parseOptions(this), a.parser.parseOptions(this, [{ autoHCenter: "boolean", autoVCenter: "boolean", autoCloseOnEsc: "boolean", autoRestore: "boolean", enableHeaderContextMenu: "boolean" }]), c); r.call(d, e); A(this) }) }; a.union(a.fn.window, r); var m = a.fn.window.extensions.methods = {}, g = a.fn.window.extensions.defaults = a.extend({}, a.fn.panel.extensions.defaults, { autoHCenter: !1, autoVCenter: !1, autoCloseOnEsc: !0, autoRestore: !0, enableHeaderContextMenu: !0, headerContextMenu: null }); a.extend(a.fn.window.defaults, g); a.extend(a.fn.window.methods, m); a(function () { a(window).resize(function () { a(".panel-body.window-body").each(function () { var c = a(this), e = c.window("options"); e && e.draggable && (e.autoHCenter || e.autoVCenter ? c.window(e.autoHCenter && e.autoVCenter ? "center" : e.autoHCenter ? "hcenter" : "vcenter") : e.inContainer && c.window("move")) }) }); a(document).keydown(function (c) { 27 == c.which && a("div.window-mask:last").prevAll("div.panel.window:first").children(".panel-body.window-body").each(function () { var c = a(this), d = c.window("options"); d && d.closable && d.autoCloseOnEsc && !c.window("header").find(".panel-tool a").attr("disabled") && a.util.exec(function () { c.window("close") }) }) }); a("body").on("click", "div.window-mask:last", function (c) { a(this).prevAll("div.panel.window:first").shine() }) }) })(jQuery); (function (a, u) { function w(c) { for (var e = a.array.filter(g, function (a) { return a.current == c }), m = e.length; m--;) a.array.remove(g, e[m]) } function A(c, e) { var g = a(c), m = g.dialog("options"), g = g.dialog("contentPanel"), r = g.panel("options"); e && (m.href = e); r.iniframe = m.iniframe; g.panel("refresh", m.href) } function r(c) { return (c = a.data(c, "dialog")) ? c.contentPanel : null } a.fn.dialog.extensions = {}; var m = a.util.$.easyui ? a.util.$.easyui : a.easyui, g = m.frameMapCache ? m.frameMapCache : m.frameMapCache = []; a.easyui.parent = function () { var c = a.util.currentFrame; if (!c) return a.util.top; var e = a.array.first(g, function (a) { return a.current == c }); return e && e.parent && e.parent.contentWindow ? e.parent.contentWindow : a.util.parent }(); a.easyui.parent.closeDialog = a.easyui.closeCurrentDialog = function () { a.util.isUtilTop || a.easyui.parent.$(a.util.currentFrame).closest("div.window-body").dialog("close") }; a.easyui._showDialog = function (c, e) { if (null == c.onApply || c.onApply == u) c.onApply = c.onSave; if (null == c.onSave || c.onSave == u) c.onSave = c.onApply; var m = c.onClose; c.onClose = function () { a.isFunction(m) && m.apply(this, arguments); a.fn.dialog.defaults.onClose.apply(this, arguments); c.autoDestroy && a(this).dialog("destroy") }; var r = c.onBeforeDestroy; c.onBeforeDestroy = function () { if (c.iniframe) { var e = a(this).dialog("iframe"); w(e[0]) } var f; a.isFunction(r) && (f = r.apply(this, arguments)); return 0 == a.fn.dialog.defaults.onBeforeDestroy.apply(this, arguments) ? !1 : f }; c.locale && (c.inline = !0); var y = a("\x3cdiv\x3e\x3c/div\x3e").appendTo(c.locale ? c.locale : "body"); a.util.likeArray(c.toolbar) || (c.toolbar = []); a.isArray(c.toolbar) && (a.each(c.toolbar, function () { var c = this.handler; a.isFunction(c) && (this.handler = function () { c.call(y, y) }) }), c.toolbar.length || (c.toolbar = null)); var A = [btnSave = { id: "save", text: c.saveButtonText, iconCls: c.saveButtonIconCls, index: c.saveButtonIndex, hidden: c.enableSaveButton ? !1 : !0, handler: function (e) { var f = a.isFunction(c.onSave); (!f || f && !1 !== c.onSave.call(this, e)) && a.util.exec(function () { e.dialog("close") }) } }, btnClose = { id: "close", text: c.closeButtonText, iconCls: c.closeButtonIconCls, index: c.closeButtonIndex, hidden: c.enableCloseButton ? !1 : !0, handler: function (a) { a.dialog("close") } }, btnApply = { id: "apply", text: c.applyButtonText, iconCls: c.applyButtonIconCls, index: c.applyButtonIndex, hidden: c.enableApplyButton ? !1 : !0, handler: function (e) { var f = a.isFunction(c.onApply); (!f || f && !1 !== c.onApply.call(this, e)) && e.applyButton.linkbutton("disable") } }]; a.util.likeArrayNotString(c.buttons) || (c.buttons = []); a.array.merge(c.buttons, A); c.buttons = a.array.filter(c.buttons, function (c) { return a.util.parseFunction(c.hidden, c) ? !1 : !0 }); a.each(c.buttons, function (c, d) { var e = d.handler; a.isFunction(e) && (d.handler = function () { e.call(this, y) }) }); a.array.sort(c.buttons, function (c, d) { return (a.isNumeric(c.index) ? c.index : 0) - (a.isNumeric(d.index) ? d.index : 0) }); c.buttons.length || (c.buttons = null); c = y.dialog(c).dialog("options"); var A = y.dialog("body").children(".dialog-button").each(function () { var c = y.css("border-bottom-color"); a(this).addClass("calendar-header").css({ height: "auto", "border-top-color": c }) }), G = A.children("a"); c.buttonsPlain && G.linkbutton("setPlain", !0); if (!c.iniframe && c.href) { var I = y.dialog("header").find(".panel-tool a"); I.attr("disabled", "disabled"); G.linkbutton("disable"); var C = c.onLoad; c.onLoad = function () { a.isFunction(C) && C.apply(this, arguments); a.util.exec(function () { I.removeAttr("disabled"); G.linkbutton("enable") }) } } var M = y.dialog("iframe"); M.length && g.push({ current: M[0], parent: e }); a.extend(y, { options: c, iframe: M, buttons: G, closeButtn: A.children("#close"), saveButton: A.children("#save"), applyButton: A.children("#apply"), save: function () { btnSave.handler() }, close: function () { btnClose.handler() }, apply: function () { btnApply.handler() } }); return y }; a.easyui.showDialog = function (c) { c = a.extend({}, a.easyui.showDialog.defaults, c); c.locale && (c.topMost = !1); return (c.topMost ? a.util.$.easyui._showDialog : a.easyui._showDialog)(c, a.util.currentFrame) }; a.easyui.showOption = function (c, e) { c = c || "\u65e0\u6570\u636e\u663e\u793a\u3002"; var g = a.extend({ topMost: a.easyui.showDialog.defaults.topMost, title: "\u663e\u793a options \u503c", width: 480, height: 260, minWidth: 360, minHeight: 220, autoVCenter: !1, autoHCenter: !1, enableSaveButton: !1, enableApplyButton: !1 }, e || {}), m = g.topMost ? a.util.$ : a, r = m('\x3ctable class\x3d"dialog-options-body" \x3e\x3c/table\x3e'), m = m.type(c); if (a.array.contains(["array", "object", "function"], m)) for (var u in c) r.append('\x3ctr class\x3d"dialog-options-row"\x3e\x3ctd class\x3d"dialog-options-cell"\x3e' + u + ':\x3c/td\x3e\x3ctd class\x3d"dialog-options-cell-content"\x3e' + a.string.toHtmlEncode(c[u]) + "\x3c/td\x3e\x3c/tr\x3e"); else r.append('\x3ctr class\x3d"dialog-options-row"\x3e\x3ctd class\x3d"dialog-options-cell"\x3eoptions:\x3c/td\x3e\x3ctd class\x3d"dialog-options-cell-content"\x3e' + a.string.toHtmlEncode(String(c)) + "\x3c/td\x3e\x3c/tr\x3e"); g.content = r; return a.easyui.showDialog(g) }; var c = a.fn.dialog; a.fn.dialog = function (d, e) { if ("string" == typeof d) return c.apply(this, arguments); d = d || {}; return this.each(function () { var e = a(this), f = a.data(this, "dialog") ? d : a.extend({}, a.fn.dialog.parseOptions(this), d); f._extensionsDialog = { href: f.href, content: f.content, iniframe: f.iniframe, bodyCls: f.bodyCls, bodyStyle: f.bodyStyle }; f.bodyCls = null; f.bodyStyle = null; f.iniframe && (f.href = null, f.content = null, f.iniframe = !1); c.call(e, f); var e = a(this).dialog("options"), f = r(this), g = e._extensionsDialog ? e._extensionsDialog : e._extensionsDialog = { href: e.href, content: e.content, iniframe: e.iniframe }; e.href = g.href; e.content = g.content; e.iniframe = g.iniframe; e.bodyCls = g.bodyCls; e.bodyStyle = g.bodyStyle; f && f.length && (e.bodyCls && f.addClass(e.bodyCls), e.bodyStyle && f.css(e.bodyStyle)); e.iniframe && A(this) }) }; a.union(a.fn.dialog, c); var m = a.fn.dialog.extensions.methods = { options: function (c) { var e = a.data(c[0], "dialog").options; c = c.panel("options"); a.extend(e, { closed: c.closed, collapsed: c.collapsed, minimized: c.minimized, maximized: c.maximized, width: c.width, height: c.height }); return e }, contentPanel: function (a) { return r(a[0]) }, iframe: function (a) { return r(a[0]).panel("iframe") }, refresh: function (a, c) { return a.each(function () { A(this, c) }) } }, e = a.fn.dialog.extensions.defaults = a.extend({}, a.fn.window.extensions.defaults, {}); a.extend(a.fn.dialog.defaults, e); a.extend(a.fn.dialog.methods, m); a.easyui.showDialog.defaults = { title: "\u65b0\u5efa\u5bf9\u8bdd\u6846", iconCls: "icon-standard-application-form", width: 600, height: 360, modal: !0, collapsible: !1, maximizable: !1, closable: !0, draggable: !0, resizable: !0, shadow: !0, minimizable: !1, href: null, autoDestroy: !0, locale: null, topMost: !1, iniframe: !1, enableSaveButton: !0, enableApplyButton: !0, enableCloseButton: !0, saveButtonIndex: 101, closeButtonIndex: 102, applyButtonIndex: 103, onSave: null, onApply: null, onClose: null, saveButtonText: "\u786e\u5b9a", closeButtonText: "\u53d6\u6d88", applyButtonText: "\u5e94\u7528", saveButtonIconCls: "icon-save", applyButtonIconCls: "icon-ok", closeButtonIconCls: "icon-cancel", buttonsPlain: !1 } })(jQuery); (function (a, u) { function w(c, d) { var f = a(c); return a.array.reduce(null == d || d == u || d ? ["north", "west", "east", "center", "south"] : ["north", "west", "east", "south"], function (a, c, d) { (d = f.layout("panel", c)) && d.length && (a.push({ region: c, panel: d }), a[c] = d); return a }, []) } function A(c) { var d = a(c); c = d.layout("panels", !1); a.each(c, function (a, c) { c.panel.panel("options").collapsed || d.layout("collapse", c.region) }); a.util.exec(function () { d.layout("resize") }, a.fn.layout.extensions.resizeDelay) } function r(c) { var d = a(c); c = d.layout("panels", !1); a.each(c, function (a, c) { c.panel.panel("options").collapsed && d.layout("expand", c.region) }); a.util.exec(function () { d.layout("resize") }, a.fn.layout.extensions.resizeDelay) } function m(c, d) { function f() { a.each(m, function (a, c) { g.layout("toggle", c) }); a.util.exec(function () { g.layout("resize") }, a.fn.layout.extensions.resizeDelay) } a.array.contains(["collapse", "expand", "toggle"], d) || (d = "toggle"); var g = a(c), m = ["north", "west", "east", "south"], r = a.array.some(m, function (a) { return (a = g.layout("panel", a)) && a.length ? a.panel("options").collapsed ? !0 : !1 : !1 }), u = a.array.some(m, function (a) { return (a = g.layout("panel", a)) && a.length ? a.panel("options").collapsed ? !1 : !0 : !1 }); switch (d) { case "collapse": g.layout(u ? "collapseAll" : "expandAll"); break; case "expand": g.layout(r ? "expandAll" : "collapseAll"); break; case "toggle": f(); break; default: f() } } a.fn.layout.extensions = { resizeDelay: 500 }; var g = a.fn.layout.extensions.defaults = {}, c = a.fn.layout.extensions.methods = { panels: function (a, c) { return w(a[0], c) }, collapseAll: function (a) { return a.each(function () { A(this) }) }, expandAll: function (a) { return a.each(function () { r(this) }) }, toggle: function (c, d) { return c.each(function () { if (a.array.contains(["north", "west", "east", "center", "south"], d)) { var c = a(this), e = c.layout("panel", d); e && e.length && (e.panel("options").collapsed ? c.layout("expand", d) : c.layout("collapse", d)) } }) }, toggleAll: function (a, c) { return a.each(function () { m(this, c) }) } }; a.extend(a.fn.layout.defaults, g); a.extend(a.fn.layout.methods, c) })(jQuery); (function (a, u) { function w(c, E, N) { N = N || (E._extensionsDatagrid ? E._extensionsDatagrid : E._extensionsDatagrid = {}); da(c, N); var f = c.datagrid("getData"); f != N.oldData && (N.filterData = []); A(c, E); d(c, E); if (E.columnFilter) { N.oldData = f; var f = c.datagrid("getPanel").find("div.datagrid-view div.datagrid-header"), S = f.find("table.datagrid-htable tr.datagrid-header-row").find("td[field]").filter(function () { var c = a(this), h = c.attr("colspan"); return h && "1" != h || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 }), l = E.columnFilter = a.extend({ panelHeight: 100, position: "top" }, E.columnFilter), h = a.array.contains(["top", "bottom"], l.position) ? l.position : "top"; l.panelHeight = a.isNumeric(l.panelHeight) && 60 <= l.panelHeight ? l.panelHeight : 60; f.height(); var q = c.datagrid("getRows"); S.each(function () { var d = a(this).addClass("datagrid-header-filter").removeClass("datagrid-header-filter-top datagrid-header-filter-bottom"); d.find("div.datagrid-cell").addClass("datagrid-header-filter-cell"); var e = d.attr("field"), f = c.datagrid("getColumnOption", e), Q = f.width; a("\x3chr /\x3e").addClass("datagrid-header-filter-line")["top" == h ? "prependTo" : "appendTo"](this); Q = a("\x3cdiv\x3e\x3c/div\x3e").attr("field", e).addClass("datagrid-header-filter-container").css({ height: l.panelHeight, width: Q })["top" == h ? "prependTo" : "appendTo"](this); d.addClass("top" == h ? "datagrid-header-filter-top" : "datagrid-header-filter-bottom"); if (e && (d = N, f.filterable)) { var e = f.field, k = c.datagrid("getDistinctColumnData", e), p = a.array.contains(["checkbox", "livebox", "caps", "lower", "none"], f.filter) ? f.filter : "checkbox", n = f.precision, f = f.step; switch (p) { case "checkbox": r(c, d, Q, e, q, k); break; case "livebox": m(c, Q, e, q); break; case "caps": g(c, Q, e, f, n, q, k, "\x3c\x3d", E.columnFilter.panelHeight, S); break; case "lower": g(c, Q, e, f, n, q, k, "\x3e\x3d", E.columnFilter.panelHeight, S) } } }); N.filterData && N.filterData.length ? c.datagrid("hideRows", N.filterData) : e(c, E, N, q, S) } } function A(c, d) { if (d.columnFilter) { var e = c.datagrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function () { var c = a(this), d = c.attr("colspan"); return d && "1" != d || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 }); e.removeClass("datagrid-header-filter datagrid-header-filter-top datagrid-header-filter-bottom").find("div.datagrid-cell").removeClass("datagrid-header-filter-cell"); e.find("hr.datagrid-header-filter-line,div.datagrid-header-filter-container").remove(); e = c.datagrid("getColumnFields", "all"); c.datagrid("fixColumnSize", e[e.length - 1]) } } function r(c, d, e, f, g, l) { a.each(l, function (h, l) { var x = a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-item").attr("text", l).appendTo(e); a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-item-text").text(l).appendTo(x); a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-item-icon").appendTo(x); x.click(function () { var h = a.array.filter(g, function (a) { return a[f] == l }), e = a.array.filter(d.filterData, function (a) { return a[f] == l }); c.datagrid(e.length ? "showRows" : "hideRows", h) }) }) } function m(c, d, e, f) { a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-livebox-text").text("\u6a21\u7cca\u8fc7\u6ee4\uff1a").appendTo(d); var g = a("\x3cinput /\x3e").addClass("datagrid-header-filter-livebox").appendTo(d), l = a("\x3ca /\x3e").linkbutton({ plain: !0, iconCls: "icon-search" }).appendTo(d).click(function () { c.datagrid("showRows", !0); var h = g.val(); if (!a.string.isNullOrEmpty(h)) { var l = a.array.filter(f, function (a) { return -1 == String(a[e]).indexOf(h) }); c.datagrid("hideRows", l) } g.focus() }); a("\x3ca /\x3e").linkbutton({ plain: !0, iconCls: "icon-undo" }).appendTo(d).click(function () { g.val() ? (g.val("").focus(), l.click()) : g.focus() }); g.keypress(function (a) { 13 == a.which && l.click() }) } function g(d, E, e, f, g, l, h, q, x, B) { var K = a.array.map(h, function (c) { c = parseFloat(c); return a.isNumeric(c) ? c : 0 }); h = K.length ? a.array.min(K) : 0; var T = K.length ? a.array.max(K) : 0, k = K.length ? a.array.max(K, function (c, h) { return a.util.compare(a.number.precision(c), a.number.precision(h)) }) : 0, p = K.length ? a.number.precision(k) : 0; x -= 45; K = a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-itemwrap").text(q).appendTo(E); E = a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-sliderwrap").css({ height: x + 10 })["\x3c\x3d" == q ? "appendTo" : "prependTo"](E); var n = a("\x3cinput /\x3e").addClass("datagrid-header-filter-numeric").appendTo(K), t = a("\x3cinput /\x3e").addClass("datagrid-header-filter-slider").appendTo(E); E = function (a, h) { c(d, e, l, a, q, n, t, B) }; n.numberbox({ value: "\x3c\x3d" == q ? T : h, min: h, max: T, precision: g, onChange: E, height: 18 }); n.keypress(function (c) { 13 == c.which && (c = n.val(), n.numberbox("setValue", a.isNumeric(c) ? c : 0)) }); t.slider({ height: x, mode: "v", showTip: !0, value: "\x3c\x3d" == q ? T : h, min: h, max: T, rule: [h, "|", T], step: f, onComplete: E, tipFormatter: function (c) { return a.number.round(c || 0, p) } }) } function c(c, d, e, f, g, l, h, q) { q = (q || c.datagrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function () { var c = a(this), h = c.attr("colspan"); return h && "1" != h || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 })).filter(function () { return a(this).attr("field") == d }); l = l ? l : q.find(".datagrid-header-filter-numeric"); h = h ? h : q.find(".datagrid-header-filter-slider"); e = a.array.filter(e, function (c) { c = parseFloat(c[d]); c = a.isNumeric(c) ? c : 0; return "\x3e\x3d" == g ? c < f : c > f }); c.datagrid("showRows", !0).datagrid("hideRows", e); l.numberbox("setValue", f); h.slider("setValue", f) } function e(c, E, e, g, S) { d(c, E); E.columnFilter && (S = S || c.datagrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function () { var c = a(this), h = c.attr("colspan"); return h && "1" != h || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 }), S.each(function () { var l = a(this), h = l.attr("field"), q = q = c.datagrid("getColumnOption", h); switch (a.array.contains(["checkbox", "livebox", "caps", "lower", "none"], q.filter) ? q.filter : "checkbox") { case "checkbox": f(c, e, g, l, h) } })) } function d(a, c) { if (c.pagination) { var d = a.datagrid("getPager"); if (d && d.length) { var e = a.datagrid("getVisibleRows").length, f = a.datagrid("getRows").length, l = e < f ? !0 : !1, h = d.find("div.pagination-visiblerows"); if (0 == c.showFilterText || (null == c.showFilterText || c.showFilterText == u) && !l) return h.remove(); h.length ? h.html("\u5f53\u524d\u9875\u663e\u793a" + e + "/" + f + "\u884c") : d.find("div.pagination-info").before('\x3cdiv class\x3d"pagination-visiblerows"\x3e\u5f53\u524d\u9875\u663e\u793a' + e + "/" + f + "\u884c\x3c/div\x3e") } } } function f(c, d, e, f, g) { f.find("div.datagrid-header-filter-item").each(function () { var c = a(this), h = c.attr("text"), q = c.find("div.datagrid-header-filter-item-icon"), x = a.array.sum(e, function (a) { return a[g] == h ? 1 : 0 }), W = a.array.sum(d.filterData, function (a) { return a[g] == h ? 1 : 0 }), W = 0 == W ? "tree-checkbox1" : W >= x ? "tree-checkbox0" : "tree-checkbox2"; a.easyui.tooltip.init(c, { content: (a.string.isNullOrEmpty(h) ? "\u7a7a\u767d" : h) + ": \u5171" + x + "\u4e2a\u5143\u7d20" }); H(q, W) }) } function H(a, c) { a.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2").addClass(c) } function D(c, d, e) { e.onHeaderContextMenuBak = d.onHeaderContextMenu; d.onHeaderContextMenu = function (f, g) { a.isFunction(e.onHeaderContextMenuBak) && e.onHeaderContextMenuBak.apply(this, arguments); if (d.enableHeaderContextMenu) { var l = a.fn.datagrid.extensions.parseContextMenuEventData(c, d, f), l = z(c, d, e, f, g, l); a.easyui.showMenu({ items: l, left: f.pageX, top: f.pageY, hideDisabledMenu: d.hideDisabledMenu }); f.preventDefault() } } } function y(c, d, e) { e.onRowContextMenuBak = d.onRowContextMenu; d.onRowContextMenu = function (f, g, l) { a.isFunction(e.onRowContextMenuBak) && e.onRowContextMenuBak.apply(this, arguments); d.selectOnRowContextMenu && c.datagrid("selectRow", g); if (d.enableRowContextMenu) { var h = a.fn.datagrid.extensions.parseContextMenuEventData(c, d, f), h = n(c, d, e, f, g, l, h); d.autoBindDblClickRow && 0 <= d.dblClickRowMenuIndex && a.util.likeArray(d.rowContextMenu) && !a.util.isString(d.rowContextMenu) && d.rowContextMenu.length > d.dblClickRowMenuIndex && (h[d.dblClickRowMenuIndex].bold = !0); a.easyui.showMenu({ items: h, left: f.pageX, top: f.pageY, hideDisabledMenu: d.hideDisabledMenu }); f.preventDefault() } } } function F(c, d, e) { d.enableHeaderClickMenu && c.datagrid("getPanel").find(".datagrid-view .datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function () { var c = a(this), d = c.attr("colspan"); return d && "1" != d || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 }).find("div.datagrid-cell").each(function () { G(c, d, e, this) }) } function G(c, d, e, f) { var g = a("\x3cspan class\x3d's-btn-downarrow datagrid-header-cell-arrow'\x3e\x26nbsp;\x3c/span\x3e").click(function (l) { var h = a(this), q = h.offset(), x = h.outerHeight(), h = h.parent().parent().attr("field"), f = a.fn.datagrid.extensions.parseContextMenuEventData(c, d, l); l = z(c, d, e, l, h, f); var q = a.easyui.showMenu({ items: l, left: q.left, top: q.top + x }).menu("options"), Q = q.onHide; g.hidable = !1; q.onHide = function () { g.hidable = !0; g.removeClass("datagrid-header-cell-arrow-show"); Q.apply(this, arguments) }; return !1 }).prependTo(f); a(f).off(".hoverArrow").on({ "mouseenter.hoverArrow": function () { g.addClass("datagrid-header-cell-arrow-show") }, "mouseleave.hoverArrow": function () { a.util.isBoolean(g.hidable) && !g.hidable || g.removeClass("datagrid-header-cell-arrow-show") } }) } function I(c, d, e) { e.onDblClickRowBak = d.onDblClickRow; d.onDblClickRow = function (f, g) { a.isFunction(e.onDblClickRowBak) && e.onDblClickRowBak.apply(this, arguments); var l = a.fn.datagrid.extensions.parseContextMenuEventData(c, d, null); items = n(c, d, e, null, f, g, l); if (d.autoBindDblClickRow && 0 <= d.dblClickRowMenuIndex && a.util.likeArray(d.rowContextMenu) && !a.util.isString(d.rowContextMenu) && d.rowContextMenu.length > d.dblClickRowMenuIndex) { var h = items[d.dblClickRowMenuIndex], q = h.handler || h.onclick; if (!h.disabled) return q(null, f, g, l, c, h, null) } } } function C(c, d, e) { e[d.autoEditingEvent] = d[d.autoEditingEvent]; d[d.autoEditingEvent] = function (f, g) { a.isFunction(e[d.autoEditingEvent]) && e[d.autoEditingEvent].apply(this, arguments); d.autoEditing && c.datagrid("beginEdit", f) } } function M(c, d, e) { a(d.finishEditLocale).click(function (e) { if (d.finishEditOnBlur && a.data(c[0], "datagrid")) { var N = c.datagrid("getPanel"), l = c.datagrid("getEditingRowIndexs"); a.contains(N[0], e.target) || a.each(l, function (a, l) { c.datagrid(d.finishEditMethod, l) }) } }) } function z(c, d, e, f, g, l) { var h = [], q = a.util.likeArray(d.headerContextMenu) && !a.util.isString(d.headerContextMenu) ? d.headerContextMenu : []; q.length && a.array.merge(h, q); d = v(c, d, e, f, g, l); d.length && a.array.merge(h, "-", d); h = a.fn.datagrid.extensions.parseHeaderContextMenuMap(f, g, l, h, c); "-" == h[0] && a.array.removeAt(h, 0); return h } function n(c, d, e, f, g, l, h) { var q = [], x = a.util.likeArray(d.rowContextMenu) && !a.util.isString(d.rowContextMenu) ? d.rowContextMenu : []; x.length && a.array.merge(q, x); d = t(c, d, e, f, g, l, h); d.length && a.array.merge(q, "-", d); q = a.fn.datagrid.extensions.parseRowContextMenuMap(f, g, l, h, q, c); "-" == q[0] && a.array.removeAt(q, 0); return q } function v(c, d, e, f, g, l) { var h = [], q = d.exportMenu, x = c.datagrid("getColumnOption", g), B = x.sortable; "object" == typeof q && (q = a.extend({ current: !1, all: !1, submenu: !0 }, q)); var K = { text: "\u5347\u5e8f", iconCls: "icon-standard-hmenu-asc", disabled: 1 != B, handler: function () { return c.datagrid("sort", { sortName: g, sortOrder: "asc" }) } }, B = { text: "\u964d\u5e8f", iconCls: "icon-standard-hmenu-desc", disabled: 1 != B, handler: function () { return c.datagrid("sort", { sortName: g, sortOrder: "desc" }) } }, T = { text: "\u663e\u793a/\u9690\u85cf\u5217", iconCls: "icon-standard-application-view-columns", disabled: !1, children: [{ text: "\u663e\u793a\u5168\u90e8\u5217", iconCls: function () { var c = e.fields ? e.fields.length : 0, h = a.array.sum(e.fieldOptions, function (a) { return a.hidden ? 0 : 1 }); return h >= c ? "tree-checkbox1" : 0 == h ? "tree-checkbox0" : "tree-checkbox2" }, hideOnClick: !1, handler: function (c, h, d, l, q, E) { a.each(e.fields, function () { l.datagrid("showColumn", this) }); a(this).parent().children("div.menu-item:not(:eq(1))").each(function () { E.menu("setIcon", { target: this, iconCls: "tree-checkbox1" }); E.menu("enableItem", this) }) } }, { text: "\u8fd8\u539f\u9ed8\u8ba4", iconCls: "icon-standard-application-view-tile", hideOnClick: !1, handler: function (c, h, d, l, q, E) { a.each(e.fieldOptionsBackup, function () { l.datagrid(1 == this.hidden ? "hideColumn" : "showColumn", this.field) }); c = a(this).parent(); c.children("div.menu-item:gt(1)").each(function () { var c = a(this).text(), h = a.array.first(e.fieldOptions, function (a) { return a.title == c }); h && E.menu("setIcon", { target: this, iconCls: h.hidden ? "tree-checkbox0" : "tree-checkbox1" }); E.menu("enableItem", this) }); c.children("div.menu-item:first").each(function () { var c = e.fields ? e.fields.length : 0, h = a.array.sum(e.fieldOptions, function (a) { return a.hidden ? 0 : 1 }); E.menu("setIcon", { target: this, iconCls: h >= c ? "tree-checkbox1" : 0 == h ? "tree-checkbox0" : "tree-checkbox2" }) }) } }, "-"] }, n = { text: "\u8fc7\u6ee4/\u663e\u793a", iconCls: "icon-standard-application-view-list", disabled: !x.filterable, children: [] }, t = { text: "\u5bfc\u51fa\u5f53\u524d\u9875", iconCls: "icon-standard-page-white-put", disabled: !(1 == q || 1 == q.current), handler: function () { return c.datagrid("exportExcel", !1) } }, m = { text: "\u5bfc\u51fa\u5168\u90e8", iconCls: "icon-standard-page-white-stack", disabled: !(1 == q || 1 == q.all), handler: function () { return c.datagrid("exportExcel", !0) } }; a.util.merge(T.children, k(c, d, e, f, g, l)); x.filterable && a.util.merge(n.children, p(c, d, e, f, g, l)); a.util.merge(h, [K, B, "-", T, n]); d = [t, m]; q && a.array.merge(h, "-", "object" != typeof q || q.submenu ? { text: "\u5bfc\u51fa\u6570\u636e", iconCls: "icon-standard-page-save", children: d } : d); return h } function k(c, d, e, f, g, l) { return a.array.map(e.fieldOptions, function (c) { return { text: c.title || c.field, iconCls: c.hidden ? "tree-checkbox0" : "tree-checkbox1", hideOnClick: !1, disabled: c.hidable ? !1 : !0, handler: function (d, l, E, f, W, g) { d = a(this); l = d.parent().find(".menu-item:gt(1) .tree-checkbox1").length; if ((1 != l || c.hidden) && c.hidable) { f.datagrid(c.hidden ? "showColumn" : "hideColumn", c.field); g.menu("setIcon", { target: this, iconCls: c.hidden ? "tree-checkbox0" : "tree-checkbox1" }); l = a.array.sum(e.fieldOptions, function (a) { return a.hidden ? 0 : 1 }); f = e.fields ? e.fields.length : 0; g.menu("setIcon", { target: d.parent().children("div.menu-item:first"), iconCls: l >= f ? "tree-checkbox1" : 0 == l ? "tree-checkbox0" : "tree-checkbox2" }); var Q = d.parent().find(".menu-item:gt(1)").filter(function () { return a(".tree-checkbox1", this).length ? !0 : !1 }); Q.each(function () { g.menu(1 < Q.length ? "enableItem" : "disableItem", this) }) } } } }) } function p(c, d, e, f, g, l) { var h = c.datagrid("getRows"), q = c.datagrid("getDistinctColumnData", g); d = [{ text: "\u5168\u90e8", hideOnClick: !1, iconCls: e.filterData && e.filterData.length ? e.filterData.length >= h.length ? "tree-checkbox0" : "tree-checkbox2" : "tree-checkbox1", handler: function (c, h, d, l, q, E) { e.filterData && e.filterData.length ? l.datagrid("showRows", !0) : l.datagrid("hideRows", !0); a(this).parent().children("div.menu-item[hideOnClick\x3dfalse]").each(function () { E.menu("setIcon", { target: this, iconCls: e.filterData && e.filterData.length ? "tree-checkbox0" : "tree-checkbox1" }) }) } }, "-"]; var x = (l = 15 <= q.length) ? a.array.left(q, 10) : q, x = a.array.map(x, function (c) { var d = a.array.filter(h, function (a) { return a[g] == c }), l = d.length, q = a.array.sum(e.filterData, function (a) { return a[g] == c ? 1 : 0 }); return { text: c, iconCls: q ? q >= l ? "tree-checkbox0" : "tree-checkbox2" : "tree-checkbox1", hideOnClick: !1, handler: function (l, q, E, x, f, g) { l = a.array.sum(e.filterData, function (a) { return a[q] == c ? 1 : 0 }); x.datagrid(l ? "showRows" : "hideRows", d); g.menu("setIcon", { target: this, iconCls: l ? "tree-checkbox1" : "tree-checkbox0" }); a(this).parent().children("div.menu-item:first").each(function () { g.menu("setIcon", { target: this, iconCls: e.filterData && e.filterData.length ? e.filterData.length >= h.length ? "tree-checkbox0" : "tree-checkbox2" : "tree-checkbox1" }) }) } } }); a.array.merge(d, x); if (l) { l = c.datagrid("getColumnOption", g); var B = l.title ? l.title : l.field; a.array.merge(d, ["-", { text: "\u5904\u7406\u66f4\u591a(\u5171" + q.length + "\u9879)...", iconCls: "icon-standard-application-view-detail", handler: function () { var d = a('\x3cinput type\x3d"button" value\x3d"\u5168\u90e8\u9009\u62e9" /\x3e').click(function () { c.datagrid("showRows", !0); a(this).parent().find(":checkbox").each(function () { this.checked = !0 }) }), l = a('\x3cinput type\x3d"button" value\x3d"\u5168\u90e8\u4e0d\u9009" /\x3e').click(function () { c.datagrid("hideRows", !0); a(this).parent().find(":checkbox").each(function () { this.checked = !1 }) }); a("\x3cdiv\x3e\x3c/div\x3e").append("\x3cdiv\x3e\u5217\uff1a" + B + "\uff0c\u5171" + q.length + "\u9879\x3c/div\x3e\x3chr /\x3e").css({ padding: "10px" }).append(d).append(l).append("\x3chr /\x3e").each(function () { var d = a(this), l = a("\x3cul\x3e\x3c/ul\x3e").css({ "list-style-type": "decimal", "padding-left": "40px", "line-height": "18px" }).appendTo(d); a.each(q, function (d, q) { var E = "itemCheckbox_" + a.util.guid("N"), x = !a.array.some(e.filterData, function (a) { return a[g] == q }), f = a("\x3cli\x3e\x3c/li\x3e").appendTo(l), x = a("\x3cinput /\x3e").attr({ type: "checkbox", id: E, checked: x }).appendTo(f); a("\x3clabel\x3e\x3c/label\x3e").attr("for", E).text(q).appendTo(f); x.click(function () { var d = a.array.filter(h, function (a) { return a[g] == q }), l = a.array.sum(e.filterData, function (a) { return a[g] == q ? 1 : 0 }); c.datagrid(l ? "showRows" : "hideRows", d) }) }) }).dialog({ title: "\u8fc7\u6ee4/\u663e\u793a", iconCls: "icon-standard-application-view-detail", height: 260, width: 220, left: f.pageX, top: f.pageY, collapsible: !1, minimizable: !1, maximizable: !1, closable: !0, modal: !0, resizable: !0, onClose: function () { a(this).dialog("destroy") } }).dialog("open") } }]) } return d } function t(c, d, e, f, g, l, h) { e = []; f = d.pagingMenu; l = d.moveMenu; var q = d.exportMenu; "object" == typeof f && (f = a.extend({ disabled: !1, submenu: !0 }, f)); "object" == typeof l && (l = a.extend({ up: !1, down: !1, submenu: !0 }, l)); "object" == typeof q && (q = a.extend({ current: !1, all: !1, submenu: !0 }, q)); var x = { text: "\u79fb\u81f3\u6700\u4e0a", iconCls: "icon-standard-arrow-up", disabled: !(1 == l || 1 == l.top), handler: function () { c.datagrid("moveRow", { source: g, target: 0, point: "top" }) } }, B = { text: "\u4e0a\u79fb", iconCls: "icon-standard-up", disabled: !(1 == l || 1 == l.up), handler: function () { c.datagrid("shiftRow", { point: "up", index: g }) } }, K = { text: "\u4e0b\u79fb", iconCls: "icon-standard-down", disabled: !(1 == l || 1 == l.down), handler: function () { c.datagrid("shiftRow", { point: "down", index: g }) } }, T = { text: "\u79fb\u81f3\u6700\u4e0b", iconCls: "icon-standard-arrow-down", disabled: !(1 == l || 1 == l.bottom), handler: function () { var a = c.datagrid("getRows"); c.datagrid("moveRow", { source: g, target: a.length - 1, point: "bottom" }) } }, k = { text: "\u5bfc\u51fa\u5f53\u524d\u9875", iconCls: "icon-standard-page-white-put", disabled: !(1 == q || 1 == q.current), handler: function () { return c.datagrid("exportExcel", !1) } }, p = { text: "\u5bfc\u51fa\u5168\u90e8", iconCls: "icon-standard-page-white-stack", disabled: !(1 == q || 1 == q.all), handler: function () { return c.datagrid("exportExcel", !0) } }; e.push({ text: "\u5237\u65b0\u5f53\u524d\u9875", iconCls: "pagination-load", disabled: !d.refreshMenu, handler: function () { c.datagrid("reload") } }); var n = [{ text: "\u9996\u9875", iconCls: "pagination-first", disabled: function () { return !d.pagination || 1 >= h.page }, handler: function () { 1 < h.page && h.pager.pagination("select", 1) } }, { text: "\u4e0a\u4e00\u9875", iconCls: "pagination-prev", disabled: function () { return !d.pagination || 1 >= h.page }, handler: function () { 1 < h.page && h.pager.pagination("select", h.page - 1) } }, { text: "\u4e0b\u4e00\u9875", iconCls: "pagination-next", disabled: function () { return !d.pagination || h.page >= h.pageCount }, handler: function () { h.page < h.pageCount && h.pager.pagination("select", h.page + 1) } }, { text: "\u672b\u9875", iconCls: "pagination-last", disabled: function () { return !d.pagination || h.page >= h.pageCount }, handler: function () { h.page < h.pageCount && h.pager.pagination("select", h.pageCount) } }], x = [x, B, "-", K, T], k = [k, p]; f && a.array.merge(e, "-", "object" != typeof f || f.submenu ? { text: "\u7ffb\u9875", iconCls: "", disabled: !(1 == f || !f.disabled), children: n } : n); l && a.array.merge(e, "-", "object" != typeof l || l.submenu ? { text: "\u4e0a/\u4e0b\u79fb\u52a8", iconCls: "", disabled: !l, children: x } : x); q && a.array.merge(e, "-", "object" != typeof q || q.submenu ? { text: "\u5bfc\u51fa\u6570\u636e", iconCls: "icon-standard-page-save", disabled: !q, children: k } : k); return e } a.fn.datagrid.extensions = {}; var J = a.fn.datagrid.methods.updateRow, L = a.fn.datagrid.methods.appendRow, ca = a.fn.datagrid.methods.insertRow, Ha = a.fn.datagrid.methods.beginEdit, la = function (c, d) { var e = a(c), f = e.datagrid("options"), g = Ha.call(e, e, d); if (f.autoFocusField && (e = e.datagrid("getEditors", d), e.length)) { var l = a.array.first(e, function (a) { return a.field == f.autoFocusField }); l || (l = e[0]); l && a.util.exec(function () { l.actions && a.isFunction(l.actions.setFocus) ? l.actions.setFocus(l.target[0]) : l.target.focus() }) } return g }, Ia = function (c, d) { var e = a(c), f = e.datagrid("getChecked"), f = a.array.map(f, function (a) { return e.datagrid("getRowIndex", a) }); return a.array.contains(f, d) }, Ja = function (c, d) { var e = a(c), f = e.datagrid("getSelections"), f = a.array.map(f, function (a) { return e.datagrid("getRowIndex", a) }); return a.array.contains(f, d) }, ma = function (c) { c = a(c).datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row.datagrid-row-editing").map(function () { return window.parseInt(a(this).attr("datagrid-row-index")) }); return a.array.distinct(a.array.clone(c)) }, na = function (c) { function d(a, c) { a.draggable("proxy").find("span.tree-dnd-icon").removeClass("tree-dnd-yes tree-dnd-no").addClass(c ? "tree-dnd-yes" : "tree-dnd-no") } var e = a(c), f = e.datagrid("options"); e.datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable({ disabled: !1, revert: !0, cursor: "default", deltaX: 10, deltaY: 5, proxy: function (c) { c = a(c); c = parseInt(c.attr("datagrid-row-index")); c = e.datagrid("getRowDom", c).clone(); var d = a("\x3ctr\x3e\x3c/tr\x3e").addClass("datagrid-row datagrid-row-selected"); a("\x3ctd\x3e\x3cspan class\x3d'tree-dnd-icon tree-dnd-no' \x3e\x3c/span\x3e\x3c/td\x3e").appendTo(d); 6 < c.find("td").each(function (a) { 6 > a && d.append(this) }).length && a("\x3ctd\x3e...\x3c/td\x3e").css("width", "40px").appendTo(d); return a("\x3ctable\x3e\x3c/table\x3e").addClass("tree-node-proxy").appendTo("body").append(d).hide() }, onBeforeDrag: function (d) { var l = a(this), l = parseInt(l.attr("datagrid-row-index")), h = e.datagrid("getRowData", l); if (a.isFunction(f.onBeforeDrag) && 0 == f.onBeforeDrag.call(c, l, h) || 1 != d.which || "checkbox" == d.target.type) return !1 }, onStartDrag: function () { var d = a(this), l = parseInt(d.attr("datagrid-row-index")), h = e.datagrid("getRowData", l); d.draggable("proxy").css({ left: -1E4, top: -1E4 }); a.isFunction(f.onBeforeDrag) && f.onStartDrag.call(c, l, h) }, onStopDrag: function () { var d = a(this), d = parseInt(d.attr("datagrid-row-index")), l = e.datagrid("getRowData", d); a.isFunction(f.onStopDrag) && f.onStopDrag.call(c, d, l) }, onDrag: function (c) { var d = c.pageX, h = c.pageY, q = c.data.startX, e = c.data.startY; 15 < Math.sqrt((d - q) * (d - q) + (h - e) * (h - e)) && a(this).draggable("proxy").show(); this.pageY = c.pageY } }).droppable({ accept: "tr.datagrid-row", onDragEnter: function (g, l) { var h = a(this), q = a(l), x = parseInt(h.attr("datagrid-row-index")), B = parseInt(q.attr("datagrid-row-index")), K = e.datagrid("getRowData", x), k = e.datagrid("getRowData", B), p = e.datagrid("getRowDom", x), n = p.find("td"), t = h.data("dnd"), x = { droper: h, drager: q, droperIndex: x, dragerIndex: B, droperRow: K, dragerRow: k, droperRowDom: p, mark: n }; t ? a.extend(t, x) : h.data("dnd", x); a.isFunction(f.onDragEnter) && 0 == f.onDragEnter.call(c, K, k) && (d(q, !1), n.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"), h.droppable("disable")) }, onDragOver: function (e, l) { var h = a(this), q = h.data("dnd"), x = q.drager, g = q.droperRow, N = q.dragerRow, q = q.mark; if (!h.droppable("options").disabled) { var k = l.pageY, p = h.offset().top, n = p + h.outerHeight(); d(x, !0); q.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"); k > p + (n - p) / 2 ? q.addClass("datagrid-header-cell-bottom") : q.addClass("datagrid-header-cell-top"); 0 == f.onDragOver.call(c, g, N) && (d(x, !1), q.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"), h.droppable("disable")) } }, onDragLeave: function (e, l) { var h = a(this).data("dnd"), q = h.droperRow, x = h.dragerRow, g = h.mark; d(h.drager, !1); g.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"); a.isFunction(f.onDragLeave) && f.onDragLeave.call(c, q, x) }, onDrop: function (c, d) { var h = a(this).data("dnd"), q = h.droperIndex, E = h.dragerIndex, h = h.mark, f = h.hasClass("datagrid-header-cell-top") ? "top" : "bottom"; e.datagrid("moveRow", { target: q, source: E, point: f }); h.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom") } }); f.dndRow = !0 }, oa = function (c, d) { if (d && d.source && d.target && d.source != d.target && d.point) { a.array.contains(["before", "after"], d.point) || (d.point = "before"); var e = a(c); if (!e.datagrid("hasMuliRowHeader")) { var f = e.datagrid("options"), g, l, h = e.datagrid("getColumnFields"), q = e.datagrid("getColumnFields", !0); a.array.contains(h, d.source) && (g = !1); g == u && a.array.contains(q, d.source) && (g = !0); a.array.contains(h, d.target) && (l = !1); l == u && a.array.contains(q, d.target) && (l = !0); if (g != u && l != u && (!a.isFunction(f.onBeforeMoveColumn) || 0 != f.onBeforeMoveColumn.call(c, d.source, d.target, d.point))) { var h = e.datagrid("getPanel").find("div.datagrid-view"), x = h.find("div.datagrid-view1"), B = h.find("div.datagrid-view2"), h = x.find("div.datagrid-header table tr.datagrid-header-row"), q = B.find("div.datagrid-header table tr.datagrid-header-row"), x = x.find("div.datagrid-body table tr.datagrid-row"), K = B.find("div.datagrid-body table tr.datagrid-row"), B = g ? h.find("td[field\x3d" + d.source + "]") : q.find("td[field\x3d" + d.source + "]"), h = l ? h.find("td[field\x3d" + d.target + "]") : q.find("td[field\x3d" + d.target + "]"), k = g ? x : K, q = l ? x : K; k.length == q.length && (h[d.point](B), q.each(function (c, h) { var l = a(this).find("td[field\x3d" + d.target + "]"), e = a(k[c]).find("td[field\x3d" + d.source + "]"); l[d.point](e) }), q = e.datagrid("getColumnOption", d.source), B = e.datagrid("getColumnOption", d.target), K = g ? f.frozenColumns[0] : f.columns[0], x = l ? f.frozenColumns[0] : f.columns[0], h = f._extensionsDatagrid ? f._extensionsDatagrid : f._extensionsDatagrid = {}, a.array.remove(K, q), B = a.array.indexOf(x, B), -1 < B && a.array.insert(x, "before" == d.point ? B : B + 1, q), e.datagrid("fixColumnSize"), g && !l && (B = a.array.indexOf(h.fields, d.target), a.array.insert(h.fields, "before" == d.point ? B : B + 1, d.source), a.array.insert(h.fieldOptions, "before" == d.point ? B : B + 1, q), a.array.insert(h.fieldOptionsBackup, "before" == d.point ? B : B + 1, a.extend({}, q))), g || (B = a.array.indexOf(h.fields, d.source), l ? (a.array.removeAt(h.fields, B), a.array.removeAt(h.fieldOptions, B), a.array.removeAt(h.fieldOptionsBackup, B)) : (e = h.fieldOptions[B], g = h.fieldOptionsBackup[B], a.array.removeAt(h.fields, B), a.array.removeAt(h.fieldOptions, B), a.array.removeAt(h.fieldOptionsBackup, B), B = a.array.indexOf(h.fields, d.target), a.array.insert(h.fields, "before" == d.point ? B : B + 1, d.source), a.array.insert(h.fieldOptions, "before" == d.point ? B : B + 1, e), a.array.insert(h.fieldOptionsBackup, "before" == d.point ? B : B + 1, g))), a.isFunction(f.onMoveColumn) && f.onMoveColumn.call(c, d.source, d.target, d.point)) } } } }, O = a.fn.datagrid.extensions.removeField = function (c, d, e) { var f, g = -1, l = -1; a.array.likeArray(c.frozenColumns) && (a.each(c.frozenColumns, function (c, e) { if (a.array.likeArray(this)) a.each(this, function (a, c) { if (c.field == d) return l = a, !1 }); else if (e.field == d) return l = c, !1; if (-1 < l) return g = c, !1 }), -1 < l && (f = !0)); f == u && a.array.likeArray(c.columns) && (a.each(c.columns, function (c, e) { if (a.array.likeArray(this)) a.each(this, function (a, c) { if (c.field == d) return l = a, !1 }); else if (e.field == d) return l = c, !1; if (-1 < l) return g = c, !1 }), -1 < l && (f = !1)); -1 < l && (c = f ? c.frozenColumns : c.columns, c = -1 < g ? c[g] : c, a.array.removeAt(c, l), index = a.array.indexOf(e.fields, d), a.array.remove(e.fields, d), a.array.removeAt(e.fieldOptions, index), a.array.removeAt(e.fieldOptionsBackup, index)) }, pa = function (c, d) { var e = a(c), f = e.datagrid("getRows"), g; a.isFunction(d) ? g = a.array.filter(f, d) : a.array.likeArray(d) && !a.util.isString(d) ? (g = a.array.map(d, function (a) { return Z(c, a, e, f) }), g = a.array.filter(g, function (a) { return a != u && null != a })) : g = [Z(c, d, e, f)]; return g }, Z = function (c, d, e, f) { c = e || a(c); f = f || c.datagrid("getRows"); var g = c.datagrid("options"); return a.array.first(f, a.isFunction(d) ? d : function (a) { return a[g.idField] == d }) }, qa = a.fn.datagrid.methods.deleteRow, ra = function (c, d, e) { var f = a(c), g = f.datagrid("options"), l = a.isFunction(d); if (e == u || null == e) e = !0; l ? (l = f.datagrid("getRows"), l = a.array.first(l, d), d = f.datagrid("getRowIndex", l)) : l = f.datagrid("getRowData", d); a.isNumeric(d) && -1 < d && a.isFunction(g.onBeforeDeleteRow) && 0 == g.onBeforeDeleteRow.call(c, d, l) || (qa.call(f, f, d), a.isFunction(g.onDeleteRow) && g.onDeleteRow.call(c, d, l), e && w(f, g)) }, Ka = function (c, d) { var e = a(c), f = e.datagrid("options"); a.array.likeArrayNoString(d); if (a.array.likeArrayNoString(d)) a.each(d, function (a, h) { ra(c, h, !1) }); else { var e = a(c), g = e.datagrid("getRows"); a.each(g, function (a, c) { if (1 == d.call(c, c, a, g)) { var q = e.datagrid("getRowIndex", c); qa.call(e, e, q) } }) } w(e, f) }; a.fn.datagrid.extensions.parseOffset = function (c) { var d = { enable: c ? !0 : !1 }; d.enable && a.extend(d, c); d.width = a.isNumeric(d.width) ? d.width : 0; d.height = a.isNumeric(d.height) ? d.height : 0; return d }; var sa = function (c, d) { var e = a(c), f = e.datagrid("options"), g = f._extensionsDatagrid ? f._extensionsDatagrid : f._extensionsDatagrid = {}; f.offset = g.offset = a.fn.datagrid.extensions.parseOffset(d); g.offset && g.offset.enable && (a.isFunction(g.offsetFunction) || (g.offsetFunction = function () { if (g.offset.enable) { var c = a.util.windowSize(); e.datagrid("resize", { width: c.width + g.offset.width, height: c.height + g.offset.height }) } }, a(window).resize(g.offsetFunction)), g.offsetFunction()) }, ta = function (c, d) { var e = a(c).datagrid("getRows"); return a.array.map(e, function (a) { return a[d] }) }, ea = a.fn.datagrid.methods.getColumnFields, ua = function (c, d) { var e = a(c); if (null == d || d == u || a.util.isBoolean(d)) return ea.call(e, e, d); if (a.util.isString(d)) return a.array.merge([], ea.call(e, e, !0), ea.call(e, e, !1)) }, La = function (c, d) { var e = a(c), f = e.datagrid("getColumnFields", "all"); if (!a.array.contains(f, d)) return []; e = e.datagrid("getRows"); e = a.array.clone(e); a.array.distinct(e, function (a, c) { return a[d] == c[d] }); return e }, U = function (c, d) { var e = a(c), f = e.datagrid("getColumnFields", "all"); if (!a.array.contains(f, d)) return []; e = e.datagrid("getColumnData", d); a.array.distinct(e, function (a, c) { return a == c }); return e }, aa = function (c, d) { var e = a(c), f = ua(c, d); return a.array.map(f, function (a) { return e.datagrid("getColumnOption", a) }) }, fa = function (c, d) { var e = aa(c, d); return a.array.filter(e, function (a) { return a.hidden ? !0 : !1 }) }, ga = function (c, d) { var e = aa(c, d); return a.array.filter(e, function (a) { return a.hidden ? !1 : !0 }) }, Ma = function (c, d) { var e = fa(c, d); return a.array.map(e, function (a) { return a.field }) }, Na = function (c, d) { var e = ga(c, d); return a.array.map(e, function (a) { return a.field }) }, va = function (c, d, f, g, k, l, h) { f = f || a(c); k = k || f.datagrid("getRows"); c = a.isFunction(d) ? Z(c, d, f, k) : d; c = f.datagrid("getRowIndex", c); h = null == h || h == u || 1 == h ? !0 : !1; -1 < c && (g = g || f.datagrid("options"), d = f.datagrid("getRowData", c), l = l || (g._extensionsDatagrid ? g._extensionsDatagrid : g._extensionsDatagrid = {}), l.filterData = a.isArray(l.filterData) ? l.filterData : l.filterData = [], f.datagrid("getRowDom", c).show(), a.array.remove(l.filterData, d), h && e(f, g, l, k)) }, wa = function (c, d, f, g, k, l, h) { f = f || a(c); k = k || f.datagrid("getRows"); c = a.isFunction(d) ? Z(c, d, f, k) : d; c = f.datagrid("getRowIndex", c); h = null == h || h == u || 1 == h ? !0 : !1; -1 < c && (g = g || f.datagrid("options"), d = f.datagrid("getRowData", c), l = l || (g._extensionsDatagrid ? g._extensionsDatagrid : g._extensionsDatagrid = {}), l.filterData = a.isArray(l.filterData) ? l.filterData : [], f.datagrid("unselectRow", c).datagrid("uncheckRow", c).datagrid("getRowDom", c).hide(), a.array.attach(l.filterData, d), h && e(f, g, l, k)) }, Oa = function (c, f) { var g = a(c), k = g.datagrid("options"), p = g.datagrid("getRows"), l, h = k._extensionsDatagrid ? k._extensionsDatagrid : k._extensionsDatagrid = {}; if (!0 === f) { h.filterData = []; var q = g.datagrid("getPanel"), x = q.find("div.datagrid-header-filter-item-icon"); q.find(".datagrid-view .datagrid-body tr.datagrid-row").show(); H(x, "tree-checkbox1"); d(g, k) } else l = a.isFunction(f) ? a.array.filter(p, f) : a.array.likeArray(f) && !a.util.isString(f) ? f : [f]; l && (a.each(l, function (a, d) { va(c, d, g, k, p, h, !1) }), e(g, k, h, p)) }, xa = function (c, f) { var g = a(c), k = g.datagrid("options"), p = g.datagrid("getRows"), l, h = k._extensionsDatagrid ? k._extensionsDatagrid : k._extensionsDatagrid = {}; if (!0 === f) { g.datagrid("unselectAll").datagrid("uncheckAll"); h.filterData = a.array.clone(p); var q = g.datagrid("getPanel"), x = q.find("div.datagrid-header-filter-item-icon"); q.find(".datagrid-view .datagrid-body tr.datagrid-row").hide(); H(x, "tree-checkbox0"); d(g, k) } else l = a.isFunction(f) ? a.array.filter(p, f) : a.array.likeArray(f) && !a.util.isString(f) ? f : [f]; l && (a.each(l, function (a, d) { wa(c, d, g, k, p, h, !1) }), e(g, k, h, p)) }, Pa = function (c) { var d = a(c); c = d.datagrid("options"); d = d.datagrid("getRows"); c = c._extensionsDatagrid ? c._extensionsDatagrid : c._extensionsDatagrid = {}; var e = a.isArray(c.filterData) ? c.filterData : []; return a.array.filter(d, function (c) { return a.array.contains(e, c) ? !1 : !0 }) }, ya = function (c, d) { var e = a(c), f = e.datagrid("options"), g = f._extensionsDatagrid ? f._extensionsDatagrid : f._extensionsDatagrid = {}, l = e.datagrid("getPanel"); if (d) f.columnFilter = d, w(e, f, g), a.util.exec(function () { l.find("div.datagrid-view div.datagrid-header tr.datagrid-header-row div.datagrid-header-filter-container").hide().slideDown("slow") }); else { var g = l.find("div.datagrid-view div.datagrid-header tr.datagrid-header-row div.datagrid-header-filter-container"), h = g.length, q = 0; g.slideUp("slow", function () { ++q == h && (A(e, f), f.columnFilter = d) }) } }, za = function (c, d) { var e = a(c); if (a.util.isBoolean(d)) e.datagrid(d ? "showRows" : "hideRows", !0); else if (d && d.field) { var f = d.field, g = d.value, l = a.array.likeArray(g) && !a.util.isString(g) ? function (c) { return a.array.contains(g, c[f]) } : function (a) { return g == a[f] }, l = e.datagrid("findRows", l); e.datagrid(d.selected ? "showRows" : "hideRows", l) } }, Aa = function (c, d) { var e = a(c), f = a.data(e[0], "datagrid"); f.highlightField && e.datagrid("getColumnDom", { field: f.highlightField, header: !0 }).removeClass("datagrid-row-over"); e.datagrid("getColumnDom", { field: d, header: !0 }).filter(function () { return !a(this).parent().hasClass("datagrid-row-selected") }).addClass("datagrid-row-over"); f.highlightField = d }, Ba = function (c, d) { var e = a(c).datagrid("getPanel"), f, g = d; a.isPlainObject(d) ? (g = d.value, f = d.field, e = e.find("div.datagrid-body tr.datagrid-row td[" + (f ? "field\x3d" + f : "field") + "] div.datagrid-cell")) : e = e.find("div.datagrid-body tr.datagrid-row td[field] div.datagrid-cell"); e.each(function () { var c = a(this); c.find("span.datagrid-cell-hightlight").replaceWith(function () { return a(this).text() }); if (g) { var d = c.html(); d && c.html(a.string.replaceAll(d, g, "\x3cspan class\x3d'datagrid-cell-hightlight'\x3e" + g + "\x3c/span\x3e")) } }) }, da = a.fn.datagrid.extensions.initColumnExtendProperties = function (c, d) { if (!d._initializedExtendProperties) { var e = c.datagrid("getColumns", "all"); a.each(e, function (c, d) { a.union(d, a.fn.datagrid.extensions.columnOptions) }); d._initializedExtendProperties = !0 } }, V = a.fn.datagrid.extensions.initRowDndExtensions = function (a, c) { c = c || a.datagrid("options"); c.dndRow && a.datagrid("enableRowDnd") }; a.fn.datagrid.extensions.parseHeaderContextMenuMap = function (c, d, e, f, g) { return a.array.map(f, function (l, h) { if (!l || a.util.isString(l)) return l; var q = a.extend({}, l); q.id = a.isFunction(l.id) ? l.id.call(q, c, d, e, g) : l.id; q.text = a.isFunction(l.text) ? l.text.call(q, c, d, e, g) : l.text; q.iconCls = a.isFunction(l.iconCls) ? l.iconCls.call(q, c, d, e, g) : l.iconCls; q.disabled = a.isFunction(l.disabled) ? l.disabled.call(q, c, d, e, g) : l.disabled; q.hideOnClick = a.isFunction(l.hideOnClick) ? l.hideOnClick.call(q, c, d, e, g) : l.hideOnClick; q.onclick = a.isFunction(l.onclick) ? function (a, c, h) { l.onclick.call(this, a, d, e, g, c, h) } : l.onclick; q.handler = a.isFunction(l.handler) ? function (a, c, h) { l.handler.call(this, a, d, e, g, c, h) } : l.handler; q.children && q.children.length && (q.children = a.fn.datagrid.extensions.parseHeaderContextMenuMap(c, d, e, q.children, g)); return q }) }; a.fn.datagrid.extensions.parseRowContextMenuMap = function (c, d, e, f, g, l) { return a.array.map(g, function (h, q) { if (!h || a.util.isString(h)) return h; var g = a.extend({}, h); g.id = a.isFunction(h.id) ? h.id.call(g, c, d, e, f, l) : h.id; g.text = a.isFunction(h.text) ? h.text.call(g, c, d, e, f, l) : h.text; g.iconCls = a.isFunction(h.iconCls) ? h.iconCls.call(g, c, d, e, f, l) : h.iconCls; g.disabled = a.isFunction(h.disabled) ? h.disabled.call(g, c, d, e, f, l) : h.disabled; g.hideOnClick = a.isFunction(h.hideOnClick) ? h.hideOnClick.call(g, c, d, e, f, l) : h.hideOnClick; g.onclick = a.isFunction(h.onclick) ? function (a, c, q) { h.onclick.call(this, a, d, e, f, l, c, q) } : h.onclick; g.handler = a.isFunction(h.handler) ? function (a, c, q) { h.handler.call(this, a, d, e, f, l, c, q) } : h.handler; g.children && g.children.length && (g.children = a.fn.datagrid.extensions.parseRowContextMenuMap(c, d, e, f, g.children, l)); return g }) }; a.fn.datagrid.extensions.parseContextMenuEventData = function (c, d, e) { var f = a.fn.datagrid.extensions.parseRemoteQueryParams(d); d = a.fn.datagrid.extensions.parsePaginationParams(c, d); return a.extend({}, f, d, { e: e, grid: c }) }; a.fn.datagrid.extensions.parsePaginationParams = function (c, d) { var e = {}; if (d.pagination) { var f = c.datagrid("getPager"), g = f.pagination("options"), l = g.total, g = Math.ceil(parseFloat(l) / parseFloat(g.pageSize)); a.extend(e, { pager: f, total: l, pageCount: g }) } return e }; a.fn.datagrid.extensions.parseRemoteQueryParams = function (c) { var d = a.extend({}, c.queryParams); c.pagination && a.extend(d, { page: c.pageNumber, rows: c.pageSize }); c.sortName && a.extend(d, { sort: c.sortName, order: c.sortOrder }); return d = a.fn.datagrid.extensions.parsePagingQueryParams(c, d) }; var Qa = function (c, d) { var e = c.datagrid("getRows"); c.datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").each(function () { var f = a(this), g = parseInt(f.attr("datagrid-row-index")); X(c, d, g, e[g], f) }) }, X = function (c, d, e, f, g) { function l(d) { d = c.datagrid("getColumns", "all"); var h = a("\x3ctable\x3e\x3c/table\x3e").css({ padding: "5px" }); a.each(d, function (a, d) { if (d && d.field && d.title) { var l = c.datagrid("getCellDisplay", { field: d.field, index: e }); h.append("\x3ctr\x3e\x3ctd style\x3d'text-align: right; width: 150px;'\x3e" + d.title + ":\x3c/td\x3e\x3ctd style\x3d'width: 250px;'\x3e" + l + "\x3c/td\x3e\x3c/tr\x3e") } }); return h } g = g || c.datagrid("getRowDom", e); if (d.rowTooltip) { var h = function (c) { c = a(this); var h = a.isFunction(d.rowTooltip) ? d.rowTooltip.call(g, e, f) : l(f); c.tooltip("update", h) }; g.each(function () { a.easyui.tooltip.init(this, { onShow: h }) }) } else g.children("td[field]").each(function () { var d = a(this), h = d.attr("field"), l = c.datagrid("getColumnOption", h); if (l && l.tooltip) { var g = d.find("div.datagrid-cell"); a.easyui.tooltip.init(g, { onShow: function (c) { c = a(this); var d = a.isFunction(l.tooltip) ? l.tooltip.call(g, f[h], e, f) : f[h]; c.tooltip("update", d) } }) } }) }, Ra = function (c, d, e) { if (d.extEditing) { var f = c.datagrid("getRowDom", e); if (f.length) { var g = c.datagrid("getPanel").find("div.datagrid-view"), l = g.find("div.datagrid-view1"), h = g.find("div.datagrid-view2"), g = h.find("div.datagrid-body").css("position", "relative"), l = l.outerWidth(), q = f.outerHeight(), f = f.position().top + q + g.scrollTop() - h.find("div.datagrid-header").outerHeight(), f = a('\x3cdiv class\x3d"dialog-button datagrid-rowediting-panel"\x3e\x3c/div\x3e').appendTo(g).css("top", f).attr("datagrid-row-index", e); a("\x3ca\x3e\x3c/a\x3e").appendTo(f).linkbutton({ plain: !1, iconCls: "icon-ok", text: "\u4fdd\u5b58" }).click(function () { c.datagrid("endEdit", e); R(c, d, e) }); a("\x3ca\x3e\x3c/a\x3e").appendTo(f).linkbutton({ plain: !1, iconCls: "icon-cancel", text: "\u53d6\u6d88" }).click(function () { c.datagrid("cancelEdit", e); R(c, d, e) }); g = (d.width - f.outerWidth()) / 2 - l; f.css("left", 0 < g ? g : 0) } } }, R = function (a, c, d) { c.extEditing && (c = (c = body = a.datagrid("getPanel").find("div.datagrid-view div.datagrid-view2 div.datagrid-body")) || a.datagrid("getPanel").find("div.datagrid-view div.datagrid-view2 div.datagrid-body"), c.find("div.datagrid-rowediting-panel[datagrid-row-index\x3d" + d + "]").remove()) }, Sa = a.fn.datagrid.extensions.initExtensions = function (c, d) { var e = d._extensionsDatagrid ? d._extensionsDatagrid : d._extensionsDatagrid = {}; if (!e._initialized) { var f = c.datagrid("getColumnFields", !1); e.fields = a.array.filter(f, function (a) { return c.datagrid("getColumnOption", a).title ? !0 : !1 }); e.fieldOptions = a.array.map(e.fields, function (a) { return c.datagrid("getColumnOption", a) }); e.fieldOptionsBackup = a.array.map(e.fieldOptions, function (c) { return a.extend({}, c) }); e.filterData = []; da(c, e); c.datagrid("setOffset", d.offset); D(c, d, e); y(c, d, e); F(c, d, e); I(c, d, e); C(c, d, e); M(c, d, e); (f = c.datagrid("getRows")) && f.length || w(c, d, e); e._initialized = !0 } }; a.fn.datagrid.extensions.parseOrderbyParams = function (c, d) { c = a.string.isNullOrWhiteSpace(c) ? "" : a.trim(c); d = a.string.isNullOrWhiteSpace(d) ? "" : a.trim(d); d = d.toLowerCase(); "asc" != d && "desc" != d && (d = "asc"); return a.trim(c + " " + d) }; a.fn.datagrid.extensions.parsePagingQueryParams = function (c, d) { var e = a.util.parseMapFunction(d); c.pagination && (e.pageNumber = e.page, e.pageSize = e.rows, e.pageIndex = e.pageNumber - 1); e.orderby = a.fn.datagrid.extensions.parseOrderbyParams(e.sort, e.order); return e }; var ha = a.fn.datagrid.extensions.loader = function (c, d, e) { var f = a(this), g = f.datagrid("options"); Sa(f, g); if (!g.url) return !1; c = a.fn.datagrid.extensions.parsePagingQueryParams(g, c); a.ajax({ type: g.method, url: g.url, data: c, dataType: "json", success: function (a) { d(a) }, error: function () { e.apply(this, arguments) } }) }, Ca = a.fn.datagrid.defaults.onLoadSuccess, Y = a.fn.datagrid.extensions.onLoadSuccess = function (c) { a.isFunction(Ca) && Ca.apply(this, arguments); var d = a(this), e = d.datagrid("options"), f = e._extensionsDatagrid ? e._extensionsDatagrid : e._extensionsDatagrid = {}; w(d, e, f); V(d, e); Qa(d, e) }, Da = a.fn.datagrid.defaults.onResizeColumn, ba = a.fn.datagrid.extensions.onResizeColumn = function (c, d) { a.isFunction(Da) && Da.apply(this, arguments); var e = a(this); if (e.datagrid("options").columnFilter) { var f = e.datagrid("getPanel"), e = e.datagrid("getColumnOption", c); f.find("div.datagrid-header-filter-container[field\x3d" + c + "]").width(e.width) } }, Ea = a.fn.datagrid.defaults.onBeforeEdit, ia = a.fn.datagrid.extensions.onBeforeEdit = function (c, d) { a.isFunction(Ea) && Ea.apply(this, arguments); var e = a(this), f = e.datagrid("options"); Ra(e, f, c); var g = c, l = f._extensionsDatagrid ? f._extensionsDatagrid : f._extensionsDatagrid = {}; f.singleEditing && e.datagrid("endEdit", l.lastEditingIndex); l.lastEditingIndex = g; e.datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable("disable") }, ja = a.fn.datagrid.defaults.onAfterEdit, Ta = a.fn.datagrid.extensions.onAfterEdit = function (c, d, e) { a.isFunction(ja) && ja.apply(this, arguments); var f = a(this), g = f.datagrid("options"), l = g._extensionsDatagrid ? g._extensionsDatagrid : g._extensionsDatagrid = {}; R(f, g, c); w(f, g, l); V(f, g); X(f, g, c, d) }, ka = a.fn.datagrid.defaults.onCancelEdit, Ua = a.fn.datagrid.extensions.onCancelEdit = function (c, d) { a.isFunction(ka) && ka.apply(this, arguments); var e = a(this), f = e.datagrid("options"); R(e, f, c); V(e, f); X(e, f, c, d) }, P = a.fn.datagrid.extensions.methods = { updateRow: function (c, d) { return c.each(function () { if (d && d.row && a.isNumeric(d.index)) { var c = a(this), e = c.datagrid("options"); a.isFunction(e.onBeforeUpdateRow) && 0 == e.onBeforeUpdateRow.call(this, d.index, d.row) || (J.call(c, c, d), w(c, e), V(c, e), X(c, e, d.index, d.row), a.isFunction(e.onUpdateRow) && e.onUpdateRow.call(this, d.index, d.row)) } }) }, appendRow: function (c, d) { return c.each(function () { if (d) { var c = a(this), e = c.datagrid("options"); if (!a.isFunction(e.onBeforeAppendRow) || 0 != e.onBeforeAppendRow.call(this, d)) { L.call(c, c, d); var f = c.datagrid("getRows").length - 1; w(c, e); V(c, e); X(c, e, f, d); a.isFunction(e.onAppendRow) && e.onAppendRow.call(this, d) } } }) }, insertRow: function (c, d) { return c.each(function () { if (d && d.row && a.isNumeric(d.index)) { var c = a(this), e = c.datagrid("options"); a.isFunction(e.onBeforeInsertRow) && 0 == e.onBeforeInsertRow.call(this, d.index, d.row) || (ca.call(c, c, d), w(c, e), V(c, e), X(c, e, d.index, d.row), a.isFunction(e.onInsertRow) && e.onInsertRow.call(this, d.index, d.row)) } }) }, beginEdit: function (a, c) { return a.each(function () { la(this, c) }) }, isChecked: function (a, c) { return Ia(a[0], c) }, isSelected: function (a, c) { return Ja(a[0], c) }, isEditing: function (c, d) { return a(c[0]).datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row[datagrid-row-index\x3d" + d + "]").hasClass("datagrid-row-editing") }, getEditingRowIndex: function (a) { a = ma(a[0]); return a.length ? a[0] : -1 }, getEditingRowIndexs: function (a) { return ma(a[0]) }, freezeColumn: function (c, d) { return c.each(function () { var c = a(this), e = c.datagrid("getColumnFields"), f = c.datagrid("getColumnFields", !0); f && f.length && a.array.contains(e, d) && !a.array.contains(f, d) && c.datagrid("moveColumn", { source: d, target: f[f.length - 1], point: "after" }) }) }, unfreezeColumn: function (c, d) { return c.each(function () { var c = a(this), e = c.datagrid("getColumnFields"), f = c.datagrid("getColumnFields", !0); e && e.length && !a.array.contains(e, d) && a.array.contains(f, d) && c.datagrid("moveColumn", { source: d, target: e[0], point: "before" }) }) }, moveRow: function (c, d) { return c.each(function () { if (d && a.isNumeric(d.source) && a.isNumeric(d.target) && d.source != d.target && d.point) { a.array.contains(["top", "bottom"], d.point) || (d.point = "top"); var c = a(this), e = c.datagrid("options"), f = c.datagrid("getRows"), l = f[d.source], h = f[d.target]; if (l && h && (!a.isFunction(e.onBeforeDrop) || 0 != e.onBeforeDrop.call(this, h, l, d.point))) { var q = c.datagrid("popRow", d.source), g = c.datagrid("getRowIndex", h), f = c.datagrid("getRows"); switch (d.point) { case "top": c.datagrid("insertRow", { index: g, row: q }); break; case "bottom": g++ >= f.length ? c.datagrid("appendRow", q) : c.datagrid("insertRow", { index: g, row: q }) } q && a.isFunction(e.onDrop) && e.onDrop.call(this, h, l, d.point) } } }) }, shiftRow: function (c, d) { return c.each(function () { if (d && a.isNumeric(d.index) && d.point && a.array.contains(["up", "down"], d.point)) { var c = a(this); c.datagrid("options"); c.datagrid("moveRow", { source: d.index, target: "up" == d.point ? d.index - 1 : d.index + 1, point: "up" == d.point ? "top" : "bottom" }) } }) }, nextRow: function (c, d) { var e = a(c[0]).datagrid("getRows"), f = d + 1; return e[f] ? e[f] : null }, prevRow: function (c, d) { var e = a(c[0]).datagrid("getRows"), f = d - 1; return e[f] ? e[f] : null }, popRow: function (c, d) { var e; e = a(c[0]); var f = e.datagrid("getRows")[d]; f ? (e.datagrid("deleteRow", d), e = f) : e = null; return e }, enableRowDnd: function (a) { return a.each(function () { na(this) }) }, disableRowDnd: function (c) { return c.each(function () { var c = a(this), d = c.datagrid("options"); c.datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable("disable"); d.dndRow = !1 }) }, moveColumn: function (a, c) { return a.each(function () { oa(this, c) }) }, shiftColumn: function (c, d) { return c.each(function () { var c = this; if (d && d.field && d.point) { a.array.contains(["before", "after"], d.point) || (d.point = "before"); var e = a(c), c = e.datagrid("getColumnFields", "all"), f = a.array.indexOf(c, d.field); -1 == f || "before" == d.point && 0 == f || "after" == d.point && f == c.length - 1 || (c = c["before" == d.point ? f - 1 : f + 1], e.datagrid("moveColumn", { source: d.field, target: c, point: d.point })) } }) }, nextColumn: function (c, d) { var e; e = a(c[0]); var f = a.array.merge([], e.datagrid("getColumnFields", !0), e.datagrid("getColumnFields", !1)), g = a.array.indexOf(f, d); e = -1 == g || g + 1 >= f.length ? null : e.datagrid("getColumnOption", f[g + 1]); return e }, prevColumn: function (c, d) { var e; e = a(c[0]); var f = a.array.merge([], e.datagrid("getColumnFields", !0), e.datagrid("getColumnFields", !1)), g = a.array.indexOf(f, d); e = 1 > g ? null : e.datagrid("getColumnOption", f[g - 1]); return e }, deleteColumn: function (c, d) { return c.each(function () { var c = a(this), e = c.datagrid("options"), f = e._extensionsDatagrid ? e._extensionsDatagrid : e._extensionsDatagrid = {}; a.isFunction(e.onBeforeDeleteColumn) && 0 == e.onBeforeDeleteColumn.call(this, d) || (O(e, d, f), c.datagrid("getColumnDom", { field: d, header: !0 }).remove(), a.isFunction(e.onDeleteColumn) && e.onDeleteColumn.call(this, d)) }) }, popColumn: function (c, d) { var e = param, f = a(c[0]), g = f.datagrid("getColumnOption", e); g && f.datagrid("deleteColumn", e); return g }, getColumnDom: function (c, d) { var e; e = c[0]; if (a.string.isNullOrEmpty(d)) e = a(); else { e = a(e).datagrid("getPanel"); var f = !a.string.isString(d), g = f ? d.field : d, f = f ? d.header : !1, l = e.find("div.datagrid-view tr.datagrid-row td[field\x3d" + g + "]"); f && (l = l.add(e.find("div.datagrid-view tr.datagrid-header-row td[field\x3d" + g + "]"))); e = l } return e }, getColumnData: function (a, c) { return ta(a[0], c) }, getRowDom: function (c, d) { var e; e = c[0]; e = !a.isNumeric(d) || 0 > d ? a() : a(e).datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row[datagrid-row-index\x3d" + d + "]"); return e }, getRowData: function (c, d) { var e; e = c[0]; e = !a.isNumeric(d) || 0 > d ? u : a(e).datagrid("getRows")[d]; return e }, getCellDom: function (c, d) { var e; e = c[0]; e = !d || !d.field || !a.isNumeric(d.index) || 0 > d.index ? a() : a(e).datagrid("getRowDom", d.index).find("td[field\x3d" + d.field + "] .datagrid-cell"); return e }, getCellData: function (c, d) { var e; e = c[0]; e = !d || !d.field || !a.isNumeric(d.index) || 0 > d.index ? void 0 : a(e).datagrid("getRowData", d.index)[d.field]; return e }, getCellDisplay: function (c, d) { var e = a(c[0]).datagrid("getCellDom", d); return e && e.length ? e.html() : u }, getCellDisplayText: function (c, d) { var e = a(c[0]).datagrid("getCellDom", d); return e && e.length ? e.text() : u }, getColumnFields: function (a, c) { return ua(a[0], c) }, getDistinctRows: function (a, c) { return La(a[0], c) }, getDistinctColumnData: function (a, c) { return U(a[0], c) }, getColumns: function (a, c) { return aa(a[0], c) }, getHiddenColumns: function (a, c) { return fa(a[0], c) }, getVisibleColumns: function (a, c) { return ga(a[0], c) }, getHiddenColumnFields: function (a, c) { return Ma(a[0], c) }, getVisibleColumnFields: function (a, c) { return Na(a[0], c) }, showRow: function (a, c) { return a.each(function () { va(this, c) }) }, hideRow: function (a, c) { return a.each(function () { wa(this, c) }) }, showRows: function (a, c) { return a.each(function () { Oa(this, c) }) }, hideRows: function (a, c) { return a.each(function () { xa(this, c) }) }, getHiddenRows: function (c) { c = a(c[0]).datagrid("options"); return (c._extensionsDatagrid ? c._extensionsDatagrid : c._extensionsDatagrid = {}).filterData }, getVisibleRows: function (a) { return Pa(a[0]) }, highlightColumn: function (a, c) { return a.each(function () { Aa(this, c) }) }, livesearch: function (a, c) { return a.each(function () { Ba(this, c) }) }, hasMuliRowHeader: function (c) { c = a(c[0]).datagrid("options"); return c.columns && 1 < c.columns.length && 0 < c.columns[1].length || c.frozenColumns && 1 < c.frozenColumns.length && 0 < c.frozenColumns[1].length }, findRow: function (a, c) { return Z(a[0], c) }, findRows: function (a, c) { return pa(a[0], c) }, deleteRow: function (a, c) { return a.each(function () { ra(this, c) }) }, deleteRows: function (a, c) { return a.each(function () { Ka(this, c) }) }, setColumnTitle: function (c, d) { return c.each(function () { if (d && d.field && d.title) { var c = a(this), e = c.datagrid("getColumnOption", d.field), f = d.field, l = d.title, c = c.datagrid("getPanel").find("div.datagrid-view div.datagrid-header tr.datagrid-header-row td[field\x3d" + f + "]"); c.length && (c.find("div.datagrid-cell span:first").html(l), e.title = l) } }) }, setColumnWidth: function (c, d) { return c.each(function () { if (d && d.field && d.width && a.isNumeric(d.width)) { a.data(this, "datagrid"); var c = a(this), e = c.datagrid("options"), f = c.datagrid("getColumnOption", d.field), l = d.field, h = d.width, q = c.datagrid("getPanel").find("div.datagrid-view div.datagrid-header tr.datagrid-header-row td[field\x3d" + l + "] div.datagrid-cell"); if (q.length) { var g = q._outerWidth() - parseInt(q[0].style.width); q.css("height", ""); f.width = h; f.boxWidth = h - g; f.auto = u; q.width(f.boxWidth); c.datagrid("fixColumnSize", l); c.datagrid("fitColumns"); e.onResizeColumn.call(this, l, h) } } }) }, setOffset: function (a, c) { return a.each(function () { sa(this, c) }) }, setColumnFilter: function (a, c) { return a.each(function () { ya(this, c) }) }, columnFilterSelect: function (a, c) { return a.each(function () { za(this, c) }) }, exportExcel: function (c, d) { return c.each(function () { var c = d, c = a.string.toBoolean(c); alert("\u5bfc\u51fa" + (c ? "\u5168\u90e8" : "\u5f53\u524d\u9875") + "\u6570\u636e") }) } }, ha = a.fn.datagrid.extensions.defaults = { offset: null, loadFilter: function (c) { return c ? a.isArray(c) ? { total: c.length, rows: c } : c : { total: 0, rows: [] } }, autoBindDblClickRow: !0, dblClickRowMenuIndex: 0, exportMenu: !1, selectOnRowContextMenu: !1, hideDisabledMenu: !1, headerContextMenu: null, rowContextMenu: null, enableHeaderClickMenu: !0, enableHeaderContextMenu: !0, enableRowContextMenu: !0, moveMenu: !1, pagingMenu: { submenu: !1 }, refreshMenu: !0, dndRow: !1, rowTooltip: !1, extEditing: !0, autoEditing: !1, autoEditingEvent: "onDblClickRow", finishEditOnBlur: !1, finishEditLocale: window.document, finishEditMethod: "endEdit", singleEditing: !0, autoFocusField: !0, autoWrapEdit: !0, cancelEditOnEsc: !0, columnFilter: null, showFilterText: u, loader: ha, onLoadSuccess: Y, onResizeColumn: ba, onBeforeEdit: ia, onAfterEdit: Ta, onCancelEdit: Ua, onBeforeDeleteColumn: function (a) { }, onDeleteColumn: function (a) { }, onBeforeMoveColumn: function (a, c, d) { }, onMoveColumn: function (a, c, d) { }, onBeforeDrop: function (a, c, d) { }, onDrop: function (a, c, d) { }, onBeforeDrag: function (a, c) { }, onStartDrag: function (a, c) { }, onStopDrag: function (a, c) { }, onDragEnter: function (a, c) { }, onDragOver: function (a, c) { }, onDragLeave: function (a, c) { }, onBeforeUpdateRow: function (a, c) { }, onUpdateRow: function (a, c) { }, onBeforeAppendRow: function (a) { }, onAppendRow: function (a) { }, onBeforeInsertRow: function (a, c) { }, onBeforeRow: function (a, c) { }, onBeforeDeleteRow: function (a, c) { }, onDeleteRow: function (a, c) { } }; a.fn.datagrid.extensions.columnOptions = { tooltip: !1, filterable: !0, hidable: !0, filter: "checkbox", precision: 1, step: 1 }; a.extend(a.fn.datagrid.defaults, ha); a.extend(a.fn.datagrid.methods, P); var P = a.fn.datagrid.defaults.editors, Va = P.checkbox.init, Fa = P.datebox.init, Wa = P.combobox.init, Ga = P.combotree.init, Xa = P.combogrid.init; a.extend(P.checkbox, { init: function (a, c) { return Va.apply(this, arguments).addClass("datagrid-editable-input datagrid-editable-checkbox") }, setFocus: function (c) { a(c).datebox("textbox").focus() } }); a.extend(P.datebox, { init: function (a, c) { var d = Fa.apply(this, arguments); d.datebox("textbox").addClass("datagrid-editable-input"); return d }, setFocus: function (c) { a(c).datebox("textbox").focus() } }); a.extend(P.combobox, { init: function (a, c) { var d = Wa.apply(this, arguments); d.combobox("textbox").addClass("datagrid-editable-input"); return d }, setFocus: function (c) { a(c).combobox("textbox").focus() } }); a.extend(P.combotree, { init: function (a, c) { var d = Ga.apply(this, arguments); d.combotree("textbox").addClass("datagrid-editable-input"); return d }, setFocus: function (c) { a(c).combotree("textbox").focus() } }); a.extend(P.combogrid, { init: function (a, c) { var d = Xa.apply(this, arguments); d.combogrid("textbox").addClass("datagrid-editable-input"); return d }, setValue: function (c, d) { var e = a(c), f = e.combogrid("options"); d ? f.multiple ? a.util.likeArrayNotString(d) ? e.combogrid("setValues", d) : "string" == typeof d ? e.combogrid("setValues", d.split(f.separator)) : e.combogrid("setValue", d) : e.combogrid("setValue", d) : e.combogrid("clear") }, setFocus: function (c) { a(c).combogrid("textbox").focus() } }); a(document).on("keydown", "div.datagrid div.datagrid-editable input.datagrid-editable-input", function (c) { function d() { var e = a(c.target), f = e.currentDatagrid(), l = f.datagrid("options"), h = a.data(f[0], "treegrid") ? !0 : !1; l.autoWrapEdit && !h && (l = f.datagrid("getRows")) && l.length && (l = l.length, e.closest("td[field]").attr("field"), e = window.parseInt(e.closest("tr[datagrid-row-index]").attr("datagrid-row-index")), f.datagrid("endEdit", e), e < l - 1 && f.datagrid("beginEdit", e + 1)) } function e() { var d = a(c.target), f = d.currentDatagrid(), l = f.datagrid("options"), h = a.data(f[0], "treegrid") ? !0 : !1; l.cancelEditOnEsc && !h && (d = window.parseInt(d.closest("tr[datagrid-row-index]").attr("datagrid-row-index")), f.datagrid("cancelEdit", d)) } switch (c.which) { case 13: d(); break; case 27: e() } }) })(jQuery); (function (a, u) { function w(c, h, f) { f = f || (h._extensionsTreegrid ? h._extensionsTreegrid : h._extensionsTreegrid = {}); a.fn.datagrid.extensions.initColumnExtendProperties(c, f); var x = c.treegrid("getData"); x != f.oldData && (f.filterData = []); A(c, h); d(c, h); if (h.columnFilter) { f.oldData = x; var x = c.treegrid("getPanel").find("div.datagrid-view div.datagrid-header"), B = x.find("table.datagrid-htable tr.datagrid-header-row").find("td[field]").filter(function () { var c = a(this), d = c.attr("colspan"); return d && "1" != d || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 }), k = h.columnFilter = a.extend({ panelHeight: 100, position: "top" }, h.columnFilter), p = a.array.contains(["top", "bottom"], k.position) ? k.position : "top"; k.panelHeight = a.isNumeric(k.panelHeight) && 60 <= k.panelHeight ? k.panelHeight : 60; x.height(); var n = c.treegrid("getRows"); B.each(function () { var d = a(this).addClass("datagrid-header-filter").removeClass("datagrid-header-filter-top datagrid-header-filter-bottom"); d.find("div.datagrid-cell").addClass("datagrid-header-filter-cell"); var e = d.attr("field"), x = c.treegrid("getColumnOption", e), t = x.width; a("\x3chr /\x3e").addClass("datagrid-header-filter-line")["top" == p ? "prependTo" : "appendTo"](this); t = a("\x3cdiv\x3e\x3c/div\x3e").attr("field", e).addClass("datagrid-header-filter-container").css({ height: k.panelHeight, width: t })["top" == p ? "prependTo" : "appendTo"](this); d.addClass("top" == p ? "datagrid-header-filter-top" : "datagrid-header-filter-bottom"); if (e && (d = f, x.filterable)) { var e = x.field, v = c.treegrid("getDistinctColumnData", e), z = a.array.contains(["checkbox", "livebox", "caps", "lower", "none"], x.filter) ? x.filter : "checkbox", J = x.precision, x = x.step; switch (z) { case "checkbox": r(c, h, d, t, e, n, v); break; case "livebox": m(c, h, t, e, n); break; case "caps": g(c, h, t, e, x, J, n, v, "\x3c\x3d", h.columnFilter.panelHeight, B); break; case "lower": g(c, h, t, e, x, J, n, v, "\x3e\x3d", h.columnFilter.panelHeight, B) } } }); f.filterData && f.filterData.length ? c.treegrid("hideRows", f.filterData) : e(c, h, f, n, B) } } function A(c, d) { if (d.columnFilter) { var e = c.treegrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function () { var c = a(this), d = c.attr("colspan"); return d && "1" != d || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 }); e.removeClass("datagrid-header-filter datagrid-header-filter-top datagrid-header-filter-bottom").find("div.datagrid-cell").removeClass("datagrid-header-filter-cell"); e.find("hr.datagrid-header-filter-line,div.datagrid-header-filter-container").remove(); e = c.treegrid("getColumnFields", "all"); c.datagrid("fixColumnSize", e[e.length - 1]) } } function r(c, d, e, f, g, k, p) { a.each(p, function (e, q) { var p = a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-item").attr("text", q).appendTo(f); a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-item-text").text(q).appendTo(p); a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-item-icon").appendTo(p); p.click(function () { var e = a.array.filter(k, function (a) { return a[g] == q }), f = c.treegrid("getHiddenRows"), f = a.array.filter(f, function (a) { return a[g] == q }); c.treegrid(f.length ? "showRows" : "hideRows", a.array.map(e, function (a) { return a[d.idField] })) }) }) } function m(c, d, e, f, g) { a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-livebox-text").text("\u6a21\u7cca\u8fc7\u6ee4\uff1a").appendTo(e); var k = a("\x3cinput /\x3e").addClass("datagrid-header-filter-livebox").appendTo(e), p = a("\x3ca /\x3e").linkbutton({ plain: !0, iconCls: "icon-search" }).appendTo(e).click(function () { c.treegrid("showRows", !0); var e = k.val(); if (!a.string.isNullOrEmpty(e)) { var q = a.array.filter(g, function (a) { return -1 == String(a[f]).indexOf(e) }); c.treegrid("hideRows", a.array.map(q, function (a) { return a[d.idField] })) } k.focus() }); a("\x3ca /\x3e").linkbutton({ plain: !0, iconCls: "icon-undo" }).appendTo(e).click(function () { k.val() ? (k.val("").focus(), p.click()) : k.focus() }); k.keypress(function (a) { 13 == a.which && p.click() }) } function g(d, e, f, g, B, k, p, n, t, v, m) { var z = a.array.map(n, function (c) { c = parseFloat(c); return a.isNumeric(c) ? c : 0 }); n = z.length ? a.array.min(z) : 0; var r = z.length ? a.array.max(z) : 0, J = z.length ? a.array.max(z, function (c, d) { return a.util.compare(a.number.precision(c), a.number.precision(d)) }) : 0, L = z.length ? a.number.precision(J) : 0; v -= 45; z = a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-itemwrap").text(t).appendTo(f); f = a("\x3cdiv\x3e\x3c/div\x3e").addClass("datagrid-header-filter-sliderwrap").css({ height: v + 10 })["\x3c\x3d" == t ? "appendTo" : "prependTo"](f); var u = a("\x3cinput /\x3e").addClass("datagrid-header-filter-numeric").appendTo(z), w = a("\x3cinput /\x3e").addClass("datagrid-header-filter-slider").appendTo(f); f = function (a, f) { c(d, e, g, p, a, t, u, w, m) }; u.numberbox({ value: "\x3c\x3d" == t ? r : n, min: n, max: r, precision: k, onChange: f, height: 18 }); u.keypress(function (c) { 13 == c.which && (c = u.val(), u.numberbox("setValue", a.isNumeric(c) ? c : 0)) }); w.slider({ height: v, mode: "v", showTip: !0, value: "\x3c\x3d" == t ? r : n, min: n, max: r, rule: [n, "|", r], step: B, onComplete: f, tipFormatter: function (c) { return a.number.round(c || 0, L) } }) } function c(c, d, e, f, g, k, p, n, t) { t = (t || c.treegrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function () { var c = a(this), d = c.attr("colspan"); return d && "1" != d || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 })).filter(function () { return a(this).attr("field") == e }); p = p ? p : t.find(".datagrid-header-filter-numeric"); n = n ? n : t.find(".datagrid-header-filter-slider"); f = a.array.filter(f, function (c) { c = parseFloat(c[e]); c = a.isNumeric(c) ? c : 0; return "\x3e\x3d" == k ? c < g : c > g }); c.treegrid("showRows", !0).treegrid("hideRows", a.array.map(f, function (a) { return a[d.idField] })); p.numberbox("setValue", g); n.slider("setValue", g) } function e(c, e, q, g, B) { d(c, e); e.columnFilter && (B = B || c.treegrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function () { var c = a(this), d = c.attr("colspan"); return d && "1" != d || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 }), B.each(function () { var d = a(this), e = d.attr("field"), h = c.treegrid("getColumnOption", e); switch (a.array.contains(["checkbox", "livebox", "caps", "lower", "none"], h.filter) ? h.filter : "checkbox") { case "checkbox": f(c, q, g, d, e) } })) } function d(a, c) { if (c.pagination) { var d = a.treegrid("getPager"); if (d && d.length) { var e = a.treegrid("getVisibleRows").length, f = a.datagrid("getRows").length, g = e < f ? !0 : !1, k = d.find("div.pagination-visiblerows"); if (0 == c.showFilterText || (null == c.showFilterText || c.showFilterText == u) && !g) return k.remove(); k.length ? k.html("\u5f53\u524d\u9875\u663e\u793a" + e + "/" + f + "\u884c") : d.find("div.pagination-info").before('\x3cdiv class\x3d"pagination-visiblerows"\x3e\u5f53\u524d\u9875\u663e\u793a' + e + "/" + f + "\u884c\x3c/div\x3e") } } } function f(c, d, e, f, g) { f.find("div.datagrid-header-filter-item").each(function () { var d = a(this), h = d.attr("text"), f = d.find("div.datagrid-header-filter-item-icon"), x = a.array.sum(e, function (a) { return a[g] == h ? 1 : 0 }), k = c.treegrid("getHiddenRows"), k = a.array.sum(k, function (a) { return a[g] == h ? 1 : 0 }), k = 0 == k ? "tree-checkbox1" : k >= x ? "tree-checkbox0" : "tree-checkbox2"; a.easyui.tooltip.init(d, { content: (a.string.isNullOrEmpty(h) ? "\u7a7a\u767d" : h) + ": \u5171" + x + "\u4e2a\u5143\u7d20" }); H(f, k) }) } function H(a, c) { a.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2").addClass(c) } function D(c, d, e) { var f = c.datagrid("options"); e.onHeaderContextMenuBak = d.onHeaderContextMenu; d.onHeaderContextMenu = f.onHeaderContextMenu = function (f, g) { a.isFunction(e.onHeaderContextMenuBak) && e.onHeaderContextMenuBak.apply(this, arguments); if (d.enableHeaderContextMenu) { var x = a.fn.datagrid.extensions.parseContextMenuEventData(c, d, f), x = I(c, d, e, f, g, x); a.easyui.showMenu({ items: x, left: f.pageX, top: f.pageY, hideDisabledMenu: d.hideDisabledMenu }); f.preventDefault() } } } function y(c, d, e) { e.onContextMenuBak = d.onContextMenu; d.onContextMenu = function (f, g) { a.isFunction(e.onContextMenuBak) && e.onContextMenuBak.apply(this, arguments); d.selectOnRowContextMenu && c.treegrid("select", g[d.idField]); if (d.enableRowContextMenu) { var k = a.fn.datagrid.extensions.parseContextMenuEventData(c, d, f), k = C(c, d, e, f, g, k); d.autoBindDblClickRow && 0 <= d.dblClickRowMenuIndex && a.util.likeArray(d.rowContextMenu) && !a.util.isString(d.rowContextMenu) && d.rowContextMenu.length > d.dblClickRowMenuIndex && (k[d.dblClickRowMenuIndex].bold = !0); a.easyui.showMenu({ items: k, left: f.pageX, top: f.pageY, hideDisabledMenu: d.hideDisabledMenu }); f.preventDefault() } } } function F(c, d, e) { d.enableHeaderClickMenu && c.treegrid("getPanel").find(".datagrid-view .datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function () { var c = a(this), d = c.attr("colspan"); return d && "1" != d || c.find("div.datagrid-header-check,div.datagrid-header-rownumber").length ? !1 : !0 }).find("div.datagrid-cell").each(function () { G(c, d, e, this) }) } function G(c, d, e, f) { var g = a("\x3cspan class\x3d's-btn-downarrow datagrid-header-cell-arrow'\x3e\x26nbsp;\x3c/span\x3e").click(function (f) { var x = a(this), k = x.offset(), p = x.outerHeight(), x = x.parent().parent().attr("field"), n = a.fn.datagrid.extensions.parseContextMenuEventData(c, d, f); f = I(c, d, e, f, x, n); var k = a.easyui.showMenu({ items: f, left: k.left, top: k.top + p }).menu("options"), t = k.onHide; g.hidable = !1; k.onHide = function () { g.hidable = !0; g.removeClass("datagrid-header-cell-arrow-show"); t.apply(this, arguments) }; return !1 }).prependTo(f); a(f).off(".hoverArrow").on({ "mouseenter.hoverArrow": function () { g.addClass("datagrid-header-cell-arrow-show") }, "mouseleave.hoverArrow": function () { a.util.isBoolean(g.hidable) && !g.hidable || g.removeClass("datagrid-header-cell-arrow-show") } }) } function I(c, d, e, f, g, k) { var p = [], n = a.util.likeArray(d.headerContextMenu) && !a.util.isString(d.headerContextMenu) ? d.headerContextMenu : []; n.length && a.array.merge(p, n); d = M(c, d, e, f, g, k); d.length && a.array.merge(p, "-", d); p = a.fn.datagrid.extensions.parseHeaderContextMenuMap(f, g, k, p, c); "-" == p[0] && a.array.removeAt(p, 0); return p } function C(c, d, e, f, g, k) { var p = [], n = a.util.likeArray(d.rowContextMenu) && !a.util.isString(d.rowContextMenu) ? d.rowContextMenu : []; n.length && a.array.merge(p, n); d = v(c, d, e, f, g, k); d.length && a.array.merge(p, "-", d); p = a.fn.treegrid.extensions.parseRowContextMenuMap(f, g, k, p, c); "-" == p[0] && a.array.removeAt(p, 0); return p } function M(c, d, e, f, g, k) { var p = [], t = d.exportMenu, v = c.treegrid("getColumnOption", g), m = v.sortable; "object" == typeof t && (t = a.extend({ current: !1, all: !1, submenu: !0 }, t)); var r = { text: "\u5347\u5e8f", iconCls: "icon-standard-hmenu-asc", disabled: 1 != m, handler: function () { return c.treegrid("sort", { sortName: g, sortOrder: "asc" }) } }, m = { text: "\u964d\u5e8f", iconCls: "icon-standard-hmenu-desc", disabled: 1 != m, handler: function () { return c.treegrid("sort", { sortName: g, sortOrder: "desc" }) } }, J = { text: "\u663e\u793a/\u9690\u85cf\u5217", iconCls: "icon-standard-application-view-columns", disabled: !1, children: [{ text: "\u663e\u793a\u5168\u90e8\u5217", iconCls: function () { var c = e.fields ? e.fields.length : 0, d = a.array.sum(e.fieldOptions, function (a) { return a.hidden ? 0 : 1 }); return d >= c ? "tree-checkbox1" : 0 == d ? "tree-checkbox0" : "tree-checkbox2" }, hideOnClick: !1, handler: function (c, d, h, f, l, g) { a.each(e.fields, function () { f.treegrid("showColumn", this) }); a(this).parent().children("div.menu-item:not(:eq(1))").each(function () { g.menu("setIcon", { target: this, iconCls: "tree-checkbox1" }); g.menu("enableItem", this) }) } }, { text: "\u8fd8\u539f\u9ed8\u8ba4", iconCls: "icon-standard-application-view-tile", hideOnClick: !1, handler: function (c, d, h, f, l, g) { a.each(e.fieldOptionsBackup, function () { f.treegrid(1 == this.hidden ? "hideColumn" : "showColumn", this.field) }); c = a(this).parent(); c.children("div.menu-item:gt(1)").each(function () { var c = a(this).text(), d = a.array.first(e.fieldOptions, function (a) { return a.title == c }); d && g.menu("setIcon", { target: this, iconCls: d.hidden ? "tree-checkbox0" : "tree-checkbox1" }); g.menu("enableItem", this) }); c.children("div.menu-item:first").each(function () { var c = e.fields ? e.fields.length : 0, d = a.array.sum(e.fieldOptions, function (a) { return a.hidden ? 0 : 1 }); g.menu("setIcon", { target: this, iconCls: d >= c ? "tree-checkbox1" : 0 == d ? "tree-checkbox0" : "tree-checkbox2" }) }) } }, "-"] }, L = { text: "\u8fc7\u6ee4/\u663e\u793a", iconCls: "icon-standard-application-view-list", disabled: !v.filterable, children: [] }, u = { text: "\u5bfc\u51fa\u5f53\u524d\u9875", iconCls: "icon-standard-page-white-put", disabled: !(1 == t || 1 == t.current), handler: function () { return c.treegrid("exportExcel", !1) } }, w = { text: "\u5bfc\u51fa\u5168\u90e8", iconCls: "icon-standard-page-white-stack", disabled: !(1 == t || 1 == t.all), handler: function () { return c.treegrid("exportExcel", !0) } }; a.util.merge(J.children, z(c, d, e, f, g, k)); v.filterable && a.util.merge(L.children, n(c, d, e, f, g, k)); a.util.merge(p, [r, m, "-", J, L]); d = [u, w]; t && a.array.merge(p, "-", "object" != typeof t || t.submenu ? { text: "\u5bfc\u51fa\u6570\u636e", iconCls: "icon-standard-page-save", children: d } : d); return p } function z(c, d, e, f, g, k) { return a.array.map(e.fieldOptions, function (c) { return { text: c.title || c.field, iconCls: c.hidden ? "tree-checkbox0" : "tree-checkbox1", hideOnClick: !1, disabled: c.hidable && c.field != d.treeField ? !1 : !0, handler: function (f, l, g, x, k, B) { if (c.field == d.treeField) a.messager.show("\u6811\u8282\u70b9\u5217\u4e0d\u80fd\u88ab\u9690\u85cf\u3002"); else if (f = a(this), l = f.parent().find(".menu-item:gt(1) .tree-checkbox1").length, (1 != l || c.hidden) && c.hidable) { x.treegrid(c.hidden ? "showColumn" : "hideColumn", c.field); B.menu("setIcon", { target: this, iconCls: c.hidden ? "tree-checkbox0" : "tree-checkbox1" }); l = a.array.sum(e.fieldOptions, function (a) { return a.hidden ? 0 : 1 }); x = e.fields ? e.fields.length : 0; B.menu("setIcon", { target: f.parent().children("div.menu-item:first"), iconCls: l >= x ? "tree-checkbox1" : 0 == l ? "tree-checkbox0" : "tree-checkbox2" }); var p = f.parent().find(".menu-item:gt(1)").filter(function () { return a(".tree-checkbox1", this).length ? !0 : !1 }); p.each(function () { B.menu(1 < p.length ? "enableItem" : "disableItem", this) }) } } } }) } function n(c, d, e, f, g, k) { var p = c.treegrid("getRows"), n = c.treegrid("getDistinctColumnData", g); k = [{ text: "\u5168\u90e8", hideOnClick: !1, iconCls: e.filterData && e.filterData.length ? e.filterData.length >= p.length ? "tree-checkbox0" : "tree-checkbox2" : "tree-checkbox1", handler: function (c, d, h, f, g, l) { e.filterData && e.filterData.length ? f.treegrid("showRows", !0) : f.treegrid("hideRows", !0); a(this).parent().children("div.menu-item[hideOnClick\x3dfalse]").each(function () { l.menu("setIcon", { target: this, iconCls: e.filterData && e.filterData.length ? "tree-checkbox0" : "tree-checkbox1" }) }) } }, "-"]; var t = 15 <= n.length, v = t ? a.array.left(n, 10) : n, v = a.array.map(v, function (f) { var x = a.array.filter(p, function (a) { return a[g] == f }), k = x.length, n = c.treegrid("getHiddenRows"), n = a.array.sum(n, function (a) { return a[g] == f ? 1 : 0 }); return { text: f, iconCls: n ? n >= k ? "tree-checkbox0" : "tree-checkbox2" : "tree-checkbox1", hideOnClick: !1, handler: function (c, g, l, k, B, n) { c = k.treegrid("getHiddenRows"); c = a.array.sum(c, function (a) { return a[g] == f ? 1 : 0 }); k.treegrid(c ? "showRows" : "hideRows", a.array.map(x, function (a) { return a[d.idField] })); n.menu("setIcon", { target: this, iconCls: c ? "tree-checkbox1" : "tree-checkbox0" }); a(this).parent().children("div.menu-item:first").each(function () { var a = k.treegrid("getHiddenRows"); n.menu("setIcon", { target: this, iconCls: e.filterData.length ? a.length >= p.length ? "tree-checkbox0" : "tree-checkbox2" : "tree-checkbox1" }) }) } } }); a.array.merge(k, v); if (t) { var t = c.treegrid("getColumnOption", g), m = t.title ? t.title : t.field; a.array.merge(k, ["-", { text: "\u5904\u7406\u66f4\u591a(\u5171" + n.length + "\u9879)...", iconCls: "icon-standard-application-view-detail", handler: function () { var k = a('\x3cinput type\x3d"button" value\x3d"\u5168\u90e8\u9009\u62e9" /\x3e').click(function () { c.treegrid("showRows", !0); a(this).parent().find(":checkbox").each(function () { this.checked = !0 }) }), t = a('\x3cinput type\x3d"button" value\x3d"\u5168\u90e8\u4e0d\u9009" /\x3e').click(function () { c.treegrid("hideRows", !0); a(this).parent().find(":checkbox").each(function () { this.checked = !1 }) }); a("\x3cdiv\x3e\x3c/div\x3e").append("\x3cdiv\x3e\u5217\uff1a" + m + "\uff0c\u5171" + n.length + "\u9879\x3c/div\x3e\x3chr /\x3e").css({ padding: "10px" }).append(k).append(t).append("\x3chr /\x3e").each(function () { var f = a(this), x = a("\x3cul\x3e\x3c/ul\x3e").css({ "list-style-type": "decimal", "padding-left": "40px", "line-height": "18px" }).appendTo(f); a.each(n, function (f, k) { var n = "itemCheckbox_" + a.util.guid("N"), t = !a.array.some(e.filterData, function (a) { return a[g] == k }), v = a("\x3cli\x3e\x3c/li\x3e").appendTo(x), t = a("\x3cinput /\x3e").attr({ type: "checkbox", id: n, checked: t }).appendTo(v); a("\x3clabel\x3e\x3c/label\x3e").attr("for", n).text(k).appendTo(v); t.click(function () { var f = a.array.filter(p, function (a) { return a[g] == k }), x = a.array.sum(e.filterData, function (a) { return a[g] == k ? 1 : 0 }); c.treegrid(x ? "showRows" : "hideRows", a.array.map(f, function (a) { return a[d.idField] })) }) }) }).dialog({ title: "\u8fc7\u6ee4/\u663e\u793a", iconCls: "icon-standard-application-view-detail", height: 260, width: 220, left: f.pageX, top: f.pageY, collapsible: !1, minimizable: !1, maximizable: !1, closable: !0, modal: !0, resizable: !0, onClose: function () { a(this).dialog("destroy") } }).dialog("open") } }]) } return k } function v(c, d, e, f, g, k) { e = []; f = d.pagingMenu; var p = d.toggleMenu, n = d.moveMenu, t = d.exportMenu, v = g[d.idField]; "object" == typeof f && (f = a.extend({ disabled: !1, submenu: !0 }, f)); "object" == typeof p && (p = a.extend({ expand: !0, expandAll: !0, collapse: !0, collapseAll: !0, submenu: !1 }, p)); "object" == typeof n && (n = a.extend({ up: !1, upLevel: !1, down: !1, downLevel: !1, submenu: !1 }, n)); "object" == typeof t && (t = a.extend({ current: !1, all: !1, submenu: !0 }, t)); var m = { text: "\u5c55\u5f00\u5f53\u524d\u6240\u6709", iconCls: "icon-metro-expand", disabled: !(1 == p || 1 == p.expandAll), handler: function () { c.treegrid("expandAll", v) } }, z = { text: "\u5c55\u5f00\u5f53\u524d", iconCls: "icon-metro-expand2", disabled: !(1 == p || 1 == p.expand), handler: function () { c.treegrid("expand", v) } }, r = { text: "\u6298\u53e0\u5f53\u524d", iconCls: "icon-metro-contract2", disabled: !(1 == p || 1 == p.collapse), handler: function () { c.treegrid("collapse", v) } }, J = { text: "\u6298\u53e0\u5f53\u524d\u6240\u6709", iconCls: "icon-metro-contract", disabled: !(1 == p || 1 == p.collapseAll), handler: function () { c.treegrid("collapseAll", v) } }, L = { text: "\u4e0a\u79fb\u4e00\u7ea7", iconCls: "icon-standard-arrow-up", disabled: !(1 == n || 1 == n.upLevel), handler: function () { c.treegrid("shiftRow", { point: "upLevel", id: v }) } }, u = { text: "\u4e0a\u79fb", iconCls: "icon-standard-up", disabled: !(1 == n || 1 == n.up), handler: function () { c.treegrid("shiftRow", { point: "up", id: v }) } }, w = { text: "\u4e0b\u79fb", iconCls: "icon-standard-down", disabled: !(1 == n || 1 == n.down), handler: function () { c.treegrid("shiftRow", { point: "down", id: v }) } }, y = { text: "\u4e0b\u79fb\u4e00\u7ea7", iconCls: "icon-standard-arrow-down", disabled: !(1 == n || 1 == n.downLevel), handler: function () { c.treegrid("shiftRow", { point: "downLevel", id: v }) } }, A = { text: "\u5bfc\u51fa\u5f53\u524d\u9875", iconCls: "icon-standard-page-white-put", disabled: !(1 == t || 1 == t.current), handler: function () { return c.treegrid("exportExcel", !1) } }, ca = { text: "\u5bfc\u51fa\u5168\u90e8", iconCls: "icon-standard-page-white-stack", disabled: !(1 == t || 1 == t.all), handler: function () { return c.treegrid("exportExcel", !0) } }; e.push({ text: "\u5237\u65b0\u5f53\u524d\u9875", iconCls: "pagination-load", disabled: !d.refreshMenu, handler: function () { c.treegrid("reload") } }); g = [{ text: "\u9996\u9875", iconCls: "pagination-first", disabled: function () { return !d.pagination || 1 >= k.page }, handler: function () { 1 < k.page && k.pager.pagination("select", 1) } }, { text: "\u4e0a\u4e00\u9875", iconCls: "pagination-prev", disabled: function () { return !d.pagination || 1 >= k.page }, handler: function () { 1 < k.page && k.pager.pagination("select", k.page - 1) } }, { text: "\u4e0b\u4e00\u9875", iconCls: "pagination-next", disabled: function () { return !d.pagination || k.page >= k.pageCount }, handler: function () { k.page < k.pageCount && k.pager.pagination("select", k.page + 1) } }, { text: "\u672b\u9875", iconCls: "pagination-last", disabled: function () { return !d.pagination || k.page >= k.pageCount }, handler: function () { k.page < k.pageCount && k.pager.pagination("select", k.pageCount) } }]; m = [m, z, r, J]; L = [L, u, w, y]; A = [A, ca]; c.treegrid("isRoot", v) && a.array.insertRange(m, 0, [{ text: "\u5c55\u5f00\u6240\u6709", iconCls: "icon-standard-arrow-out", handler: function () { c.treegrid("expandAll") } }, { text: "\u6298\u53e0\u6240\u6709", iconCls: "icon-standard-arrow-in", handler: function () { c.treegrid("collapseAll") } }, "-"]); f && a.array.merge(e, "-", "object" != typeof f || f.submenu ? { text: "\u7ffb\u9875", iconCls: "", disabled: !(1 == f || !f.disabled), children: g } : g); p && a.array.merge(e, "-", "object" != typeof p || p.submenu ? { text: "\u5c55\u5f00/\u6298\u53e0", iconCls: "", disabled: !p, children: m } : m); n && a.array.merge(e, "-", "object" != typeof n || n.submenu ? { text: "\u4e0a/\u4e0b\u79fb\u52a8", iconCls: "", disabled: !n, children: L } : L); t && a.array.merge(e, "-", "object" != typeof t || t.submenu ? { text: "\u5bfc\u51fa\u6570\u636e", iconCls: "icon-standard-page-save", disabled: !t, children: A } : A); return e } function k(c, d, e) { e.onDblClickRowBak = d.onDblClickRow; d.onDblClickRow = function (f) { a.isFunction(e.onDblClickRowBak) && e.onDblClickRowBak.apply(this, arguments); var g = a.fn.datagrid.extensions.parseContextMenuEventData(c, d, null); items = C(c, d, e, null, f, g); if (d.autoBindDblClickRow && 0 <= d.dblClickRowMenuIndex && a.util.likeArray(d.rowContextMenu) && !a.util.isString(d.rowContextMenu) && d.rowContextMenu.length > d.dblClickRowMenuIndex) { var k = items[d.dblClickRowMenuIndex], p = k.handler || k.onclick; if (!k.disabled) return p(null, f, g, c, k, null) } } } function p(c, d, e) { e[d.autoEditingEvent] = d[d.autoEditingEvent]; d[d.autoEditingEvent] = function (f) { a.isFunction(e[d.autoEditingEvent]) && e[d.autoEditingEvent].apply(this, arguments); d.autoEditing && c.treegrid("beginEdit", f[d.idField]) } } function t(c, d, e) { a(d.finishEditLocale).click(function (e) { if (d.finishEditOnBlur && a.data(c[0], "treegrid")) { var f = c.treegrid("getPanel"), g = c.treegrid("getEditingNodeIds"); a.contains(f[0], e.target) || a.each(g, function (a, e) { c.treegrid(d.finishEditMethod, e) }) } }) } a.fn.treegrid.extensions = {}; var J = a.fn.treegrid.methods.update, L = a.fn.treegrid.methods.append, ca = a.fn.treegrid.methods.insert, Ha = function (c, d) { if (d && d.data) { var e = a(c), f = e.treegrid("options"); a.isFunction(f.onBeforeAppend) && 0 == f.onBeforeAppend.call(c, d.parent, d.data) || (L.call(e, e, d), w(e, f), R(e, f), a.each(d.data, function () { Y(e, f, this[f.idField], this) }), a.isFunction(f.onAppend) && f.onAppend.call(c, d.parent, d.data)) } }, la = function (c, d, e, f) { var g = c.treegrid("getCellDom", { field: f, id: e }), k = c.treegrid("getLevel", e); for (e = c.treegrid("getChildren", e) ; g.find("span.tree-indent,span.tree-hit").length < k;) a("\x3cspan\x3e\x3c/span\x3e").addClass("tree-indent").prependTo(g); a.each(e, function () { la(c, d, this[d.idField], f) }) }, Ia = function (c, d) { if (d && d.source && d.target && d.source != d.target && d.point) { a.array.contains(["before", "after"], d.point) || (d.point = "before"); var e = a(c); if (!e.treegrid("hasMuliRowHeader")) { var f = e.treegrid("options"), g, k, p = e.treegrid("getColumnFields"), n = e.treegrid("getColumnFields", !0); a.array.contains(p, d.source) && (g = !1); g == u && a.array.contains(n, d.source) && (g = !0); a.array.contains(p, d.target) && (k = !1); k == u && a.array.contains(n, d.target) && (k = !0); if (g != u && k != u && (!a.isFunction(f.onBeforeMoveColumn) || 0 != f.onBeforeMoveColumn.call(c, d.source, d.target, d.point))) { var p = e.treegrid("getPanel").find("div.datagrid-view"), t = p.find("div.datagrid-view1"), v = p.find("div.datagrid-view2"), p = t.find("div.datagrid-header table tr.datagrid-header-row"), n = v.find("div.datagrid-header table tr.datagrid-header-row"), t = t.find("div.datagrid-body table tr.datagrid-row"), m = v.find("div.datagrid-body table tr.datagrid-row"), v = g ? p.find("td[field\x3d" + d.source + "]") : n.find("td[field\x3d" + d.source + "]"), p = k ? p.find("td[field\x3d" + d.target + "]") : n.find("td[field\x3d" + d.target + "]"), z = g ? t : m, n = k ? t : m; if (z.length == n.length) { p[d.point](v); n.each(function (c, e) { var f = a(this); f.attr("node-id"); var f = f.find("td[field\x3d" + d.target + "]"), g = a(z[c]).find("td[field\x3d" + d.source + "]"); f[d.point](g) }); var n = e.treegrid("getColumnOption", d.source), v = e.treegrid("getColumnOption", d.target), r = g ? f.frozenColumns[0] : f.columns[0], t = k ? f.frozenColumns[0] : f.columns[0], p = f._extensionsTreegrid ? f._extensionsTreegrid : f._extensionsTreegrid = {}; a.array.remove(r, n); v = a.array.indexOf(t, v); -1 < v && a.array.insert(t, "before" == d.point ? v : v + 1, n); m = f; f = e.datagrid("options"); n = e.datagrid("getColumnOption", d.source); v = e.datagrid("getColumnOption", d.target); r = g ? f.frozenColumns[0] : f.columns[0]; t = k ? f.frozenColumns[0] : f.columns[0]; a.array.remove(r, n); v = a.array.indexOf(t, v); -1 < v && a.array.insert(t, "before" == d.point ? v : v + 1, n); f = m; g || k && g != k ? (t = e.treegrid("getData"), e.treegrid("loadData", t)) : e.treegrid("fixColumnSize"); g && !k && (v = a.array.indexOf(p.fields, d.target), a.array.insert(p.fields, "before" == d.point ? v : v + 1, d.source), a.array.insert(p.fieldOptions, "before" == d.point ? v : v + 1, n), a.array.insert(p.fieldOptionsBackup, "before" == d.point ? v : v + 1, a.extend({}, n))); g || (v = a.array.indexOf(p.fields, d.source), k ? (a.array.removeAt(p.fields, v), a.array.removeAt(p.fieldOptions, v), a.array.removeAt(p.fieldOptionsBackup, v)) : (e = p.fieldOptions[v], g = p.fieldOptionsBackup[v], a.array.removeAt(p.fields, v), a.array.removeAt(p.fieldOptions, v), a.array.removeAt(p.fieldOptionsBackup, v), v = a.array.indexOf(p.fields, d.target), a.array.insert(p.fields, "before" == d.point ? v : v + 1, d.source), a.array.insert(p.fieldOptions, "before" == d.point ? v : v + 1, e), a.array.insert(p.fieldOptionsBackup, "before" == d.point ? v : v + 1, g))); a.isFunction(f.onMoveColumn) && f.onMoveColumn.call(c, d.source, d.target, d.point) } } } } }, Ja = function (c, d) { var e = a(c), f = e.treegrid("options"), e = e.treegrid("getChecked"); return a.array.contains(e, d, function (a) { return a[f.idField] == d }) }, ma = function (c, d) { var e = a(c), f = e.treegrid("options"), e = e.treegrid("getSelections"); return a.array.contains(e, d, function (a) { return a[f.idField] == d }) }, na = function (c) { c = a(c).treegrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row.datagrid-row-editing").map(function () { return a(this).attr("node-id") }); return a.array.distinct(a.array.clone(c)) }, oa = function (c, d) { var e = a(c), f = e.treegrid("find", d.id2), e = e.treegrid("getChildren", d.id1); return a.array.contains(e, f) }, O = function (c, d) { var e = a(c), f = e.treegrid("find", d.id1), e = e.treegrid("getChildren", d.id2); return a.array.contains(e, f) }, pa = function (c, d) { var e = a(c), f = e.treegrid("getParent", d.id1), e = e.treegrid("getParent", d.id2); return f && e && f == e }, Z = function (c, d) { var e = a(c), f = e.treegrid("options"), g = e.treegrid("getChildren", d); return a.array.filter(g, function (a) { return e.treegrid("getParent", a[f.idField])[f.idField] == d }) }, qa = function (c) { function d(a, c) { a.draggable("proxy").find("span.tree-dnd-icon").removeClass("tree-dnd-yes tree-dnd-no").addClass(c ? "tree-dnd-yes" : "tree-dnd-no") } var e = a(c), f = e.treegrid("options"); e.treegrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable({ disabled: !1, revert: !0, cursor: "default", deltaX: 10, deltaY: 5, proxy: function (c) { c = a(c).attr("node-id"); c = e.treegrid("getRowDom", c).clone(); var d = a("\x3ctr\x3e\x3c/tr\x3e").addClass("datagrid-row datagrid-row-selected"); a("\x3ctd\x3e\x3cspan class\x3d'tree-dnd-icon tree-dnd-no' \x3e\x3c/span\x3e\x3c/td\x3e").appendTo(d); 6 < c.find("td").each(function (a) { 6 > a && d.append(this) }).length && a("\x3ctd\x3e...\x3c/td\x3e").css("width", "40px").appendTo(d); return a("\x3ctable\x3e\x3c/table\x3e").addClass("tree-node-proxy").appendTo("body").append(d).hide() }, onBeforeDrag: function (d) { var h = a(this).attr("node-id"), g = e.treegrid("find", h); if (a.isFunction(f.onBeforeDrag) && 0 == f.onBeforeDrag.call(c, g) || 1 != d.which || "checkbox" == d.target.type) return !1; e.treegrid("getRowDom", { id: h, cascade: !0 }).droppable({ accept: "no-accept" }) }, onStartDrag: function () { var d = a(this), h = d.attr("node-id"), h = e.treegrid("find", h); d.draggable("proxy").css({ left: -1E4, top: -1E4 }); a.isFunction(f.onBeforeDrag) && f.onStartDrag.call(c, h) }, onStopDrag: function () { var d = a(this).attr("node-id"), h = e.treegrid("find", d); e.treegrid("getRowDom", { id: d, cascade: !0 }).droppable({ accept: "tr.datagrid-row" }); a.isFunction(f.onStopDrag) && f.onStopDrag.call(c, h) }, onDrag: function (c) { var d = c.pageX, e = c.pageY, f = c.data.startX, h = c.data.startY; 15 < Math.sqrt((d - f) * (d - f) + (e - h) * (e - h)) && a(this).draggable("proxy").show(); this.pageY = c.pageY } }).droppable({ accept: "tr.datagrid-row", onDragEnter: function (g, k) { var p = a(this), n = a(k), t = p.attr("node-id"), v = n.attr("node-id"), m = e.treegrid("find", t), z = e.treegrid("find", v), r = e.treegrid("getRowDom", t), J = r.find("td"), L = r.find("td[field\x3d" + f.treeField + "]"), u = p.data("dnd"), t = { droper: p, drager: n, droperId: t, dragerId: v, droperRow: m, dragerRow: z, droperRowDom: r, mark: J, treeFieldDom: L }; u ? a.extend(u, t) : p.data("dnd", t); a.isFunction(f.onDragEnter) && 0 == f.onDragEnter.call(c, m, z) && (d(n, !1), J.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"), L.removeClass("datagrid-header-cell-append")) }, onDragOver: function (g, k) { var p = a(this), n = p.data("dnd"), t = n.drager, v = n.droperId, m = n.dragerId, z = n.droperRow, r = n.dragerRow, J = n.mark, n = n.treeFieldDom; if (!p.droppable("options").disabled) { var L = k.pageY, u = p.offset().top, w = u + p.outerHeight(); d(t, !e.treegrid("isParent", { id1: m, id2: v })); J.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"); n.removeClass("datagrid-header-cell-append"); L > u + (w - u) / 2 ? 5 > w - L ? J.addClass("datagrid-header-cell-bottom") : n.addClass("datagrid-header-cell-append") : 5 > L - u ? J.addClass("datagrid-header-cell-top") : n.addClass("datagrid-header-cell-append"); 0 == f.onDragOver.call(c, z, r) && (d(t, !1), J.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"), n.removeClass("datagrid-header-cell-append"), p.droppable("disable")) } }, onDragLeave: function (e, g) { var q = a(this).data("dnd"), k = q.droperRow, p = q.dragerRow, n = q.mark, t = q.treeFieldDom; d(q.drager, !1); n.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"); t.removeClass("datagrid-header-cell-append"); a.isFunction(f.onDragLeave) && f.onDragLeave.call(c, k, p) }, onDrop: function (c, d) { var f = a(this).data("dnd"), h = f.droperId, g = f.dragerId, l = f.mark, f = f.treeFieldDom, k = f.hasClass("datagrid-header-cell-append") ? "append" : l.hasClass("datagrid-header-cell-top") ? "top" : "bottom"; e.treegrid("moveRow", { target: h, source: g, point: k }); l.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom"); f.removeClass("datagrid-header-cell-append") } }); f.dndRow = !0 }, ra = function (c, d) { var e = a(c), f = e.treegrid("getRoots"), g = e.treegrid("options"), f = f && f.length ? f : []; return d ? a.array.reduce(f, function (c, d, f) { c.push(d); (d = e.treegrid("getChildren", d[g.idField])) && d.length && a.array.merge(c, d); return c }, []) : f }, Ka = function (c, d) { d = a.isPlainObject(d) ? d : { field: d, cascade: !1 }; var e = d.field, f = d.cascade, f = a(c).treegrid("getRows", f); return a.array.map(f, function (a) { return a[e] }) }, sa = function (c, d) { d = a.isPlainObject(d) ? d : { id: d, cascade: !1 }; var e = d.id, f = d.cascade ? !0 : !1, g = a(c), k = g.treegrid("options"), p = g.treegrid("getPanel").find(".datagrid-view .datagrid-body tr.datagrid-row[node-id\x3d" + e + "]"); f && (e = g.treegrid("getChildren", e), a.each(e, function (a, d) { var e = sa(c, d[k.idField]); p = p.add(e) })); return p }, ta = function (c, d) { return a(c).treegrid("find", d) }, ea = function (c, d) { d = a.isPlainObject(d) ? d : { field: d, cascade: !1 }; var e = d.field, f = d.cascade, g = a(c), k = g.treegrid("getColumnFields", "all"); if (!a.array.contains(k, e)) return []; f = g.treegrid("getRows", f); f = a.array.clone(f); a.array.distinct(f, function (a, c) { return a[e] == c[e] }); return f }, ua = function (c, d) { d = a.isPlainObject(d) ? d : { field: d, cascade: !1 }; var e = d.field, f = d.cascade, g = a(c), k = g.treegrid("getColumnFields", "all"); if (!a.array.contains(k, e)) return []; e = g.treegrid("getColumnData", { field: e, cascade: f }); a.array.distinct(e, function (a, c) { return a == c }); return e }, La = a.fn.treegrid.methods.find, U = function (c, d, e) { c = e || a(c); if (!a.isFunction(d)) return La.call(c, c, d); c = c.treegrid("getRows", !0); return a.array.first(c, d) }, aa = function (c, d) { var e = a(c), f; a.isFunction(d) ? f = a.array.filter(e.treegrid("getRows", !0), d) : a.array.likeArray(d) && !a.util.isString(d) ? (f = a.array.map(d, function (a) { return U(c, a, e) }), f = a.array.filter(f, function (a) { return a != u && null != a })) : f = [U(c, d, e)]; return f }, fa = function (c, d, f, g, k, p) { f = f || a(c); g = g || f.treegrid("options"); var n = a.isFunction(d); c = n ? U(c, d, f) : null; d = n ? c ? c[g.idField] : null : a.isPlainObject(d) && g.idField in d ? d[g.idField] : d; if (null != d && d != u) { var t = f.treegrid("getRowDom", { id: d, cascade: !0 }); p = null == p || p == u || 1 == p ? !0 : !1; if (t.length) { var n = n ? c : f.treegrid("find", d), v = k || (g._extensionsTreegrid ? g._extensionsTreegrid : g._extensionsTreegrid = {}); v.filterData = a.isArray(v.filterData) ? v.filterData : v.filterData = []; t.show(); a.array.remove(v.filterData, n); k = f.treegrid("getChildren", d); a.each(k, function () { a.array.remove(v.filterData, this) }); p && e(f, g, v, rows) } } }, ga = function (c, d, f, g, k, p) { f = f || a(c); g = g || f.treegrid("options"); var n = a.isFunction(d), t = n ? U(c, d, f) : null; d = n ? t ? t[g.idField] : null : a.isPlainObject(d) && g.idField in d ? d[g.idField] : d; null != d && d != u && (c = f.treegrid("getRowDom", { id: d, cascade: !0 }), p = null == p || p == u || 1 == p ? !0 : !1, c.length && (n = n ? t : f.treegrid("find", d), k = k || (g._extensionsTreegrid ? g._extensionsTreegrid : g._extensionsTreegrid = {}), k.filterData = a.isArray(k.filterData) ? k.filterData : k.filterData = [], f.treegrid("unselectRow", { id: d, cascade: !0 }).treegrid("uncheckRow", { id: d, cascade: !0 }), c.hide(), a.array.unique(k.filterData, n, f.treegrid("getChildren", d)), p && e(f, g, k, rows))) }, Ma = function (c, f) { var g = a(c), k = g.treegrid("options"), p = g.treegrid("getRows", !0), n, t = k._extensionsTreegrid ? k._extensionsTreegrid : k._extensionsTreegrid = {}; if (!0 === f) { t.filterData = []; var p = g.treegrid("getPanel"), v = p.find("div.datagrid-header-filter-item-icon"); p.find(".datagrid-view .datagrid-body tr.datagrid-row").show(); H(v, "tree-checkbox1"); d(g, k) } else a.isFunction(f) ? (n = a.array.filter(p, f), n = a.array.map(n, function (a) { return a[k.idField] })) : n = a.array.likeArray(f) && !a.util.isString(f) ? f : [f]; n && (a.each(n, function (a, d) { fa(c, d, g, k, t, !1) }), e(g, k, t, g.treegrid("getRows"))) }, Na = function (c, f) { var g = a(c), k = g.treegrid("options"), p = g.treegrid("getRows", !0), n, t = k._extensionsTreegrid ? k._extensionsTreegrid : k._extensionsTreegrid = {}; if (!0 === f) { g.treegrid("unselectAll").treegrid("uncheckAll"); t.filterData = a.array.clone(p); var p = g.treegrid("getPanel"), v = p.find("div.datagrid-header-filter-item-icon"); p.find(".datagrid-view .datagrid-body tr.datagrid-row").hide(); H(v, "tree-checkbox0"); d(g, k) } else a.isFunction(f) ? (n = a.array.filter(p, f), n = a.array.map(n, function (a) { return a[k.idField] })) : n = a.array.likeArray(f) && !a.util.isString(f) ? f : [f]; n && (a.each(n, function (a, d) { ga(c, d, g, k, t, !1) }), e(g, k, t, g.treegrid("getRows"))) }, va = function (c, d) { var e = a(c), f = e.treegrid("options"), f = f._extensionsTreegrid ? f._extensionsTreegrid : f._extensionsTreegrid = {}; if (d) return f.filterData; var g = e.treegrid("getRoots"); return a.array.filter(f.filterData, function (c) { return a.array.contains(g, c) }) }, wa = function (c, d) { var e = a(c), f = e.treegrid("options"), e = e.treegrid("getRows", d), g = f._extensionsTreegrid ? f._extensionsTreegrid : f._extensionsTreegrid = {}; return a.array.filter(e, function (c) { return a.array.contains(g.filterData, c) ? !1 : !0 }) }, Oa = a.fn.treegrid.methods.remove, xa = function (c, d) { var e = a(c); a.isFunction(d) || e.treegrid("remove", d); var f = e.treegrid("getRows", !0), g = e.treegrid("options"), f = a.array.first(f, d); e.treegrid("remove", f ? f[g.idField] : null) }, Pa = function (c, d) { if (a.array.likeArray(d) && !a.util.isString(d)) a.each(d, function (a, d) { xa(c, d) }); else if (a.isFunction(d)) { var e = a(c), f = e.treegrid("options"), g = e.treegrid("getRows", !0); a.array.filter(g, d); a.each(function () { var a = U(c, this[f.idField], e); null != a && a != u && e.treegrid("remove", this[f.idField]) }) } }, ya = a.fn.treegrid.methods.select, za = a.fn.treegrid.methods.unselect, Aa = function (c, d) { d = a.isPlainObject(d) ? d : { id: d, cascade: !1 }; var e = d.id, f = d.cascade ? !0 : !1, g = a(c); ya.call(g, g, e); if (f) { var k = g.treegrid("options"); a.each(g.treegrid("getChildren", e), function () { ya.call(g, g, this[k.idField]) }) } }, Ba = function (c, d) { d = a.isPlainObject(d) ? d : { id: d, cascade: !1 }; var e = d.id, f = d.cascade ? !0 : !1, g = a(c); za.call(g, g, e); if (f) { var k = g.treegrid("options"); a.each(g.treegrid("getChildren", e), function () { za.call(g, g, this[k.idField]) }) } }, da = function (c, d) { d = a.isPlainObject(d) ? d : { id: d, cascade: !1 }; var e = d.id, f = d.cascade ? !0 : !1, g = a(c); g.datagrid("checkRow", e); if (f) { var k = g.treegrid("options"); a.each(g.treegrid("getChildren", e), function () { g.datagrid("checkRow", this[k.idField]) }) } }, V = function (c, d) { d = a.isPlainObject(d) ? d : { id: d, cascade: !1 }; var e = d.id, f = d.cascade ? !0 : !1, g = a(c); g.datagrid("uncheckRow", e); if (f) { var k = g.treegrid("options"); a.each(g.treegrid("getChildren", e), function () { g.datagrid("uncheckRow", this[k.idField]) }) } }, Qa = function (c, d) { var e = a(c), f = e.treegrid("options"), g = f._extensionsTreegrid ? f._extensionsTreegrid : f._extensionsTreegrid = {}, k = e.treegrid("getPanel"); if (d) f.columnFilter = d, w(e, f, g), a.util.exec(function () { k.find("div.datagrid-view div.datagrid-header tr.datagrid-header-row div.datagrid-header-filter-container").hide().slideDown("slow") }); else { var g = k.find("div.datagrid-view div.datagrid-header tr.datagrid-header-row div.datagrid-header-filter-container"), p = g.length, n = 0; g.slideUp("slow", function () { ++n == p && (A(e, f), f.columnFilter = d) }) } }, X = function (c, d) { var e = a(c); if (a.util.isBoolean(d)) e.treegrid(d ? "showRows" : "hideRows", !0); else if (d && d.field) { var f = d.field, g = d.value, k = a.array.likeArray(g) && !a.util.isString(g) ? function (c) { return a.array.contains(g, c[f]) } : function (a) { return g == a[f] }, k = e.treegrid("findRows", k); e.treegrid(d.selected ? "showRows" : "hideRows", k) } }, Ra = function (c, d) { var e = a(c), f = e.treegrid("getPanel"), g = e.treegrid("options").treeField, k = d; a.isPlainObject(d) ? (k = d.value, e = d.field, f = f.find("div.datagrid-body tr.datagrid-row td[" + (e ? "field\x3d" + e : "field") + "] div.datagrid-cell")) : f = f.find("div.datagrid-body tr.datagrid-row td[field] div.datagrid-cell"); f.each(function () { var c = a(this); c.parent().attr("field") == g && (c = c.find("span.tree-title")); c.find("span.datagrid-cell-hightlight").replaceWith(function () { return a(this).text() }); if (k) { var d = c.html(); d && c.html(a.string.replaceAll(d, k, "\x3cspan class\x3d'datagrid-cell-hightlight'\x3e" + k + "\x3c/span\x3e")) } }) }, R = a.fn.treegrid.extensions.initRowDndExtensions = function (a, c) { c = c || a.treegrid("options"); c.dndRow && a.treegrid("enableRowDnd") }, Sa = a.fn.treegrid.extensions.parseRowContextMenuMap = function (c, d, e, f, g) { return a.array.map(f, function (f, k) { if (!f || a.util.isString(f)) return f; var p = a.extend({}, f); p.id = a.isFunction(f.id) ? f.id.call(p, c, d, e, g) : f.id; p.text = a.isFunction(f.text) ? f.text.call(p, c, d, e, g) : f.text; p.iconCls = a.isFunction(f.iconCls) ? f.iconCls.call(p, c, d, e, g) : f.iconCls; p.disabled = a.isFunction(f.disabled) ? f.disabled.call(p, c, d, e, g) : f.disabled; p.hideOnClick = a.isFunction(f.hideOnClick) ? f.hideOnClick.call(p, c, d, e, g) : f.hideOnClick; p.onclick = a.isFunction(f.onclick) ? function (a, c, l) { f.onclick.call(this, a, d, e, g, c, l) } : f.onclick; p.handler = a.isFunction(f.handler) ? function (a, c, l) { f.handler.call(this, a, d, e, g, c, l) } : f.handler; p.children && p.children.length && (p.children = Sa(c, d, e, p.children, g)); return p }) }, ha = a.fn.treegrid.extensions.initTreeGridExtensions = function (c, d, e) { d = d || c.treegrid("options"); e = e || (d._extensionsTreegrid ? d._extensionsTreegrid : d._extensionsTreegrid = {}); e.onClickRowBak = d.onClickRow; d.onClickRow = function (f) { a.isFunction(e.onClickRowBak) && e.onClickRowBak.apply(this, arguments); d.toggleOnClick && c.treegrid("toggle", f[d.idField]) }; e.onCheckBak = d.onCheck; d.onCheck = function (f) { a.isFunction(e.onCheckBak) && e.onCheckBak.apply(this, arguments); if (d.cascadeCheck && (!d.checkOnSelect || !d.singleSelect)) { for (var g = d.idField, k = f[g], p, n, t = c.treegrid("getParent", k) ; t;) p = c.treegrid("getChildren", t[g]), n = c.treegrid("getChecked"), a.array.some(p, function (c) { return !a.array.contains(n, c) }) || c.treegrid("isChecked", t[g]) || c.treegrid("check", t[g]), t = c.treegrid("getParent", t[g]); a.each(c.treegrid("getChildren", k), function (a, d) { c.treegrid("isChecked", d[g]) || c.treegrid("check", d[g]) }) } }; e.onUncheckBak = d.onUncheck; d.onUncheck = function (f) { a.isFunction(e.onUncheckBak) && e.onUncheckBak.apply(this, arguments); if (d.cascadeCheck && (!d.checkOnSelect || !d.singleSelect)) { for (var g = d.idField, k = f[g], p, n, t = c.treegrid("getParent", k) ; t;) p = c.treegrid("getChildren", t[g]), n = c.treegrid("getChecked"), a.array.some(p, function (c) { return a.array.contains(n, c) }) || c.treegrid("isChecked", t[g]) && c.treegrid("uncheck", t[g]), t = c.treegrid("getParent", t[g]); a.each(c.treegrid("getChildren", k), function (a, d) { c.treegrid("uncheck", d[g]) }) } } }, Ca = function (c, d) { c.treegrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").each(function () { var e = a(this), f = e.attr("node-id"), g = c.treegrid("find", f); Y(c, d, f, g, e) }) }, Y = function (c, d, e, f, g) { function k(d) { d = c.treegrid("getColumns", "all"); var f = a("\x3ctable\x3e\x3c/table\x3e").css({ padding: "5px" }); a.each(d, function (a, d) { if (d && d.field && d.title) { var g = c.treegrid("getCellDisplay", { field: d.field, id: e }); f.append("\x3ctr\x3e\x3ctd style\x3d'text-align: right; width: 150px;'\x3e" + d.title + ":\x3c/td\x3e\x3ctd style\x3d'width: 250px;'\x3e" + g + "\x3c/td\x3e\x3c/tr\x3e") } }); return f } g = g || c.treegrid("getRowDom", e); if (d.rowTooltip) { var p = function (c) { c = a(this); var e = a.isFunction(d.rowTooltip) ? d.rowTooltip.call(c, f) : k(f); c.tooltip("update", e) }; g.each(function () { a.easyui.tooltip.init(this, { onShow: p }) }) } else g.children("td[field]").each(function () { var d = a(this), g = d.attr("field"), h = c.treegrid("getColumnOption", g); if (h && h.tooltip) { var k = d.find("div.datagrid-cell"); a.easyui.tooltip.init(k, { onShow: function (c) { c = a(this); var d = a.isFunction(h.tooltip) ? h.tooltip.call(k, f[g], e, f) : f[g]; c.tooltip("update", d) } }) } }) }, Da = function (c, d, e) { if (d.extEditing) { var f = c.treegrid("getRowDom", e); if (f.length) { var g = c.treegrid("getPanel").find("div.datagrid-view"), k = g.find("div.datagrid-view1"), p = g.find("div.datagrid-view2"), n = p.find("div.datagrid-body"), k = k.outerWidth(); g.position(); n.css("position", "relative"); g = f.outerHeight(); f = f.position().top + g + n.scrollTop() - p.find("div.datagrid-header").outerHeight(); n = a("\x3cdiv\x3e\x3c/div\x3e").addClass("dialog-button datagrid-rowediting-panel").appendTo(n).css({ position: "absolute", display: "block", border: "1px solid #ddd", top: f, padding: "5px 5px" }).attr("node-id", e); a("\x3ca\x3e\x3c/a\x3e").linkbutton({ plain: !1, iconCls: "icon-ok", text: "\u4fdd\u5b58" }).appendTo(n).click(function () { c.treegrid("endEdit", e); ba(c, d, e) }); a("\x3ca\x3e\x3c/a\x3e").linkbutton({ plain: !1, iconCls: "icon-cancel", text: "\u53d6\u6d88" }).appendTo(n).click(function () { c.treegrid("cancelEdit", e); ba(c, d, e) }); k = (d.width - n.outerWidth()) / 2 - k; n.css("left", 0 < k ? k : 0) } } }, ba = function (a, c, d) { c.extEditing && (c = (c = body = a.treegrid("getPanel").find("div.datagrid-view div.datagrid-view2 div.datagrid-body")) || a.treegrid("getPanel").find("div.datagrid-view div.datagrid-view2 div.datagrid-body"), c.find("div.datagrid-rowediting-panel[node-id\x3d" + d + "]").remove()) }, Ea = a.fn.treegrid.extensions.initExtensions = function (c, d) { var e = d._extensionsTreegrid ? d._extensionsTreegrid : d._extensionsTreegrid = {}; if (!e._initialized) { var f = c.treegrid("getColumnFields", !1); e.fields = a.array.filter(f, function (a) { return c.treegrid("getColumnOption", a).title ? !0 : !1 }); e.fieldOptions = a.array.map(e.fields, function (a) { return c.treegrid("getColumnOption", a) }); e.fieldOptionsBackup = a.array.map(e.fieldOptions, function (c) { return a.extend({}, c) }); e.filterData = []; a.fn.datagrid.extensions.initColumnExtendProperties(c, e); c.treegrid("setOffset", d.offset); D(c, d, e); y(c, d, e); F(c, d, e); k(c, d, e); p(c, d, e); t(c, d, e); ha(c, d, e); (f = c.datagrid("getRows")) && f.length || w(c, d, e); e._initialized = !0 } }, ia = a.fn.treegrid.extensions.loader = function (c, d, e) { var f = a(this), g = f.treegrid("options"); Ea(f, g); if (!g.url) return !1; c = a.fn.datagrid.extensions.parsePagingQueryParams(g, c); a.ajax({ type: g.method, url: g.url, data: c, dataType: "json", success: function (a) { d(a) }, error: function () { e.apply(this, arguments) } }) }, ja = a.fn.treegrid.defaults.onLoadSuccess, Ta = a.fn.treegrid.extensions.onLoadSuccess = function (c) { a.isFunction(ja) && ja.apply(this, arguments); var d = a(this), e = d.treegrid("options"), f = e._extensionsTreegrid ? e._extensionsTreegrid : e._extensionsTreegrid = {}; w(d, e, f); R(d, e); Ca(d, e) }, ka = a.fn.treegrid.defaults.onResizeColumn, Ua = a.fn.treegrid.extensions.onResizeColumn = function (c, d) { a.isFunction(ka) && ka.apply(this, arguments); var e = a(this); if (e.treegrid("options").columnFilter) { var f = e.treegrid("getPanel"), e = e.treegrid("getColumnOption", c); f.find("div.datagrid-header-filter-container[field\x3d" + c + "]").width(e.width) } }, P = a.fn.treegrid.defaults.onBeforeEdit, Va = a.fn.treegrid.extensions.onBeforeEdit = function (c) { a.isFunction(P) && P.apply(this, arguments); var d = a(this), e = d.datagrid("options"); Da(d, e, c[e.idField]); var f = e, e = c[e.idField], g = f._extensionsTreegrid ? f._extensionsTreegrid : f._extensionsTreegrid = {}; f.singleEditing && d.treegrid("endEdit", g.lastEditingId); g.lastEditingId = e; d.treegrid("getPanel").find("div.datagrid-view div.datagrid-body table.datagrid-btable tr.datagrid-row").draggable("disable") }, Fa = a.fn.treegrid.defaults.onAfterEdit, Wa = a.fn.treegrid.extensions.onAfterEdit = function (c, d) { a.isFunction(Fa) && Fa.apply(this, arguments); var e = a(this), f = e.treegrid("options"), g = f._extensionsTreegrid ? f._extensionsTreegrid : f._extensionsTreegrid = {}; ba(e, f, c[f.idField]); w(e, f, g); R(e, f); Y(e, f, c[f.idField], c) }, Ga = a.fn.treegrid.defaults.onCancelEdit, Xa = a.fn.treegrid.extensions.onCancelEdit = function (c) { a.isFunction(Ga) && Ga.apply(this, arguments); var d = a(this), e = d.treegrid("options"); ba(d, e, c[e.idField]); R(d, e); Y(d, e, c[e.idField], c) }, W = a.fn.treegrid.defaults.loadFilter, E = a.fn.treegrid.extensions.loadFilter = function (c, d) { a.isFunction(W) && (c = W.apply(this, arguments)); var e = a.array.likeArray(c) && !a.util.isString(c), f = e ? c : c.rows; if (!f.length) return c; var g = a(this).treegrid("options"), f = g.dataPlain ? a.fn.tree.extensions.dataPlainConverter(f, g) : f; return null != d && d != u ? e ? f : { total: f.length, rows: f } : e ? f : { total: c.length || f.length, rows: f } }, N = a.fn.treegrid.defaults.onExpand, Q = a.fn.treegrid.extensions.onExpand = function (c) { a.isFunction(N) && N.apply(this, arguments); var d = a(this), e = d.treegrid("options"); if (e.onlyNodeExpand) { var f = d.treegrid("getNears", c[e.idField]), g = e.animate; e.animate = !1; a.each(a.array.filter(f, function (a) { return a[e.idField] != c[e.idField] && "open" == a.state }), function () { d.treegrid("collapse", this[e.idField]) }); e.animate = g } }, S = a.fn.treegrid.extensions.methods = { update: function (c, d) { return c.each(function () { if (d && d.id != u && d.row) { var c = a(this), e = c.treegrid("options"); a.isFunction(e.onBeforeUpdate) && 0 == e.onBeforeUpdate.call(this, d.id, d.row) || (J.call(c, c, d), w(c, e), R(c, e), Y(c, e, d.id, d.row), a.isFunction(e.onUpdate) && e.onUpdate.call(this, d.id, d.row)) } }) }, append: function (a, c) { return a.each(function () { Ha(this, c) }) }, insert: function (c, d) { return c.each(function () { if (d && d.data && (d.before || d.after)) { var c = a(this), e = c.treegrid("options"); a.isFunction(e.onBeforeInsert) && 0 == e.onBeforeInsert.call(this, d.before, d.after, d.data) || (ca.call(c, c, d), w(c, e), R(c, e), Y(c, e, d.data[e.idField], d.data), la(c, e, d.data[e.idField], e.treeField), a.isFunction(e.onInsert) && e.onInsert.call(this, d.before, d.after, d.data)) } }) }, isChecked: function (a, c) { return Ja(a[0], c) }, isSelected: function (a, c) { return ma(a[0], c) }, isEditing: function (c, d) { return a(c[0]).treegrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row[node-id\x3d" + d + "]").hasClass("datagrid-row-editing") }, getEditingNodeId: function (a) { a = na(a[0]); return a.length ? a[0] : u }, getEditingNodeIds: function (a) { return na(a[0]) }, isRoot: function (c, d) { var e = a(c[0]), f = e.treegrid("getRoots"); return (e = e.treegrid("find", d)) && a.array.contains(f, e) }, getLevel: function (c, d) { var e; e = (e = a(c[0]).treegrid("getRowDom", d)) && e.length ? e.eq(0).parentsUntil("div.datagrid-body", "tr.treegrid-tr-tree").length + 1 : 0; return e }, freezeColumn: function (c, d) { return c.each(function () { var c = a(this), e = c.treegrid("getColumnFields"), f = c.treegrid("getColumnFields", !0); f && f.length && a.array.contains(e, d) && !a.array.contains(f, d) && c.treegrid("moveColumn", { source: d, target: f[f.length - 1], point: "after" }) }) }, unfreezeColumn: function (c, d) { return c.each(function () { var c = a(this), e = c.treegrid("getColumnFields"), f = c.treegrid("getColumnFields", !0); e && e.length && !a.array.contains(e, d) && a.array.contains(f, d) && c.treegrid("moveColumn", { source: d, target: e[0], point: "before" }) }) }, moveColumn: function (a, c) { return a.each(function () { Ia(this, c) }) }, shiftColumn: function (c, d) { return c.each(function () { var c = this; if (d && d.field && d.point) { a.array.contains(["before", "after"], d.point) || (d.point = "before"); var e = a(c), c = e.treegrid("getColumnFields", "all"), f = a.array.indexOf(c, d.field); -1 == f || "before" == d.point && 0 == f || "after" == d.point && f == c.length - 1 || (c = c["before" == d.point ? f - 1 : f + 1], e.treegrid("moveColumn", { source: d.field, target: c, point: d.point })) } }) }, deleteColumn: function (c, d) { return c.each(function () { var c = a(this), e = c.treegrid("options"), f = e._extensionsTreegrid ? e._extensionsTreegrid : e._extensionsTreegrid = {}; a.isFunction(e.onBeforeDeleteColumn) && 0 == e.onBeforeDeleteColumn.call(this, d) || (a.fn.datagrid.extensions.removeField(e, d, f), c.treegrid("getColumnDom", { field: d, header: !0 }).remove(), a.isFunction(e.onDeleteColumn) && e.onDeleteColumn.call(this, d)) }) }, popColumn: function (c, d) { var e = param, f = a(c[0]), g = f.treegrid("getColumnOption", e); g && f.treegrid("deleteColumn", e); return g }, moveRow: function (c, d) { return c.each(function () { if (d && d.source && d.target && d.point) { a.array.contains(["append", "top", "bottom"], d.point) || (d.point = "append"); var c = a(this), e = c.treegrid("options"), f = c.treegrid("find", d.source), g = c.treegrid("find", d.target); if (f && g && f != g && !(a.isFunction(e.onBeforeDrop) && 0 == e.onBeforeDrop.call(this, g, f, d.point) || c.treegrid("isParent", { id1: d.source, id2: d.target }))) { var k = c.treegrid("pop", d.source); switch (d.point) { case "append": c.treegrid("append", { parent: d.target, data: [k] }); break; case "top": c.treegrid("insert", { before: d.target, data: k }); break; case "bottom": c.treegrid("insert", { after: d.target, data: k }); break; default: c.treegrid("append", { parent: d.target, data: [k] }) } k && a.isFunction(e.onDrop) && e.onDrop.call(this, g, f, d.point) } } }) }, shiftRow: function (c, d) { return c.each(function () { if (d && d.id && d.point && a.array.contains(["up", "upLevel", "down", "downLevel"], d.point)) { var c = a(this), e = c.treegrid("options"), f; switch (d.point) { case "up": f = c.treegrid("prevRow", d.id); break; case "upLevel": f = c.treegrid("getParent", d.id); break; case "down": f = c.treegrid("nextRow", d.id); break; case "downLevel": f = c.treegrid("prevRow", d.id) } f && c.treegrid("moveRow", { target: f[e.idField], source: d.id, point: "up" == d.point ? "top" : "downLevel" == d.point ? "append" : "bottom" }) } }) }, compare: function (a, c) { var d = a[0]; return O(d, c) ? "child" : oa(d, c) ? "parent" : pa(d, c) ? "sibling" : "normal" }, isChild: function (a, c) { return O(a[0], c) }, isParent: function (a, c) { return oa(a[0], c) }, isSibling: function (a, c) { return pa(a[0], c) }, nextRow: function (c, d) { var e; e = a(c[0]); var f = e.treegrid("getRowDom", d).nextAll("tr.datagrid-row:first"), g = f.attr("node-id"); e = f.length && g ? e.treegrid("find", g) : null; return e }, prevRow: function (c, d) { var e; e = a(c[0]); var f = e.treegrid("getRowDom", d).prevAll("tr.datagrid-row:first"), g = f.attr("node-id"); e = f.length && g ? e.treegrid("find", g) : null; return e }, getNears: function (c, d) { var e; e = a(c[0]); var f = e.treegrid("options"); if (e.treegrid("isRoot", d)) e = e.treegrid("getRoots"); else { var g = e.treegrid("getParent", d); e = g ? e.treegrid("getNearChildren", g[f.idField]) : e.treegrid("getRoots") } return e }, getNearChildren: function (a, c) { return Z(a[0], c) }, enableRowDnd: function (a) { return a.each(function () { qa(this) }) }, disableRowDnd: function (c) { return c.each(function () { var c = a(this), d = c.treegrid("options"); c.treegrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable("disable"); d.dndRow = !1 }) }, getRows: function (a, c) { return ra(a[0], c) }, getColumnData: function (a, c) { return Ka(a[0], c) }, getRowDom: function (a, c) { return sa(a[0], c) }, getRowData: function (a, c) { return ta(a[0], c) }, getNode: function (a, c) { return ta(a[0], c) }, getNodes: function (a, c) { return aa(a[0], c) }, getCellDom: function (c, d) { var e; e = c[0]; e = d && d.field && null != d.id && d.id != u ? a(e).treegrid("getRowDom", d.id).find("td[field\x3d" + d.field + "] .datagrid-cell") : a(); return e }, getCellData: function (c, d) { var e; e = d && d.field && null != d.id && d.id != u ? a(c[0]).treegrid("find", d.id)[d.field] : u; return e }, getCellDisplay: function (c, d) { var e = a(c[0]).treegrid("getCellDom", d); return e && e.length ? e.text() : u }, getDistinctRows: function (a, c) { return ea(a[0], c) }, getDistinctColumnData: function (a, c) { return ua(a[0], c) }, showRow: function (a, c) { return a.each(function () { fa(this, c) }) }, hideRow: function (a, c) { return a.each(function () { ga(this, c) }) }, showRows: function (a, c) { return a.each(function () { Ma(this, c) }) }, hideRows: function (a, c) { return a.each(function () { Na(this, c) }) }, getHiddenRows: function (a, c) { return va(a[0], c) }, getVisibleRows: function (a, c) { return wa(a[0], c) }, livesearch: function (a, c) { return a.each(function () { Ra(this, c) }) }, find: function (a, c) { return U(a[0], c) }, findRow: function (a, c) { return U(a[0], c) }, findRows: function (a, c) { return aa(a[0], c) }, remove: function (c, d) { return c.each(function () { var c = a(this), e = c.treegrid("options"), f = c.treegrid("find", d); f && a.isFunction(e.onBeforeRemove) && 0 != e.onBeforeRemove.call(this, f) && (Oa.call(c, c, d), w(c, e), a.isFunction(e.onRemove) && e.onRemove.call(this, f)) }) }, deleteRow: function (a, c) { return a.each(function () { xa(this, c) }) }, deleteRows: function (a, c) { return a.each(function () { Pa(this, c) }) }, setColumnTitle: function (c, d) { return c.each(function () { if (d && d.field && d.title) { var c = a(this); c.treegrid("getColumnOption", d.field).title = d.title; c.datagrid("setColumnTitle", d) } }) }, select: function (a, c) { return a.each(function () { Aa(this, c) }) }, unselect: function (a, c) { return a.each(function () { Ba(this, c) }) }, selectRow: function (a, c) { return a.each(function () { Aa(this, c) }) }, unselectRow: function (a, c) { return a.each(function () { Ba(this, c) }) }, check: function (a, c) { return a.each(function () { da(this, c) }) }, uncheck: function (a, c) { return a.each(function () { V(this, c) }) }, checkRow: function (a, c) { return a.each(function () { da(this, c) }) }, uncheckRow: function (a, c) { return a.each(function () { V(this, c) }) }, setColumnFilter: function (a, c) { return a.each(function () { Qa(this, c) }) }, columnFilterSelect: function (a, c) { return a.each(function () { X(this, c) }) }, setOffset: function (c, d) { return c.each(function () { var c = a(this), e = c.treegrid("options"), f = e._extensionsTreegrid ? e._extensionsTreegrid : e._extensionsTreegrid = {}; e.offset = f.offset = a.fn.datagrid.extensions.parseOffset(d); c.datagrid("setOffset", e.offset) }) }, exportExcel: function (c, d) { return c.each(function () { var c = d, c = a.string.toBoolean(c); alert("\u5bfc\u51fa" + (c ? "\u5168\u90e8" : "\u5f53\u524d\u9875") + "\u6570\u636e") }) } }, ia = a.fn.treegrid.extensions.defaults = { offset: null, dataPlain: !1, parentField: "pid", toggleOnClick: !1, onlyNodeExpand: !1, cascadeCheck: !1, loadFilter: E, onExpand: Q, autoBindDblClickRow: !0, dblClickRowMenuIndex: 0, exportMenu: !1, selectOnRowContextMenu: !1, hideDisabledMenu: !1, headerContextMenu: null, rowContextMenu: null, enableHeaderClickMenu: !0, enableHeaderContextMenu: !0, enableRowContextMenu: !0, toggleMenu: !0, moveMenu: !1, pagingMenu: !1, refreshMenu: !0, dndRow: !1, rowTooltip: !1, extEditing: !0, autoEditing: !1, autoEditingEvent: "onDblClickRow", finishEditOnBlur: !0, finishEditLocale: window.document, finishEditMethod: "endEdit", singleEditing: !0, columnFilter: null, showFilterText: u, loader: ia, onLoadSuccess: Ta, onResizeColumn: Ua, onBeforeEdit: Va, onAfterEdit: Wa, onCancelEdit: Xa, onBeforeDeleteColumn: function (a) { }, onDeleteColumn: function (a) { }, onBeforeMoveColumn: function (a, c, d) { }, onMoveColumn: function (a, c, d) { }, onBeforeDrop: function (a, c, d) { }, onDrop: function (a, c, d) { }, onBeforeDrag: function (a) { }, onStartDrag: function (a) { }, onStopDrag: function (a) { }, onDragEnter: function (a, c) { }, onDragOver: function (a, c) { }, onDragLeave: function (a, c) { }, onBeforeUpdate: function (a, c) { }, onUpdate: function (a, c) { }, onBeforeAppend: function (a, c) { }, onAppend: function (a, c) { }, onBeforeInsert: function (a, c, d) { }, onInsert: function (a, c, d) { }, onBeforeRemove: function (a) { }, onRemove: function (a) { } }; a.extend(a.fn.treegrid.defaults, ia); a.extend(a.fn.treegrid.methods, S); a.extend(a.fn.treegrid.defaults.view, { onBeforeRender: function (c, d, e) { function f(a, c) { for (var d = 0; d < a.length; d++) { var e = a[d]; e._parentId = c; e.children && e.children.length && f(e.children, e[k.idField]) } } a.isArray(d) && (e = { total: d.length, rows: d }, d = null); if (!e) return !1; var g = a.data(c, "treegrid"), k = g.options; e.length == u && (e.footer && (g.footer = e.footer), e.total && (g.total = e.total), e = this.transfer(c, d, e.rows)); f(e.length == u ? e.rows : e, d); var p = U(c, d); p ? p.children = p.children ? p.children.concat(e) : e : g.data = g.data.concat(e); k.remoteSort || this.sort(c, e); this.treeNodes = e; this.treeLevel = a(c).treegrid("getLevel", d) } }) })(jQuery); (function (a, u) { function w(c, d) { var e = a(c); d = a(d)[0]; return a.array.contains(e.tree("getRoots"), d, function (a, c) { return a.target == c }) } function A(c, d) { var e = a(c), f = a(d.target1)[0], g = a(d.target2)[0], e = e.tree("getChildren", g); return a.array.some(e, function (a) { return a.target == f }) } function r(c, d) { var e = a(c), f = a(d.target1)[0], g = a(d.target2)[0], e = e.tree("getChildren", f); return a.array.some(e, function (a) { return a.target == g }) } function m(c, d) { var e = a(c), f = a(d.target1)[0], g = a(d.target2)[0], f = e.tree("getParent", f), e = e.tree("getParent", g); return f.target == e.target } function g(c, d) { var e = a(c); d = a(d); return a.contains(e[0], d[0]) && d.is("div.tree-node") ? d.closest("ul").find("li\x3ediv.tree-node").map(function () { return e.tree("getNode", this) }) : null } function c(c, d) { var e = a(c); d = a(d); return a.contains(e[0], d[0]) && d.is("div.tree-node") ? d.siblings("ul").find("li\x3ediv.tree-node").map(function () { return e.tree("getNode", this) }) : null } function e(c, d) { var f = a(c); if (!d) return f.tree("reload"); if ("string" == typeof d) return f.tree("options").url = d, e(c, {}); var g = f.tree("options"); g.queryParams = a.extend({}, g.queryParams, d); f.tree("reload") } function d(c, d, e) { e.onClickBak = d.onClick; d.onClick = function (f) { a.isFunction(e.onClickBak) && e.onClickBak.apply(this, arguments); d.toggleOnClick && c.tree("toggle", f.target) } } function f(c, d, e) { e.onContextMenuBak = d.onContextMenu; d.onContextMenu = function (f, g) { a.isFunction(e.onContextMenuBak) && e.onContextMenuBak.apply(this, arguments); d.selectOnContextMenu && c.tree("select", g.target); if (d.enableContextMenu) { f.preventDefault(); var n = D(c, d, f, g); d.autoBindDblClick && 0 <= d.dblClickMenuIndex && a.util.likeArray(d.contextMenu) && !a.util.isString(d.contextMenu) && d.contextMenu.length > d.dblClickMenuIndex && (n[d.dblClickMenuIndex].bold = !0); a.easyui.showMenu({ items: n, left: f.pageX, top: f.pageY }) } } } function H(c, d, e) { a.array.likeArray(d.contextMenu) && !a.util.isString(d.contextMenu) && d.contextMenu.length && d.autoBindDblClick && (d.onDblClickBak = d.onDblClick, d.onDblClick = function (f) { a.isFunction(e.onDblClickBak) && e.onDblClickBak.apply(this, arguments); var g = D(c, d, null, f); 0 <= d.dblClickMenuIndex && g.length > d.dblClickMenuIndex && (g = g[d.dblClickMenuIndex], (g.handler || g || onclick)(null, f, c, g, null)) }) } function D(c, d, e, f) { var g = d.toggleMenu, n = d.moveMenu; "object" == typeof g && (g = a.extend({}, { expand: !0, expandAll: !0, collapse: !0, collapseAll: !0, submenu: !1 }, g)); "object" == typeof n && (n = a.extend({}, { up: !1, upLevel: !1, down: !1, downLevel: !1, submenu: !1 }, n)); n = []; g = [{ text: "\u5c55\u5f00\u5f53\u524d\u6240\u6709", iconCls: "icon-metro-expand", disabled: !(1 == g || 1 == g.expandAll), handler: function () { c.tree("expandAll", f.target) } }, { text: "\u5c55\u5f00\u5f53\u524d", iconCls: "icon-metro-expand2", disabled: !(1 == g || 1 == g.expand), handler: function () { c.tree("expand", f.target) } }, { text: "\u6298\u53e0\u5f53\u524d", iconCls: "icon-metro-contract2", disabled: !(1 == g || 1 == g.collapse), handler: function () { c.tree("collapse", f.target) } }, { text: "\u6298\u53e0\u5f53\u524d\u6240\u6709", iconCls: "icon-metro-contract", disabled: !(1 == g || 1 == g.collapseAll), handler: function () { c.tree("collapseAll", f.target) } }]; c.tree("isRoot", f.target) && a.array.insertRange(g, 0, [{ text: "\u5c55\u5f00\u6240\u6709", iconCls: "icon-standard-arrow-out", handler: function () { c.tree("expandAll") } }, { text: "\u6298\u53e0\u6240\u6709", iconCls: "icon-standard-arrow-in", handler: function () { c.tree("collapseAll") } }, "-"]); a.array.likeArray(d.contextMenu) && a.array.merge(n, d.contextMenu, "-"); return y(e, f, n, c) } function y(c, d, e, f) { return a.array.map(e, function (e) { if (!e || a.util.isString(e)) return e; var g = a.extend({}, e); g.id = a.isFunction(e.id) ? e.id.call(g, c, d, f) : e.id; g.text = a.isFunction(e.text) ? e.text.call(g, c, d, f) : e.text; g.iconCls = a.isFunction(e.iconCls) ? e.iconCls.call(g, c, d, f) : e.iconCls; g.disabled = a.isFunction(e.disabled) ? e.disabled.call(g, c, d, f) : e.disabled; g.hideOnClick = a.isFunction(e.hideOnClick) ? e.hideOnClick.call(g, c, d, f) : e.hideOnClick; g.onclick = a.isFunction(e.onclick) ? function (a, c, g) { e.onclick.call(this, a, d, f, c, g) } : e.onclick; g.handler = a.isFunction(e.handler) ? function (a, c, g) { e.handler.call(this, a, d, f, c, g) } : e.handler; g.children && g.children.length && (g.children = y(c, d, g.children, f)); return g }) } a.fn.tree.extensions = {}; var F = a.fn.tree.extensions.initExtensions = function (a, c) { var e = c._extensions ? c._extensions : c._extensions = {}; e._initialized || (d(a, c, e), f(a, c, e), H(a, c, e), e._initialized = !0) }, G = a.fn.tree.extensions.parseQueryParams = function (c, d) { var e = a.extend({}, d, c.queryParams); return a.util.parseMapFunction(e) }, I = a.fn.tree.extensions.loader = function (c, d, e) { var f = a(this), g = f.tree("options"); F(f, g); if (!g.url) return !1; c = G(g, c); a.ajax({ type: g.method, url: g.url, data: c, dataType: "json", success: function (a) { d(a) }, error: function () { e.apply(this, arguments) } }) }, C = a.fn.tree.defaults.onExpand, M = a.fn.tree.extensions.onExpand = function (c) { a.isFunction(C) && C.apply(this, arguments); var d = a(this), e = d.tree("options"); if (e.onlyNodeExpand) { var f = d.tree("getNears", c.target), g = e.animate; e.animate = !1; a.each(a.array.filter(f, function (a) { return a.target != c.target && "open" == a.state }), function () { d.tree("collapse", this.target) }); e.animate = g } }, z = a.fn.tree.defaults.loadFilter, n = a.fn.tree.extensions.loadFilter = function (c, d) { a.isFunction(z) && (c = z.apply(this, arguments)); c = a.array.likeArray(c) && !a.util.isString(c) ? c : []; if (!c.length) return c; var e = a(this).tree("options"); return e.dataPlain ? a.fn.tree.extensions.dataPlainConverter(c, e) : c }; a.fn.tree.extensions.dataPlainConverter = function (c, d) { var e = c = c || [], f = d.idField || "id", g = d.parentField || "pid"; if (d.dataPlain) var e = a.array.filter(c, function (d) { return null == d[g] || d[g] == u ? !0 : !a.array.some(c, function (a) { return d[g] == a[f] }) }), n = function (c, d) { var e = a.array.filter(c, function (a) { return null == a[g] || a[g] == u ? !1 : a[g] == d[f] }); return a.array.map(e, function (d) { var e = n(c, d); e.length && (d.children = a.array.likeArray(d.children) && !a.util.isString(d.children) ? d.children : [], a.array.merge(d.children, e)); return d }) }, e = a.array.map(e, function (d) { var e = n(c, d); e.length && (d.children = a.array.likeArray(d.children) && !a.util.isString(d.children) ? d.children : [], a.array.merge(d.children, e)); return d }); return e }; a.fn.tree.extensions.cascadeToArray = function (c) { if (a.util.isEmptyObjectOrNull(c)) return []; a.util.likeArrayNotString(c) || (c = [c]); var d = [], e = function (c) { c = a.extend({}, c); var d = [c]; if (!c.children || c.children && !a.util.likeArrayNotString(c.children)) return d; a.each(c.children, function (c, f) { a.array.merge(d, e(f)) }); c.children = u; return d }; a.each(c, function (c, f) { a.array.merge(d, e(f)) }); return d }; var v = a.fn.tree.extensions.methods = { isRoot: function (a, c) { return w(a[0], c) }, showOption: function (c, d) { return c.each(function () { var c = d, e = a(this), f; c ? (c = a(c)[0], f = e.tree("getNode", c), c = a(c).offset()) : (f = e.tree("options"), c = e.offset()); a.extend(c, { left: c.left + 25, top: c.top + 15 }); a.easyui.showOption(f, c) }) }, getLevel: function (c, d) { var e; e = a(c[0]); var f = a(d); e = e[0] && f[0] && f.is(".tree-node[node-id]") && a.contains(e[0], f[0]) ? f.parentsUntil("ul.tree", "ul").length + 1 : 0; return e }, move: function (c, d) { return c.each(function () { if (d && d.source && d.target && d.point && (a.array.contains(["append", "top", "bottom"], d.point) || (d.point = "append"), d.source = a(d.source)[0], d.target = a(d.target)[0], d.source != d.target)) { var c = a(this), e = c.tree("options"); if (!(a.isFunction(e.onBeforeDrop) && 0 == e.onBeforeDrop.call(this, d.target, d.source, d.point) || c.tree("isParent", { target1: d.source, target2: d.target }))) { var f = c.tree("pop", d.source); switch (d.point) { case "append": c.tree("append", { parent: d.target, data: [f] }); break; case "top": c.tree("insert", { before: d.target, data: f }); break; case "bottom": c.tree("insert", { after: d.target, data: f }); break; default: c.tree("append", { parent: d.target, data: [f] }) } f && a.isFunction(e.onDrop) && e.onDrop.call(this, d.target, d.source, d.point) } } }) }, shift: function (c, d) { return c.each(function () { if (d && d.target && d.point && a.array.contains(["up", "upLevel", "down", "downLevel"], d.point)) { d.target = a(d.target)[0]; var c = a(this), e = d.target, f; switch (d.point) { case "up": f = c.tree("prev", e); break; case "upLevel": f = c.tree("getParent", e); break; case "down": f = c.tree("next", e); break; case "downLevel": f = c.tree("prev", e) } f && c.tree("move", { source: e, target: f.target, point: "up" == d.point ? "top" : "downLevel" == d.point ? "append" : "bottom" }) } }) }, compare: function (a, c) { var d = a[0]; return A(d, c) ? "child" : r(d, c) ? "parent" : m(d, c) ? "sibling" : "normal" }, isChild: function (a, c) { return A(a[0], c) }, isParent: function (a, c) { return r(a[0], c) }, isSibling: function (a, c) { return m(a[0], c) }, next: function (c, d) { var e; e = c[0]; var f = a(d); f.hasClass("tree-node") ? (f = f.closest("li").next().children("div.tree-node"), e = f.length ? f.length ? a(e).tree("getNode", f[0]) : null : null) : e = null; return e }, prev: function (c, d) { var e; e = c[0]; var f = a(d); f.hasClass("tree-node") ? (f = f.closest("li").prev().children("div.tree-node"), e = f.length ? f.length ? a(e).tree("getNode", f[0]) : null : null) : e = null; return e }, getNears: function (a, c) { return g(a[0], c) }, getNearChildren: function (a, d) { return c(a[0], d) }, unselect: function (c, d) { return c.each(function () { a(d).removeClass("tree-node-selected") }) }, load: function (a, c) { return a.each(function () { e(this, c) }) }, setIcon: function (c, d) { return c.each(function () { d && d.target && d.iconCls && a(this).tree("update", { target: d.target, iconCls: d.iconCls }) }) }, setText: function (c, d) { return c.each(function () { d && d.target && d.text && a(this).tree("update", { target: d.target, text: d.text }) }) } }, I = a.fn.tree.extensions.defaults = { autoBindDblClick: !0, dblClickMenuIndex: 0, dataPlain: !1, parentField: "pid", selectOnContextMenu: !1, toggleOnClick: !1, onlyNodeExpand: !1, enableContextMenu: !0, contextMenu: null, toggleMenu: !0, moveMenu: !1, showOption: !1, queryParams: {}, loader: I, loadFilter: n, onExpand: M }; a.extend(a.fn.tree.defaults, I); a.extend(a.fn.tree.methods, v) })(jQuery); (function (a, u) { a.fn.combotree.extensions = {}; var w = a.fn.combotree.extensions.methods = {}, A = a.fn.combotree.extensions.defaults = a.extend({}, a.fn.tree.extensions.defaults, { toggleOnClick: !0, onlyNodeExpand: !0, autoBindDblClick: !1, onExpand: function () { a.fn.tree.extensions.defaults.onExpand.apply(a(this).combotree("tree")[0], arguments) } }); a.extend(a.fn.combotree.defaults, A); a.extend(a.fn.combotree.methods, w) })(jQuery); (function (a, u) { function w(c) { var d = a(c); c = a.data(c, "tabs").options; var e = c.tabPosition; a.isNumeric(c.lineHeight) && 0 < c.lineHeight && (a.array.contains(["top", "bottom", "left", "right"], e) || (e = "top"), d.children("div.tabs-panels").css("padding-" + e, c.lineHeight.toString() + "px").children().children().css("border-" + e + "-width", "1px")) } function A(c, d, e, f, g) { return a.array.map(f, function (f) { if (!f || a.util.isString(f)) return f; var k = a.extend({}, f); k.id = a.isFunction(f.id) ? f.id.call(k, c, d, e, g) : f.id; k.text = a.isFunction(f.text) ? f.text.call(k, c, d, e, g) : f.text; k.iconCls = a.isFunction(f.iconCls) ? f.iconCls.call(k, c, d, e, g) : f.iconCls; k.disabled = a.isFunction(f.disabled) ? f.disabled.call(k, c, d, e, g) : f.disabled; k.hideOnClick = a.isFunction(f.hideOnClick) ? f.hideOnClick.call(k, c, d, e, g) : f.hideOnClick; k.onclick = a.isFunction(f.onclick) ? function (a, c, k) { f.onclick.call(this, a, d, e, g, c, k) } : f.onclick; k.handler = a.isFunction(f.handler) ? function (a, c, k) { f.handler.call(this, a, d, e, g, c, k) } : f.handler; k.children && k.children.length && (k.children = A(c, d, e, k.children, g)); return k }) } function r(c, d) { d = a.extend({ tab: null, options: null }, d); var e = a(c), f = a.data(c, "tabs").options, g = e.tabs("getTabIndex", d.tab), m = a.union({}, d.options, a.fn.tabs.extensions.panelOptions), r = m.tools, u = m.onLoad, y = m.onError, A = a.array.contains(["mask", "progress", "none"], f.updateProgress) ? f.updateProgress : "mask", D = function () { "mask" == A ? a.easyui.loaded({ topMost: !0 }) : "progress" == A && a.easyui.messager.progress("close") }, f = { iconCls: "icon-mini-refresh", handler: function () { var c = a(this).parent().prev().find("span.tabs-title").text(); c && a.util.exec(function () { e.tabs("refresh", c) }) } }; m.refreshable && (a.util.likeArrayNotString(m.tools) ? m.tools = a.array.merge([], m.tools, f) : m.tools = [f]); "none" == A || a.string.isNullOrWhiteSpace(m.href) || !m.selected && e.tabs("getSelected") != d.tab || ("mask" == A ? a.easyui.loading({ topMost: !0, msg: m.loadingMessage }) : "progress" == A && a.easyui.messager.progress({ title: "\u64cd\u4f5c\u63d0\u9192", msg: m.loadingMessage, interval: 100 }), m.onLoad = function () { a.isFunction(u) && u.apply(this, arguments); a.util.exec(D); a(this).panel("options").onLoad = u }, m.onError = function () { a.isFunction(y) && y.apply(this, arguments); a.util.exec(D); a(this).panel("options").onError = y }); f = I.call(e, e, { tab: d.tab, options: m }); m = e.tabs("getTab", g).panel("options"); m.tools = r; w(c); m.closeOnDblClick && m.closable && e.find("\x3ediv.tabs-header\x3ediv.tabs-wrap\x3eul.tabs\x3eli").eq(g).off("dblclick.closeOnDblClick").on("dblclick.closeOnDblClick", function () { e.tabs("close", m.title) }).attr("title", "\u53cc\u51fb\u6b64\u9009\u9879\u5361\u6807\u9898\u53ef\u4ee5\u5c06\u5176\u5173\u95ed"); return f } function m(c, d) { var e = a("\x3ctable\x3e\x3c/table\x3e").css({ width: "95%", height: "100%" }), f = a("\x3cinput type\x3d'text' style\x3d'width: 98%;'/\x3e"), g = a("\x3cinput type\x3d'text' style\x3d'width: 98%;'/\x3e"), m = a("\x3cinput id\x3d'refreshable' type\x3d'checkbox' checked\x3d'true' /\x3e"), r = a("\x3cinput id\x3d'iniframe' type\x3d'checkbox' /\x3e"), u = a("\x3clabel\x3e\u662f\u5426\u53ef\u5237\u65b0\x3c/label\x3e"), w = a("\x3clabel\x3e\u662f\u5426\u5d4c\u81f3 IFRAME(\u6d4f\u89c8\u5668\u5185\u90e8\u7a97\u4f53) \u4e2d\x3c/label\x3e"), y = a("\x3ctr\x3e\x3c/tr\x3e").append("\x3ctd width\x3d'24%' align\x3d'right'\x3e\u9009\u9879\u5361\u6807\u9898\uff1a\x3c/td\x3e").appendTo(e), A = a("\x3ctr\x3e\x3c/tr\x3e").append("\x3ctd width\x3d'24%' align\x3d'right'\x3e\u8def\u5f84(href)\uff1a\x3c/td\x3e").appendTo(e), D = a("\x3ctr\x3e\x3c/tr\x3e").appendTo(e); a("\x3ctd\x3e\x3c/td\x3e").append(f).appendTo(y); a("\x3ctd\x3e\x3c/td\x3e").append(g).appendTo(A); a("\x3ctd width\x3d'24%' align\x3d'right'\x3e\x3c/td\x3e").append(m).append(u).appendTo(D); a("\x3ctd align\x3d'right'\x3e\x3c/td\x3e").append(r).append(w).appendTo(D); d = d || 0; var C = a(c), y = a.isNumeric(d) ? d : C.tabs("getTabIndex", C.tabs("getTab", d)), y = C.find("\x3ediv.tabs-header\x3ediv.tabs-wrap\x3eul.tabs\x3eli:eq(" + y + ")").offset(), y = a.extend({}, { left: y.left + 10, top: y.top + 10 }), e = a.extend({ iconCls: "icon-standard-application-form", title: "\u65b0\u5efa\u9009\u9879\u5361 - \u8bbe\u7f6e\u53c2\u6570", width: 400, height: 165, maximizable: !1, resizable: !1, autoVCenter: !1, autoHCenter: !1, enableSaveButton: !1, topMost: !1, applyButtonIndex: 1, applyButtonText: "\u6253\u5f00", onApply: function (c) { var d = f.val(), e = g.val(), e = e || a.fn.tabs.extensions.panelOptions.href; a.string.isNullOrWhiteSpace(d) && (d = "\u65b0\u5efa\u9009\u9879\u5361"); for (var n = 0; C.tabs("getTab", d += n ? n : "") ;) n++; if (a.string.isNullOrWhiteSpace(e)) a.easyui.messager.show("\u64cd\u4f5c\u63d0\u9192", "\u8bf7\u8f93\u5165\u8981\u521b\u5efa\u7684\u9009\u9879\u5361\u7684\u8def\u5f84\uff01", "info"), g.focus(); else { var n = r.prop("checked"), v = m.prop("checked"); C.tabs("add", { title: d, href: e, refreshable: v, closable: !0, iniframe: n }); c.dialog("close") } }, content: e }, y), H = a.easyui.showDialog(e); a.util.exec(function () { var a = H.find("\x3ediv.dialog-button\x3ea:first"); f.keydown(function (a) { 13 == a.which && g.focus() }); g.keydown(function (a) { 13 == a.which && m.focus() }); m.keydown(function (a) { 13 == a.which && r.focus() }); r.keydown(function (c) { 13 == c.which && a.focus() }); u.click(function () { m.click() }); w.click(function () { r.click() }); a.focus(); f.focus() }) } function g(c) { return a.util.isJqueryObject(c) && c.length ? (c = a.data(c[0], "panel")) && c.options && c.options.closable : !1 } function c(c, d) { var e = a(c), f = e.tabs("leftTabs", d); a.each(f, function () { e.tabs("close", e.tabs("getTabIndex", this)) }) } function e(c, d) { var e = a(c), f = e.tabs("rightTabs", d); a.each(f, function () { e.tabs("close", e.tabs("getTabIndex", this)) }) } function d(c, d) { var e = a(c), f = e.tabs("otherTabs", d); a.each(f, function () { e.tabs("close", e.tabs("getTabIndex", this)) }) } function f(c) { var d = a(c); c = d.tabs("tabs"); a.each(a.array.clone(c), function () { d.tabs("close", d.tabs("getTabIndex", this)) }) } function H(c, d) { var e = a(c), f = e.tabs("leftClosableTabs", d); a.each(a.array.clone(f), function () { e.tabs("close", e.tabs("getTabIndex", this)) }) } function D(c, d) { var e = a(c), f = e.tabs("rightClosableTabs", d); a.each(a.array.clone(f), function () { e.tabs("close", e.tabs("getTabIndex", this)) }) } function y(c, d) { var e = a(c), f = e.tabs("otherClosableTabs", d); a.each(a.array.clone(f), function () { e.tabs("close", e.tabs("getTabIndex", this)) }) } function F(c, d) { var e = a(c), f = e.tabs("closableTabs", d); a.each(a.array.clone(f), function () { e.tabs("close", e.tabs("getTabIndex", this)) }) } a.fn.tabs.extensions = {}; var G = a.fn.tabs.defaults.onContextMenu, I = a.fn.tabs.methods.update; a.fn.tabs.extensions.panelOptions = a.extend({}, a.fn.panel.defaults, { iniframe: !1, repeatable: !1, refreshable: !0, closeOnDblClick: !0, href: null, iconCls: "icon-standard-application-form" }); var C = a.fn.tabs.extensions.methods = { update: function (a, c) { return a.each(function () { r(this, c) }) }, refresh: function (c, d) { return c.each(function () { var c = a(this), e = c.tabs("options"), f = c.tabs("getTab", d), g = f.panel("options"), m = c.tabs("getTabIndex", f); a.string.isNullOrWhiteSpace(g.href) && a.string.isNullOrWhiteSpace(g.content) || (c.tabs("update", { tab: f, options: g }), a.isFunction(e.onRefresh) && e.onRefresh.call(this, e.title, m)) }) }, isSelected: function (c, d) { var e = a(c[0]), f = e.tabs("getSelected"), f = e.tabs("getTabIndex", f), g = e.tabs("getTab", d); return e.tabs("getTabIndex", g) == f }, isClosable: function (c, d) { return a(c[0]).tabs("getTab", d).panel("options").closable }, newTab: function (a, c) { return a.each(function () { m(this, c) }) }, repeat: function (c, d) { return c.each(function () { for (var c = a(this), e = c.tabs("getTab", d).panel("options"), e = a.extend({}, e, { selected: !0, closable: !0 }), f = 2, g = e.title; c.tabs("getTab", e.title = g + "-" + f.toString()) ;) f++; c.tabs("add", e) }) }, getTabOption: function (c, d) { return a(c[0]).tabs("getTab", d).panel("options") }, getSelectedOption: function (c) { return a(c[0]).tabs("getSelected").panel("options") }, getSelectedIndex: function (c) { c = a(c[0]); var d = c.tabs("getSelected"); return c.tabs("getTabIndex", d) }, getSelectedTitle: function (c) { return a(c[0]).tabs("getSelectedOption").title }, leftTabs: function (c, d) { var e = a(c[0]), f = a.isNumeric(d) ? d : e.tabs("getTabIndex", e.tabs("getTab", d)), e = e.tabs("tabs"); return a.array.range(e, 0, f) }, rightTabs: function (c, d) { var e = a(c[0]), f = a.isNumeric(d) ? d : e.tabs("getTabIndex", e.tabs("getTab", d)), e = e.tabs("tabs"); return a.array.range(e, f + 1) }, otherTabs: function (c, d) { var e = a(c[0]), f = a.isNumeric(d) ? d : e.tabs("getTabIndex", e.tabs("getTab", d)), e = e.tabs("tabs"); return a.array.merge(a.array.range(e, 0, f), a.array.range(e, f + 1)) }, closableTabs: function (c) { c = a(c[0]).tabs("tabs"); return a.array.filter(c, g) }, leftClosableTabs: function (c, d) { var e = a(c[0]).tabs("leftTabs", d); return a.array.filter(e, g) }, rightClosableTabs: function (c, d) { var e = a(c[0]).tabs("rightTabs", d); return a.array.filter(e, g) }, otherClosableTabs: function (c, d) { var e = a(c[0]).tabs("otherTabs", d); return a.array.filter(e, g) }, closeLeft: function (a, d) { return a.each(function () { c(this, d) }) }, closeRight: function (a, c) { return a.each(function () { e(this, c) }) }, closeOther: function (a, c) { return a.each(function () { d(this, c) }) }, closeAll: function (a) { return a.each(function () { f(this) }) }, closeClosable: function (c, d) { return c.each(function () { var c = a(this), e = c.tabs("getTab", d); e && e.panel("options").closable && (e = a.isNumeric(d) ? d : c.tabs("getTabIndex", e), c.tabs("close", e)) }) }, closeLeftClosable: function (a, c) { return a.each(function () { H(this, c) }) }, closeRightClosable: function (a, c) { return a.each(function () { D(this, c) }) }, closeOtherClosable: function (a, c) { return a.each(function () { y(this, c) }) }, closeAllClosable: function (a) { return a.each(function () { F(this) }) }, showOption: function (c, d) { return c.each(function () { var c = a(this), e; null != d && d != u ? (c = c.tabs("getTab", d), e = c.panel("options"), c = c.panel("header").offset()) : (e = c.tabs("options"), c = c.offset()); a.extend(c, { left: c.left + 25, top: c.top + 15 }); a.easyui.showOption(e, c) }) }, move: function (c, d) { return c.each(function () { if (d && d.source != u && d.target != u && d.point) { var c = d.source, e = d.target, f = a.array.contains(["before", "after"], d.point) ? d.point : "before", g = a(this), m = g.tabs("tabs"), c = g.tabs("getTab", c), e = g.tabs("getTab", e), r = g.tabs("getTabIndex", c), g = c.panel("header"), z = e.panel("header"); c && e && (a.array.removeAt(m, r), r = a.array.indexOf(m, e), a.array.insert(m, "before" == f ? r : r + 1, c), c = c.panel("panel"), e = e.panel("panel"), e[f](c), z[f](g)) } }) }, insert: function (c, d) { return c.each(function () { var c = d.target, e = a(this); d.target = u; e.tabs("add", d); var f = e.tabs("tabs"); e.tabs("move", { source: f.length - 1, target: c, point: "before" }) }) }, setTitle: function (c, d) { return c.each(function () { d && (d.which || a.isNumeric(d.which)) && d.title && a(this).tabs("getTab", d.which).panel("setTitle", d.title) }) }, jumpTab: function (c, d) { return c.each(function () { var c = a(this), c = (null == d || d == u ? c.tabs("getSelected") : c.tabs("getTab", d)).panel("options"); c.href && c.iniframe ? window.open(c.href, "_blank") : a.easyui.messager.show('"' + c.title + '" \u9009\u9879\u5361\u4e0d\u53ef\u5728\u65b0\u9875\u9762\u4e2d\u6253\u5f00\u3002') }) } }, M = a.fn.tabs.extensions.defaults = { lineHeight: 2, enableConextMenu: !0, enableNewTabMenu: !1, enableJumpTabMenu: !1, onRefresh: function (a, c) { }, contextMenu: null, onContextMenu: function (c, d, e) { a.isFunction(G) && G.apply(this, arguments); var f = a(this), g = f.tabs("options"); if (g.enableConextMenu) { c.preventDefault(); var m = f.tabs("getTab", e).panel("options"), r = f.tabs("leftClosableTabs", e), u = f.tabs("rightClosableTabs", e), y = f.tabs("otherClosableTabs", e), w = f.tabs("closableTabs"); f.tabs("isSelected", e); var D = { text: "\u5728\u65b0\u9875\u9762\u4e2d\u6253\u5f00", iconCls: "icon-standard-shape-move-forwards", disabled: m.href && m.iniframe ? !1 : !0, handler: function () { f.tabs("jumpTab", e) } }, C = { text: "\u663e\u793a Option", iconCls: "icon-standard-application-form", disabled: g.showOption ? !1 : !0, children: [{ text: "\u9009\u9879\u5361\u7ec4 Option", iconCls: "icon-standard-tab-go", handler: function () { f.tabs("showOption") } }, { text: "\u8be5\u9009\u9879\u5361 Option", iconCls: "icon-standard-tab", handler: function () { f.tabs("showOption", e) } }] }, H = { text: "\u5173\u95ed\u9009\u9879\u5361", iconCls: "icon-standard-application-form-delete", disabled: m.closable ? !1 : !0, handler: function () { f.tabs("closeClosable", e) } }, y = { text: "\u5173\u95ed\u5176\u4ed6\u9009\u9879\u5361", iconCls: "icon-standard-cancel", disabled: y.length ? !1 : !0, handler: function () { f.tabs("closeOtherClosable", e) } }, F = { text: "\u5237\u65b0\u9009\u9879\u5361", iconCls: "icon-standard-table-refresh", disabled: m.refreshable && m.href ? !1 : !0, handler: function () { f.tabs("refresh", e) } }, r = { text: "\u5173\u95ed\u5de6\u4fa7\u9009\u9879\u5361", iconCls: "icon-standard-tab-close-left", disabled: r.length ? !1 : !0, handler: function () { f.tabs("closeLeftClosable", e) } }, u = { text: "\u5173\u95ed\u53f3\u4fa7\u9009\u9879\u5361", iconCls: "icon-standard-tab-close-right", disabled: u.length ? !1 : !0, handler: function () { f.tabs("closeRightClosable", e) } }, I = { text: "\u5173\u95ed\u6240\u6709\u9009\u9879\u5361", iconCls: "icon-standard-cross", disabled: w.length ? !1 : !0, handler: function () { f.tabs("closeAllClosable") } }, w = { text: "\u65b0\u5efa\u9009\u9879\u5361", iconCls: "icon-standard-tab-add", disabled: g.enableNewTabMenu ? !1 : !0, handler: function () { f.tabs("newTab", e) } }, M = { text: "\u91cd\u590d\u9009\u9879\u5361", iconCls: "icon-standard-control-repeat", disabled: m.repeatable ? !1 : !0, handler: function () { f.tabs("repeat", e) } }, O = []; a.array.likeArray(g.contextMenu) && !a.util.isString(g.contextMenu) && a.array.merge(O, g.contextMenu); g.enableJumpTabMenu && a.array.merge(O, "-", D); g.showOption && a.array.merge(O, "-", C); a.array.merge(O, m.closable ? ["-", H, y] : ["-", y]); m.refreshable && a.array.merge(O, "-", F); a.array.merge(O, "-", r, u, I); if (m.repeatable || g.enableNewTabMenu) D = [], g.enableNewTabMenu && D.push(w), m.repeatable && D.push(M), a.array.merge(O, "-", D); O = A(c, d, e, O, f); "-" == O[0] && a.array.removeAt(O, 0); a.easyui.showMenu({ left: c.pageX, top: c.pageY, items: O }) } }, showOption: !1, updateProgress: "mask" }; a.extend(a.fn.tabs.defaults, M); a.extend(a.fn.tabs.methods, C); a.fn.extend({ closeCurrentTab: function (c) { return this.each(function () { var d = c, d = d && !a.util.isUtilTop ? !0 : !1, e = a(this), f = e.currentTabs(); !d && f.length ? (d = e.currentTabIndex(), -1 < d && f.tabs("close", d)) : (f = a.util.parent.$, e = f(a.util.currentFrame), f = e.currentTabs(), f.length && (d = e.currentTabIndex(), -1 < d && f.tabs("close", d))) }) }, refreshCurrentTab: function (c) { return this.each(function () { var d = c, d = d && !a.util.isUtilTop ? !0 : !1, e = a(this), f = e.currentTabs(); !d && f.length ? (d = e.currentTabIndex(), -1 < d && f.tabs("refresh", d)) : (f = a.util.parent.$, e = f(a.util.currentFrame), f = e.currentTabs(), f.length && (d = e.currentTabIndex(), -1 < d && f.tabs("refresh", d))) }) } }) })(jQuery); (function (a) { function u(m) { m = m || a; m = m("link[href$\x3d'easyui.css']").attr("href").split("/"); return 1 < m.length ? m[m.length - 2] : m[m.length - 1] } function w(a, g, c, e) { var d = u(a); if (d != g) { var f = a("link[href$\x3d'easyui.css']"), w = f.attr("href").split("/"); 1 < arguments.length ? w[w.length - 2] = g : a.array.insert(w, 0, g); f.attr("href", w.join("/")); r(c, d, g, e) } } function A(a, g, c, e) { var d = u(a); w(a, g); a("iframe,iframe").each(function () { try { a.util && a.util.isWindow(this.contentWindow) && a.util.isObject(this.contentWindow.document) && a.isFunction(this.contentWindow.$) && this.contentWindow.$.easyui && this.contentWindow.$.easyui.theme && A(this.contentWindow.$, g) } catch (c) { } }); r(c, d, g, e) } function r(m, g, c, e) { if (a.isFunction(m)) { var d = a.array.first(a.easyui.theme.dataSource, function (a) { return a.path == g }), f = a.array.first(a.easyui.theme.dataSource, function (a) { return a.path == c }); d && (g = d); f && (c = f); a.util.exec(function () { m.call(e, c, g) }) } } a.util.namespace("$.easyui"); a.easyui.theme = function (m, g, c, e) { return 0 == arguments.length ? u(a) : 1 == arguments.length && "boolean" == typeof m ? m ? u(a.util.$) : u(a) : !0 === m ? A(a.util.$, g, c, e) : !1 === m ? w(a, g, c, e) : w(a, m, g, c) }; a.easyui.theme.dataSource = [{ id: 1, name: "\u9ed8\u8ba4(\u5929\u7a7a\u84dd,\u63a8\u8350)", path: "default" }, { id: 2, name: "\u91d1\u5c5e\u9ed1(\u63a8\u8350)", path: "black" }, { id: 3, name: "\u94f6\u8272(\u63a8\u8350)", path: "bootstrap" }, { id: 4, name: "\u7070\u973e(\u63a8\u8350)", path: "gray" }, { id: 5, name: "\u6e05\u6cc9", path: "ui-cupertino", disabled: !1 }, { id: 6, name: "\u9ed1\u5de2", path: "ui-dark-hive", disabled: !1 }, { id: 7, name: "\u674f\u9ec4", path: "ui-pepper-grinder", disabled: !1 }, { id: 8, name: "\u9633\u5149", path: "ui-sunny", disabled: !1 }, { id: 9, name: "\u78c1\u8d34\uff08\u6807\u51c6\uff09", path: "metro-standard" }, { id: 10, name: "\u78c1\u8d34\uff08\u84dd\uff09", path: "metro-blue" }, { id: 11, name: "\u78c1\u8d34\uff08\u7070\uff09", path: "metro-gray" }, { id: 12, name: "\u78c1\u8d34\uff08\u7eff\uff09", path: "metro-green" }, { id: 13, name: "\u78c1\u8d34\uff08\u6a59\uff09", path: "metro-orange" }, { id: 14, name: "\u78c1\u8d34\uff08\u7ea2\uff09", path: "metro-red" }] })(jQuery); (function (a) { function u(r) { a(r).addClass("portal"); var m = a('\x3ctable border\x3d"0" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3ctr\x3e\x3c/tr\x3e\x3c/table\x3e').appendTo(r).find("tr"), g = [], c = 0; a(r).children("div:first").addClass("portal-column-left"); a(r).children("div:last").addClass("portal-column-right"); a(r).find("\x3ediv").each(function () { var d = a(this); c += d.outerWidth(); g.push(d.outerWidth()); var e = a('\x3ctd class\x3d"portal-column-td"\x3e\x3c/td\x3e').appendTo(m); d.addClass("portal-column").appendTo(e); d.find("\x3ediv").each(function () { var c = a(this).addClass("portal-p").panel({ doSize: !1, cls: "portal-panel", onClose: function () { a(this).panel("destroy") } }); A(r, c) }) }); for (var e = 0; e < g.length; e++) g[e] /= c; a(r).bind("_resize", function () { 1 == a.data(r, "portal").options.fit && w(r); return !1 }); return g } function w(r) { var m = a(r), g = a.data(r, "portal").options; if (g.fit) { var c = m.parent(); g.width = c.width(); g.height = c.height() } isNaN(g.width) ? m.width("auto") : m._outerWidth(g.width); isNaN(g.height) ? m.height("auto") : m._outerHeight(g.height); for (var e = m.find("\x3etable").outerHeight() > m.height(), d = m.width(), f = a.data(r, "portal").columnWidths, u = 0, w = 0; w < f.length; w++) { var c = m.find("div.portal-column:eq(" + w + ")"), y = Math.floor(d * f[w]); w == f.length - 1 && (y = d - u - (1 == e ? 18 : 0)); c._outerWidth(y); u += c.outerWidth(); c.find("div.portal-p").panel("resize", { width: c.width() }) } g.onResize.call(r, g.width, g.height) } function A(r, m) { function g(c, e) { var g = null; a(r).find("div.portal-p").each(function () { var m = a(this).panel("panel"); if (m[0] != e) { var r = m.offset(); c.pageX > r.left && c.pageX < r.left + m.outerWidth() && c.pageY > r.top && c.pageY < r.top + m.outerHeight() && (g = c.pageY > r.top + m.outerHeight() / 2 ? { target: m, pos: "down" } : { target: m, pos: "up" }) } }); return g } function c(c) { var e = null; a(r).find("div.portal-column").each(function () { var g = a(this), m = g.offset(); c.pageX > m.left && c.pageX < m.left + g.outerWidth() && (e = g) }); return e } var e; m.panel("panel").draggable({ handle: "\x3ediv.panel-header\x3ediv.panel-title", proxy: function (c) { var e = a('\x3cdiv class\x3d"portal-proxy"\x3eproxy\x3c/div\x3e').insertAfter(c); e.width(a(c).width()); e.height(a(c).height()); e.html(a(c).html()); e.find("div.portal-p").removeClass("portal-p").hide(); return e }, onBeforeDrag: function (c) { c.data.startTop = a(this).position().top + a(r).scrollTop() }, onStartDrag: function (c) { a(this).hide(); e = a('\x3cdiv class\x3d"portal-spacer"\x3e\x3c/div\x3e').insertAfter(this); c = a(this).outerWidth(); var f = a(this).outerHeight(); e._outerWidth(c); f && e._outerHeight(f) }, onDrag: function (d) { var f = g(d, this); f ? ("up" == f.pos ? e.insertBefore(f.target) : e.insertAfter(f.target), d = a(f.target).outerWidth(), e._outerWidth(d)) : (d = c(d)) && 0 == d.find("div.portal-spacer").length && (e.appendTo(d), w(r), d = d.width(), e._outerWidth(d)) }, onStopDrag: function (c) { a(this).css("position", "static"); a(this).show(); e.hide(); a(this).insertAfter(e); e.remove(); w(r); m.panel("move"); a.data(r, "portal").options.onStateChange.call(r) } }) } a.fn.portal = function (r, m) { if ("string" == typeof r) return a.fn.portal.methods[r](this, m); r = r || {}; return this.each(function () { var g = a.data(this, "portal"); g ? a.extend(g.options, r) : g = a.data(this, "portal", { options: a.extend({}, a.fn.portal.defaults, a.fn.portal.parseOptions(this), r), columnWidths: u(this) }); g.options.border ? a(this).removeClass("portal-noborder") : a(this).addClass("portal-noborder"); w(this) }) }; a.fn.portal.methods = { options: function (r) { return a.data(r[0], "portal").options }, resize: function (r, m) { return r.each(function () { if (m) { var g = a.data(this, "portal").options; m.width && (g.width = m.width); m.height && (g.height = m.height) } w(this) }) }, getPanels: function (r, m) { var g = r; 0 <= m && (g = r.find("div.portal-column:eq(" + m + ")")); var c = []; g.find("div.portal-p").each(function () { c.push(a(this)) }); return c }, add: function (r, m) { return r.each(function () { if (m && a.isNumeric(m.columnIndex) && m.panel) { var g = a(this), c = g.portal("options"); if (0 != c.onBeforeAdd.call(this, m.columnIndex, m.panel)) { var g = g.find("div.portal-column:eq(" + m.columnIndex + ")"), e = m.panel.addClass("portal-p"); e.panel("panel").addClass("portal-panel").appendTo(g); A(this, e); e.panel("resize", { width: g.width() }); var g = e.panel("options"), d = c.onClose; g.onClose = function () { a.isFunction(d) && d.apply(this, arguments); if (e.length) { var c = a("body"); a.contains(c[0], e[0]) && e.panel("destroy") } }; c.onAdd.call(this, m.columnIndex, m.panel) } } }) }, remove: function (r, m) { return r.each(function () { var g = a(this), c = g.portal("options"); if (0 != c.onBeforeRemove.call(this, m)) { for (var e = g.portal("getPanels"), d = m.panel("options"), f = 0; f < e.length; f++) g = e[f], g[0] == a(m)[0] && g.panel("destroy"); c.onRemove.call(this, d) } }) }, addColumn: function (r) { return r.each(function () { var m = a.data(this, "portal"), g = m.options, m = m.columnWidths, c = a(this); c.outerWidth(); var c = c.find("\x3etable tr"), e = a("\x3ctd\x3e\x3c/td\x3e").addClass("portal-column-td").appendTo(c); a("\x3cdiv\x3e\x3c/div\x3e").addClass("portal-column").appendTo(e); e = 1 / (m.length + 1); if (0 != g.onBeforeAddColumn.call(this, m.length)) { for (var d = 0; d < m.length; d++) m[d] = e; m.push(e); c.find("\x3etd\x3ediv.portal-column").removeClass("portal-column-left portal-column-right"); c.find("\x3etd\x3ediv.portal-column:first").addClass("portal-column-left"); c.find("\x3etd\x3ediv.portal-column:last").addClass("portal-column-right"); w(this); g.onAddColumn.call(this, m.length - 1) } }) }, removeColumn: function (r, m) { return r.each(function () { var g = a.data(this, "portal"), c = g.options, g = g.columnWidths; if (a.isNumeric(m) && g && g.length && !(m > g.length - 1) && 0 != c.onBeforeRemoveColumn.call(this, m)) { var e = a(this).find("\x3etable tr"), d = 1 / (g.length - 1); g.pop(); for (var f = 0; f < g.length; f++) g[f] = d; e.find("\x3etd:eq(" + m + ")").remove(); e.find("\x3etd\x3ediv.portal-column").removeClass("portal-column-left portal-column-right"); e.find("\x3etd\x3ediv.portal-column:first").addClass("portal-column-left"); e.find("\x3etd\x3ediv.portal-column:last").addClass("portal-column-right"); w(this); c.onRemoveColumn.call(this, m) } }) }, columns: function (r) { return a.data(r[0], "portal").columnWidths.length }, disableDragging: function (a, m) { m.panel("panel").draggable("disable"); return a }, enableDragging: function (a, m) { m.panel("panel").draggable("enable"); return a } }; a.fn.portal.parseOptions = function (r) { return a.extend({}, a.parser.parseOptions(r, ["width", "height", { border: "boolean", fit: "boolean" }])) }; a.fn.portal.defaults = { width: "auto", height: "auto", border: !0, fit: !1, onResize: function (a, m) { }, onStateChange: function () { }, onBeforeAdd: function (a, m) { }, onAdd: function (a, m) { }, onBeforeAddColumn: function (a) { }, onAddColumn: function (a) { }, onBeforeRemove: function (a) { }, onRemove: function (a) { }, onBeforeRemoveColumn: function (a) { }, onRemoveColumn: function (a) { } }; a.parser.plugins.push("portal") })(jQuery);